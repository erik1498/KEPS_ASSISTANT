import{r as n,j as a,h as la,aG as va,s as F,k as X,aW as da,b as M,y as ea,F as sa,aI as Pa,aX as ca,c as xa,aY as ua,aZ as ha,a_ as aa,a$ as _a,n as W,b0 as ja,b1 as ba,b2 as oa,b3 as Na,b4 as ma,O as q,b5 as Fa,f as Ta,b6 as ta,A as ka,R as ya,i as Ra,Y as Sa,Z as Ja,u as Ca,a as $a,o as fa,$ as Da,b7 as ra}from"./index-D4RqvJs4.js";import{P as Ea}from"./PageTitle-DUNNQqVc.js";import{r as ia,W as Aa}from"./Wrap-DQ2PFJhN.js";import{F as U}from"./FormInputWithLabel-lIZpCkjM.js";import{F as Z}from"./FormSelectWithLabel-8h8k16bv.js";import{i as Q}from"./actionEvent.helper-CSfRBgS8.js";import{p as j,a as V,k as La}from"./number.helper-_FlTjox4.js";import{T as wa}from"./ToggleBox-LVDXyetM.js";import{P as Ba}from"./Pagination-Bq4QT9q6.js";import{F as G}from"./FormInput-C_BK0bkE.js";import{g as Oa}from"./jurnalUmum.helper-CK7WBSbk.js";import{P as Ka}from"./PDFHeader-qSI1BbDw.js";import"./index-BKNjMPK8.js";const za=({pesananPenjualanJasa:s,_getDataRincianDaftarPasananPenjualan:t,kategoriHargaJasaList:r,customer:_})=>{const[A,y]=n.useState(!1),[O,R]=n.useState([]),[N,P]=n.useState(),[S,v]=n.useState(),[D,x]=n.useState(),[J,g]=n.useState(0),[$,d]=n.useState(0),[b,k]=n.useState(0),[C,w]=n.useState(0),[u,m]=n.useState(0),[l,E]=n.useState(0),K=()=>{x(o=>null),va.custom(`/cabang/${S.value}/${s.uuid}`,"GET").then(o=>{R(o.data),o.data.length>0&&x(T=>({label:o.data[0].cabang_name,value:o.data[0].uuid}))}).catch(o=>F(o))},i=async o=>{o.preventDefault(),await X(o.target)&&da.custom("","POST",null,{data:{pesanan_penjualan_jasa:s.uuid,kategori_harga_jasa:S.value,stok_awal_jasa:D.value,kode_harga_customer:_.kode_harga,jumlah:`${J}`,harga:`${N[`harga_${_.kode_harga}`]}`,harga_setelah_diskon:`${l}`,ppn:`${N.ppn==1?N[`harga_${_.kode_harga}`]*ia/100:0}`,ppn_setelah_diskon:`${u}`,diskon_angka:`${$}`,diskon_persentase:`${b}`,total_harga:`${C}`}}).then(T=>{t()}).catch(T=>F(T))},B=o=>{try{const T=V(o.target.value)*N[`harga_${_.kode_harga}`]/100;k(o.target.value),d(e=>e=j(T))}catch{d(e=>0)}},L=()=>{try{const o=V($)*100/N[`harga_${_.kode_harga}`];k(T=>T=o),H()}catch{k(T=>0)}};n.useEffect(()=>{N&&L()},[$]);const H=()=>{const o=V(J),T=N[`harga_${_.kode_harga}`]-V($);E(p=>T);const e=N.ppn==1?T*ia/100:0;m(p=>e);const c=o*T+e*o;w(p=>c)};return n.useEffect(()=>{N&&H()},[J]),n.useEffect(()=>{if(S){K();const o=r.filter(T=>T.uuid==S.value);o.length>0&&(g(T=>0),y(T=>0),d(T=>0),k(T=>0),P(o[0]))}},[S]),n.useEffect(()=>{v({label:r[0].kode_jasa,value:r[0].uuid})},[]),a.jsx(a.Fragment,{children:a.jsxs("form",{className:"gap-x-2 py-3",onSubmit:o=>i(o),children:[a.jsxs("div",{className:"flex items-end gap-x-2",children:[a.jsx(Z,{label:"Kode Jasa",optionsDataList:r,optionsLabel:"kode_jasa",optionsValue:"uuid",selectValue:S,onchange:o=>{v(o)},selectName:"kategoriHargaJasa"}),a.jsx(Z,{label:"Cabang Asal",optionsDataList:O,optionsLabel:"cabang_name",optionsValue:"uuid",selectValue:D,onchange:o=>{x(o)},selectName:"CabangJasa"})]}),N?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"gap-x-2 bg-gray-300 my-4 rounded-md px-2 py-3",children:[a.jsx("p",{className:"text-xl font-extrabold",children:N.daftar_jasa_name}),a.jsx("p",{className:"text-sm mt-5",children:"Harga Jasa"}),a.jsxs("p",{className:"font-bold mt-1 text-xl",children:["Rp. ",j(N[`harga_${_.kode_harga}`])]}),N.ppn==1?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"flex gap-x-2 items-end mb-5",children:[a.jsx("p",{className:"text-sm",children:"PPN"}),a.jsxs("p",{className:"font-bold",children:["Rp. ",j(N[`harga_${_.kode_harga}`]*ia/100)]})]})}):a.jsx(a.Fragment,{}),a.jsx("p",{className:"font-bold bg-blue-800 px-2 text-white rounded-md w-max mt-2",children:N.satuan_jasa_name})]}),D?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex gap-x-2",children:a.jsx(U,{addClassInput:"w-max",label:"Jumlah",type:"text",onchange:o=>{Q(o),g(o.target.value)},others:{value:J,name:"jumlah"}})}),a.jsx("div",{className:"mt-5",children:a.jsx(wa,{label:"Gunakan Diskon ?",setToggleBox:y,toggleBox:A,toggleBoxList:[{label:"Tidak",value:0},{label:"Ya",value:1}]})}),A?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mt-5 flex gap-x-2",children:[a.jsx(U,{label:"Diskon Angka",type:"text",onchange:o=>{Q(o),d(o.target.value)},others:{value:$,name:"diskonAngka"}}),a.jsx(U,{label:"Diskon Persentase",type:"text",onchange:o=>{Q(o),B(o)},others:{value:b,name:"diskonPersentase"}})]}),a.jsxs("div",{className:"mt-5 gap-x-2 px-1",children:[a.jsx("p",{className:"font-bold mt-2",children:"Harga Setelah Diskon"}),a.jsxs("p",{className:"font-bold mt-2 text-xl",children:["Rp. ",j(l)]}),N.ppn==1?a.jsx(a.Fragment,{children:a.jsxs("p",{className:"font-bold mb-5 mt-2",children:["PPN Rp. ",j(u)]})}):a.jsx(a.Fragment,{})]})]}):a.jsx(a.Fragment,{}),a.jsxs("div",{className:"mt-5 gap-x-2 px-1",children:[a.jsx("p",{className:"font-bold text-sm",children:"Total Harga"}),a.jsxs("p",{className:"font-bold text-4xl",children:["Rp. ",j(C)]})]})]}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{}),D?a.jsx(a.Fragment,{children:a.jsxs("button",{className:"mt-3 btn w-full bg-green-800 text-white",children:[a.jsx(la,{})," Simpan Pesanan"]})}):a.jsx(a.Fragment,{})]})})},Ha=({pesananPenjualanJasa:s,customer:t,fakturStatus:r,setPPNStatus:_=()=>{},tanggalTransaksiAkhir:A,rincianPesananPenjualanJasa:y,setRincianPesananPenjualanJasa:O=()=>{}})=>{const[R,N]=n.useState([]),[P,S]=n.useState(!1),[v,D]=n.useState(0),x=()=>{da.custom(`/${s.uuid}`,"GET").then(d=>{_(b=>!1),O(d.data),d.data.filter(b=>b.ppn>0).length>0&&_(b=>!0)}).catch(d=>F(d))},J=()=>{Pa.custom("/transaksi","GET").then(d=>{N(d.data)}).catch(d=>F(d))},g=d=>{da.custom(`/${d}`,"DELETE").then(b=>{x()}).catch(b=>F(b))},$=()=>{ca.custom("/pesanan_by_tanggal","POST",null,{data:{faktur_penjualan_jasa:r,tanggal:A}}).then(d=>{O(k=>d.data);const b=d.data.reduce((k,C)=>k+parseFloat(C.piutang),0);D(k=>b)})};return n.useEffect(()=>{J(),r?$():x()},[r,A,P]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"grid grid-cols-12 gap-x-2",children:[a.jsx("div",{className:`${r?"hidden":"col-span-4"}`,children:R.length>0?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white rounded-md my-4 py-6 px-6 shadow-2xl",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Detail Jasa Pesanan"}),a.jsx(za,{_getDataRincianDaftarPasananPenjualan:x,_hapusPesanan:()=>{},customer:t,kategoriHargaJasaList:R,pesananPenjualanJasa:s})]})}):a.jsx(a.Fragment,{})}),a.jsx("div",{className:`${r?"col-span-12":"col-span-8"}`,children:a.jsxs("div",{className:`bg-white my-4 rounded-md no-scrollbar relative ${r?"h-max max-h-[60vh]":"h-[70vh]"} overflow-y-scroll`,children:[a.jsxs("div",{className:"sticky top-0",children:[a.jsxs("div",{className:"bg-white py-4 px-6 rounded-md",children:[a.jsx("p",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Total Pesanan"}),a.jsxs("p",{className:"font-bold text-4xl",children:["Rp. ",j(y.reduce((d,b)=>d+parseFloat(b.total_harga),0))]}),r?a.jsx(a.Fragment,{children:v>0?a.jsxs("div",{className:"flex items-center gap-x-2 w-max my-2 px-2 py-1 rounded-md border-2 border-red-800",children:[a.jsx(M,{className:"text-red-800",size:13}),a.jsx("p",{className:"mb-0 text-red-800 font-bold",children:"Belum Lunas"})]}):a.jsxs("div",{className:"flex items-center gap-x-2 w-max my-2 px-2 py-1 rounded-md border-2 border-green-800",children:[a.jsx(ea,{className:"text-green-800",size:13}),a.jsx("p",{className:"mb-0 text-green-800 font-bold",children:"Lunas"})]})}):a.jsx(a.Fragment,{}),r?a.jsx(a.Fragment,{children:P?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn bg-gray-100 text-red-500 btn-sm mt-4 border-red-500",onClick:()=>{S(d=>d=!d)},children:"Tutup Daftar Pesanan"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn bg-gray-100 btn-sm mt-4 border-gray-500",onClick:()=>{S(d=>d=!d)},children:"Lihat Daftar Pesanan"})})}):a.jsx(a.Fragment,{})]}),r&&!P?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"grid grid-cols-12 text-sm gap-x-2 py-2 font-bold border-t-2 bg-gray-100 px-6",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("p",{className:"text-gray-500",children:"No."})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Kode Jasa"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Nama Jasa"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Satuan Jasa"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Harga Jasa"})})]})})]}),r&&!P?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:y.map((d,b)=>a.jsxs("div",{className:"py-3  border-t-2",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 px-6 items-start font-bold",children:[a.jsx("div",{className:"col-span-1",children:a.jsxs("p",{className:"text-sm",children:[b+1,"."]})}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-sm",children:d.kategori_harga_jasa_kode_jasa}),a.jsx("p",{className:"text-xs my-1 font-normal",children:d.daftar_gudang_name})]}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:d.daftar_jasa_name})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:d.satuan_jasa_name})}),a.jsxs("div",{className:"col-span-3",children:[a.jsxs("p",{className:"text-sm",children:["Rp. ",j(d.harga)]}),a.jsxs("p",{className:"text-xs font-normal",children:["PPN : Rp. ",j(d.ppn)]})]})]}),a.jsxs("div",{className:"grid grid-cols-12 text-xs gap-x-2 px-6 text-gray-500 font-bold",children:[a.jsx("div",{className:"col-span-1"}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("p",{children:["Jumlah : ",j(d.jumlah)]}),r?a.jsx(a.Fragment,{children:a.jsxs("p",{children:["Retur : ",j(d.retur)]})}):a.jsx(a.Fragment,{})]}),a.jsx("div",{className:"col-span-3",children:d.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsx("p",{children:"Diskon"}),a.jsx("p",{children:"Harga Diskon"}),a.jsx("p",{children:"PPN Diskon"})]}):a.jsx(a.Fragment,{})}),a.jsx("div",{className:"col-span-3",children:d.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["Rp. ",j(d.diskon_angka)," (",d.diskon_persentase," % )"]}),a.jsxs("p",{children:["Rp. ",j(d.harga_setelah_diskon)]}),a.jsxs("p",{children:["Rp. ",j(d.ppn_setelah_diskon)]})]}):a.jsx(a.Fragment,{})}),a.jsxs("div",{className:"col-span-3",children:["Total Harga ",a.jsxs("p",{children:["Rp. ",j(d.total_harga)]}),r?a.jsxs(a.Fragment,{children:["Status ",a.jsx("p",{children:d.piutang!="0"?`Belum Lunas ( Rp. ${j(d.piutang)} )`:"Sudah Lunas"})]}):a.jsx(a.Fragment,{})]})]}),r?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsx("div",{className:"grid grid-cols-12 gap-x-2 px-6",children:a.jsx("div",{className:"col-span-1 col-start-2 mb-3",children:a.jsxs("button",{className:"btn w-max btn-sm bg-red-700 text-white",onClick:k=>{g(d.uuid)},children:[a.jsx(sa,{})," Hapus"]})})})})]}))})]})})]})})},Ua=({riwayatPelunasanPenjualanJasa:s,edited:t,_getDaftarRiwayatTransaksi:r=()=>{}})=>{var H,o,T;const[_,A]=n.useState(s.nomor_transaksi!="EMPTY"?s.nomor_transaksi:""),[y,O]=n.useState(s.bukti_transaksi!="EMPTY"?s.bukti_transaksi:""),[R,N]=n.useState(s.keterangan!="EMPTY"?s.keterangan:"Tidak Ada"),[P,S]=n.useState(s.total),[v,D]=n.useState(!1),[x,J]=n.useState([]),[g,$]=n.useState([]),[d,b]=n.useState(!1),[k,C]=n.useState(t),w=()=>{aa.custom(`/cek_denda_pelunasan_penjualan/${s.uuid}`,"GET").then(e=>{D(c=>e.data)}).catch(e=>F(e))},u=()=>{ca.custom(`/pesanan/${s.uuid}`).then(e=>{J(e.data)}).catch(e=>F(e))},m=()=>{_a.custom(`/pesanan/${s.uuid}`).then(e=>{$(e.data)}).catch(e=>F(e))},l=(e,c)=>{let p=x,Y=0;p=p.map(z=>(z.uuid==c&&(z.nilai_pelunasan=e),Y+=V(z.nilai_pelunasan),z)),S(z=>Y),J(z=>p)},E=(e,c)=>{let p=g,Y=0;p=p.map(z=>(z.uuid==c&&(z.nilai_pelunasan=e),Y+=V(z.nilai_pelunasan),z)),S(z=>Y),$(z=>p)},K=async()=>{for(let e=0;e<g.length;e++)await _a.custom(`${g[e].rincian_pelunasan_penjualan_denda_jasa?`/${g[e].rincian_pelunasan_penjualan_denda_jasa}`:""}`,g[e].rincian_pelunasan_penjualan_denda_jasa?"PUT":"POST",null,{data:{pelunasan_penjualan_jasa:s.uuid,rincian_pesanan_penjualan_jasa:g[e].uuid,hari_terlewat:g[e].hari_terlewat,total_denda:g[e].total_denda,denda_sudah_dibayar:g[e].denda_sudah_dibayar,piutang_denda:g[e].total_denda-g[e].denda_sudah_dibayar,nilai_pelunasan:`${g[e].nilai_pelunasan}`}}).then(()=>{W("Berhasil","Data Berhasil Disimpan")}).catch(c=>F(c));m()},i=async()=>{for(let e=0;e<x.length;e++)await ca.custom(`${x[e].rincian_pelunasan_penjualan_jasa?`/${x[e].rincian_pelunasan_penjualan_jasa}`:""}`,x[e].rincian_pelunasan_penjualan_jasa?"PUT":"POST",null,{data:{pelunasan_penjualan_jasa:s.uuid,rincian_pesanan_penjualan_jasa:x[e].uuid,sudah_dibayar:x[e].sudah_dibayar,piutang:x[e].piutang,nilai_pelunasan:`${x[e].nilai_pelunasan}`}}).then(()=>{W("Berhasil","Data Berhasil Disimpan")}).catch(c=>F(c));u()},B=()=>{aa.custom("/"+s.uuid,"DELETE").then(()=>{r()}).catch(e=>F(e))},L=async()=>{await ja(),await X()&&aa.custom("/"+s.uuid,"PUT",null,{data:{nomor_pelunasan_penjualan_jasa:_,bukti_transaksi:y,keterangan:R,faktur_penjualan_jasa:s.faktur_penjualan_jasa,tanggal:s.tanggal,kode_akun_perkiraan:s.kode_akun_perkiraan}}).then(()=>{W("Berhasil","Data Berhasil Disimpan")}).catch(e=>F(e))};return n.useEffect(()=>{v==0?u():m()},[v]),n.useEffect(()=>{d&&w()},[d]),a.jsxs("div",{className:"border-b-2 py-2",children:[a.jsx("div",{className:"cursor-pointer",onClick:()=>{C(e=>e=!e)},children:a.jsxs("div",{className:"flex items-center justify-between gap-x-2 px-4",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsx("p",{className:"text-sm pr-2 font-medium",children:xa(s.tanggal.split("T")[1])}),a.jsx("p",{className:"text-sm pr-2 font-medium px-3 border-l-2 border-black",children:"Pelunasan Penjualan Jasa"})]}),k?a.jsx(ua,{size:15}):a.jsx(ha,{size:15})]})}),k?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"ml-4 py-4 px-4",children:[((H=JSON.parse(s.perintah_stok_opname_nomor_surat_perintah))==null?void 0:H.hasil_stok_opname_count)==0?a.jsx(a.Fragment,{}):a.jsx("p",{className:"text-xs font-medium text-green-600 my-3",children:(o=JSON.parse(s.perintah_stok_opname_nomor_surat_perintah))!=null&&o.nomor_perintah_stok_opname?`Telah Terdaftar Pada Surat Perintah Stok Opname ${(T=JSON.parse(s.perintah_stok_opname_nomor_surat_perintah))==null?void 0:T.nomor_perintah_stok_opname}`:""}),k?a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"text-left text-sm",children:[a.jsxs("tr",{children:[a.jsx("td",{className:`${t?"pb-3":""}`,children:"Nomor Pelunasan Penjualan Jasa"}),a.jsx("td",{className:`px-5 ${t?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${t?"pb-3":""}`,children:t?a.jsx(G,{addClass:"px-0",name:"nomor_pelunasan_penjualan_jasa",value:_,onchange:e=>A(e.target.value)}):s.nomor_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${t?"pb-3":""}`,children:"Bukti Transaksi"}),a.jsx("td",{className:`px-5 ${t?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${t?"pb-3":""}`,children:t?a.jsx(G,{addClass:"px-0",name:"bukti_transaksi",value:y,onchange:e=>O(e.target.value)}):s.bukti_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${t?"pb-5":""}`,children:"Kode Akun"}),a.jsx("td",{className:`px-5 ${t?"pb-5":""}`,children:":"}),a.jsxs("td",{className:`${t?"pb-5":""}`,children:[s.kode_akun_perkiraan_code," - ",s.kode_akun_perkiraan_name]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${t?"pb-3":""}`,children:"Total Pelunasan"}),a.jsx("td",{className:`px-5 ${t?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${t?"pb-3":""}`,children:["Rp. ",j(P)]})]})]}),a.jsx("p",{className:`text-sm mt-3 ${t?"mt-5":""}`,children:"Keterangan"}),a.jsx("p",{className:"text-sm mb-3",children:t?a.jsx(G,{addClass:"mt-5",name:"keterangan",value:R,onchange:e=>N(e.target.value)}):s.keterangan}),a.jsxs("div",{className:"my-2 flex justify-between",children:[a.jsx("div",{children:t?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"mr-2 btn btn-sm bg-green-900 text-white",onClick:()=>L(),children:[a.jsx(ea,{size:12}),"Simpan"]}),a.jsxs("button",{className:"mr-2 btn btn-sm bg-red-500 text-white",onClick:()=>B(),children:[a.jsx(sa,{size:12}),"Hapus"]})]}):a.jsx(a.Fragment,{})}),d?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm border-red-500 text-red-500",onClick:()=>b(e=>e=!e),children:"Tutup Daftar Pelunasan"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm bg-white border-gray-400",onClick:()=>b(e=>e=!e),children:"Lihat Daftar Pelunasan"})})]}),d?a.jsx(a.Fragment,{children:v==1?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Jasa"}),a.jsx("th",{children:"Nama Jasa"}),a.jsx("th",{children:"Satuan Jasa"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Hari Terlewat"}),a.jsx("th",{children:"Total Denda"}),a.jsx("th",{children:"Denda Sudah Dibayar"}),a.jsx("th",{children:"Piutang Denda"}),a.jsx("th",{width:200,children:"Nilai Pelunasan"})]}),a.jsx("tbody",{children:g.map((e,c)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[c+1,"."]}),a.jsx("td",{children:e.kategori_harga_jasa_kode_jasa}),a.jsx("td",{children:e.daftar_jasa_name}),a.jsx("td",{children:e.satuan_jasa_name}),a.jsx("td",{children:e.daftar_gudang_name}),a.jsxs("td",{children:[e.hari_terlewat," Hari"]}),a.jsxs("td",{children:["Rp. ",j(e.total_denda)]}),a.jsxs("td",{children:["Rp. ",j(e.denda_sudah_dibayar)]}),a.jsxs("td",{children:["Rp. ",j(e.piutang_denda)]}),a.jsx("td",{children:t?a.jsx(a.Fragment,{children:a.jsx(G,{name:"nilai_pelunasan",type:"text",other:{defaultValue:0},onchange:p=>{Q(p,e.piutang_denda),E(p.target.value,e.uuid)},value:j(e.nilai_pelunasan)})}):a.jsxs(a.Fragment,{children:["Rp. ",j(e.nilai_pelunasan)]})})]})}))})]})}),t?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn btn-sm bg-green-900 text-white",onClick:()=>{K()},children:"Simpan"})})}):a.jsx(a.Fragment,{})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Jasa"}),a.jsx("th",{children:"Nama Jasa"}),a.jsx("th",{children:"Satuan Jasa"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Pelunasan Sudah Dibayar"}),a.jsx("th",{children:"Piutang"}),a.jsx("th",{width:200,children:"Nilai Pelunasan"})]}),a.jsx("tbody",{children:x.map((e,c)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[c+1,"."]}),a.jsx("td",{children:e.kategori_harga_jasa_kode_jasa}),a.jsx("td",{children:e.daftar_jasa_name}),a.jsx("td",{children:e.satuan_jasa_name}),a.jsx("td",{children:e.daftar_gudang_name}),a.jsxs("td",{children:["Rp. ",j(e.sudah_dibayar)]}),a.jsxs("td",{children:["Rp. ",j(e.piutang)]}),a.jsx("td",{children:t?a.jsx(a.Fragment,{children:a.jsx(G,{name:"nilai_pelunasan",type:"text",other:{defaultValue:0},onchange:p=>{Q(p,e.piutang),l(p.target.value,e.uuid)},value:j(e.nilai_pelunasan)})}):a.jsxs(a.Fragment,{children:["Rp. ",j(e.nilai_pelunasan)]})})]})}))})]})}),t?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn btn-sm bg-green-900 text-white",onClick:()=>{i()},children:"Simpan"})})}):a.jsx(a.Fragment,{})]})}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]})}):a.jsx(a.Fragment,{})]})},Ga=({riwayatReturPenjualanJasa:s,edited:t,_getDaftarRiwayatTransaksi:r=()=>{}})=>{var l,E,K;const[_,A]=n.useState(s.nomor_transaksi!="EMPTY"?s.nomor_transaksi:""),[y,O]=n.useState(s.bukti_transaksi!="EMPTY"?s.bukti_transaksi:""),[R,N]=n.useState(s.keterangan!="EMPTY"?s.keterangan:"Tidak Ada"),[P,S]=n.useState(s.total),[v,D]=n.useState(!1),[x,J]=n.useState([]),[g,$]=n.useState(!1),[d,b]=n.useState(t),k=()=>{ba.custom(`/pesanan/${s.uuid}`).then(i=>{J(i.data)}).catch(i=>F(i))},C=(i,B)=>{let L=x,H=0;L=L.map(o=>(o.uuid==B&&(o.retur=i,o.nilai_retur=(o.harga_setelah_diskon+o.ppn_setelah_diskon)*V(i),o.nilai_retur>o.sudah_dibayar_fix&&(o.nilai_retur=o.sudah_dibayar_fix)),H+=V(o.nilai_retur),o)),S(o=>H),J(o=>L)},w=async()=>{for(let i=0;i<x.length;i++)await ba.custom(`${x[i].rincian_retur_penjualan_jasa?`/${x[i].rincian_retur_penjualan_jasa}`:""}`,x[i].rincian_retur_penjualan_jasa?"PUT":"POST",null,{data:{retur_penjualan_jasa:s.uuid,rincian_pesanan_penjualan_jasa:x[i].uuid,jumlah:`${x[i].jumlah_fix}`,denda_sudah_dibayar:`${x[i].denda_sudah_dibayar}`,sudah_dibayar:`${x[i].sudah_dibayar_fix}`,retur:`${x[i].retur}`,nilai_retur:`${x[i].nilai_retur}`,retur_sebelum:`${x[i].retur_sebelum}`,nilai_retur_sebelum:`${x[i].nilai_retur_sebelum}`}}).then(()=>W("Berhasil","Data Berhasil Disimpan")).catch(B=>F(B));k()},u=()=>{oa.custom("/"+s.uuid,"DELETE").then(()=>{r()}).catch(i=>F(i))},m=async()=>{await ja(),await X()&&oa.custom("/"+s.uuid,"PUT",null,{data:{nomor_retur_penjualan_jasa:_,bukti_transaksi:y,keterangan:R,faktur_penjualan_jasa:s.faktur_penjualan_jasa,tanggal:s.tanggal,kode_akun_perkiraan:s.kode_akun_perkiraan}}).then(()=>W("Berhasil","Data Berhasil Disimpan")).catch(i=>F(i))};return n.useEffect(()=>{g&&!v&&(k(),D(i=>!0))},[g]),a.jsxs("div",{className:"border-b-2 py-2",children:[a.jsx("div",{className:"cursor-pointer",onClick:()=>{b(i=>i=!i)},children:a.jsxs("div",{className:"flex items-center justify-between gap-x-2 px-4",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsx("p",{className:"text-sm pr-2 font-medium",children:xa(s.tanggal.split("T")[1])}),a.jsx("p",{className:"text-sm pr-2 font-medium px-4 border-l-2 border-black",children:"Retur Penjualan Jasa"})]}),d?a.jsx(ua,{size:15}):a.jsx(ha,{size:15})]})}),d?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"ml-4 py-4 px-4",children:[((l=JSON.parse(s.perintah_stok_opname_nomor_surat_perintah))==null?void 0:l.hasil_stok_opname_count)==0?a.jsx(a.Fragment,{}):a.jsx("p",{className:"text-xs font-medium text-green-600 my-3",children:(E=JSON.parse(s.perintah_stok_opname_nomor_surat_perintah))!=null&&E.nomor_perintah_stok_opname?`Telah Terdaftar Pada Surat Perintah Stok Opname ${(K=JSON.parse(s.perintah_stok_opname_nomor_surat_perintah))==null?void 0:K.nomor_perintah_stok_opname}`:""}),d?a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"text-left text-sm",children:[a.jsxs("tr",{children:[a.jsx("td",{className:`${t?"pb-3":""}`,children:"Nomor Retur Penjualan Jasa"}),a.jsx("td",{className:`px-5 ${t?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${t?"pb-3":""}`,children:t?a.jsx(G,{addClass:"px-0",name:"nomor_retur_penjualan_jasa",value:_,onchange:i=>A(i.target.value)}):s.nomor_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${t?"pb-3":""}`,children:"Bukti Transaksi"}),a.jsx("td",{className:`px-5 ${t?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${t?"pb-3":""}`,children:t?a.jsx(G,{addClass:"px-0",name:"bukti_transaksi",value:y,onchange:i=>O(i.target.value)}):s.bukti_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${t?"pb-5":""}`,children:"Kode Akun"}),a.jsx("td",{className:`px-5 ${t?"pb-5":""}`,children:":"}),a.jsxs("td",{className:`${t?"pb-5":""}`,children:[s.kode_akun_perkiraan_code," - ",s.kode_akun_perkiraan_name]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${t?"pb-3":""}`,children:"Total Retur"}),a.jsx("td",{className:`px-5 ${t?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${t?"pb-3":""}`,children:["Rp. ",j(P)]})]})]}),a.jsx("p",{className:`text-sm mt-3 ${t?"mt-5":""}`,children:"Keterangan"}),a.jsx("p",{className:"text-sm mb-3",children:t?a.jsx(G,{addClass:"mt-5",name:"keterangan",value:R,onchange:i=>N(i.target.value)}):s.keterangan}),a.jsxs("div",{className:"my-2 flex justify-between",children:[a.jsx("div",{children:t?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"mr-2 btn btn-sm bg-green-900 text-white",onClick:()=>m(),children:[a.jsx(ea,{size:12}),"Simpan"]}),a.jsxs("button",{className:"mr-2 btn btn-sm bg-red-500 text-white",onClick:()=>u(),children:[a.jsx(sa,{size:12}),"Hapus"]})]}):a.jsx(a.Fragment,{})}),g?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm border-red-500 text-red-500",onClick:()=>$(i=>i=!i),children:"Tutup Daftar Retur"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm bg-white border-gray-400",onClick:()=>$(i=>i=!i),children:"Lihat Daftar Retur"})})]}),g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Jasa"}),a.jsx("th",{children:"Nama Jasa"}),a.jsx("th",{children:"Satuan Jasa"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Pelunasan Sudah Dibayar"}),a.jsx("th",{width:150,children:"Retur Sebelumnya"}),a.jsx("th",{width:150,children:"Retur"}),a.jsx("th",{children:"Nilai Retur"})]}),a.jsx("tbody",{children:x.map((i,B)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[B+1,"."]}),a.jsx("td",{children:i.kategori_harga_jasa_kode_jasa}),a.jsx("td",{children:i.daftar_jasa_name}),a.jsx("td",{children:i.satuan_jasa_name}),a.jsx("td",{children:i.daftar_gudang_name}),a.jsxs("td",{children:["Rp. ",j(i.sudah_dibayar_fix)]}),a.jsxs("td",{children:[j(i.retur_sebelum)," ",i.satuan_jasa_name]}),a.jsx("td",{children:t?a.jsx(a.Fragment,{children:a.jsx(G,{name:"retur",type:"text",other:{defaultValue:0},onchange:L=>{Q(L,i.jumlah_fix),C(L.target.value,i.uuid)},value:j(i.retur)})}):a.jsxs(a.Fragment,{children:[j(i.retur)," ",i.satuan_jasa_name]})}),a.jsxs("td",{children:["Rp. ",j(i.nilai_retur)]})]})}))})]})}),t?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn btn-sm bg-green-900 text-white",onClick:()=>{w()},children:"Simpan"})})}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]})}):a.jsx(a.Fragment,{})]})},Ia=({riwayatPengembalianDendaPenjualanJasa:s,edited:t,_getDaftarRiwayatTransaksi:r=()=>{}})=>{var w,u,m;const[_,A]=n.useState(s.nomor_transaksi!="EMPTY"?s.nomor_transaksi:""),[y,O]=n.useState(s.bukti_transaksi!="EMPTY"?s.bukti_transaksi:""),[R,N]=n.useState(s.keterangan!="EMPTY"?s.keterangan:"Tidak Ada"),[P,S]=n.useState(s.total),[v,D]=n.useState([]),[x,J]=n.useState(t),[g,$]=n.useState(t),d=()=>{Na.custom(`/pesanan/${s.uuid}`).then(l=>{D(l.data),S(E=>l.data.reduce((K,i)=>i.denda_yang_dikembalikan+K,0))}).catch(l=>F(l))},b=async()=>{for(let l=0;l<v.length;l++)await Na.custom(`${v[l].rincian_pengembalian_denda_penjualan_jasa?`/${v[l].rincian_pengembalian_denda_penjualan_jasa}`:""}`,v[l].rincian_pengembalian_denda_penjualan_jasa?"PUT":"POST",null,{data:{pengembalian_denda_penjualan_jasa:s.uuid,rincian_pesanan_penjualan_jasa:v[l].uuid,denda_yang_dikembalikan:`${v[l].denda_yang_dikembalikan}`}}).then(()=>{W("Berhasil","Data Berhasil Disimpan")});d()},k=()=>{ma.custom("/"+s.uuid,"DELETE").then(()=>{r()}).catch(l=>F(l))},C=async()=>{await ja(),await X()&&ma.custom("/"+s.uuid,"PUT",null,{data:{nomor_pengembalian_denda_penjualan_jasa:_,bukti_transaksi:y,keterangan:R,faktur_penjualan_jasa:s.faktur_penjualan_jasa,tanggal:s.tanggal,kode_akun_perkiraan:s.kode_akun_perkiraan}}).then(()=>{b()}).catch(l=>F(l))};return n.useEffect(()=>{x&&d()},[x]),a.jsxs("div",{className:"border-b-2 py-2",children:[a.jsx("div",{className:"cursor-pointer",onClick:()=>{$(l=>l=!l)},children:a.jsxs("div",{className:"flex items-center justify-between gap-x-2 px-4",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsx("p",{className:"text-sm pr-2 font-medium",children:xa(s.tanggal.split("T")[1])}),a.jsx("p",{className:"text-sm pr-2 font-medium px-3 border-l-2 border-black",children:"Pengembalian Denda Penjualan Jasa"})]}),g?a.jsx(ua,{size:15}):a.jsx(ha,{size:15})]})}),g?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"ml-4 py-4 px-4",children:[((w=JSON.parse(s.perintah_stok_opname_nomor_surat_perintah))==null?void 0:w.hasil_stok_opname_count)==0?a.jsx(a.Fragment,{}):a.jsx("p",{className:"text-xs font-medium text-green-600 my-3",children:(u=JSON.parse(s.perintah_stok_opname_nomor_surat_perintah))!=null&&u.nomor_perintah_stok_opname?`Telah Terdaftar Pada Surat Perintah Stok Opname ${(m=JSON.parse(s.perintah_stok_opname_nomor_surat_perintah))==null?void 0:m.nomor_perintah_stok_opname}`:""}),g?a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"text-left text-sm",children:[a.jsxs("tr",{children:[a.jsx("td",{className:`${t?"pb-3":""}`,children:"Nomor Pengembalian Denda Penjualan Jasa"}),a.jsx("td",{className:`px-5 ${t?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${t?"pb-3":""}`,children:t?a.jsx(G,{addClass:"px-0",name:"nomor_pengembalian_denda_penjualan_jasa",value:_,onchange:l=>A(l.target.value)}):s.nomor_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${t?"pb-3":""}`,children:"Bukti Transaksi"}),a.jsx("td",{className:`px-5 ${t?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${t?"pb-3":""}`,children:t?a.jsx(G,{addClass:"px-0",name:"bukti_transaksi",value:y,onchange:l=>O(l.target.value)}):s.bukti_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${t?"pb-5":""}`,children:"Kode Akun"}),a.jsx("td",{className:`px-5 ${t?"pb-5":""}`,children:":"}),a.jsxs("td",{className:`${t?"pb-5":""}`,children:[s.kode_akun_perkiraan_code," - ",s.kode_akun_perkiraan_name]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${t?"pb-3":""}`,children:"Total PengembalianDenda"}),a.jsx("td",{className:`px-5 ${t?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${t?"pb-3":""}`,children:["Rp. ",j(P)]})]})]}),a.jsx("p",{className:`text-sm mt-3 ${t?"mt-5":""}`,children:"Keterangan"}),a.jsx("p",{className:"text-sm mb-3",children:t?a.jsx(G,{addClass:"mt-5",name:"keterangan",value:R,onchange:l=>N(l.target.value)}):s.keterangan}),a.jsxs("div",{className:"my-2 flex justify-between",children:[a.jsx("div",{children:t?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"mr-2 btn btn-sm bg-green-900 text-white",onClick:()=>C(),children:[a.jsx(ea,{size:12}),"Simpan"]}),a.jsxs("button",{className:"mr-2 btn btn-sm bg-red-500 text-white",onClick:()=>k(),children:[a.jsx(sa,{size:12}),"Hapus"]})]}):a.jsx(a.Fragment,{})}),x?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm border-red-500 text-red-500",onClick:()=>J(l=>l=!l),children:"Tutup Daftar PengembalianDenda"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm bg-white border-gray-400",onClick:()=>J(l=>l=!l),children:"Lihat Daftar PengembalianDenda"})})]}),x?a.jsx(a.Fragment,{children:a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Jasa"}),a.jsx("th",{children:"Nama Jasa"}),a.jsx("th",{children:"Satuan Jasa"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Denda Yang Dikembalikan"})]}),a.jsx("tbody",{children:v.map((l,E)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[E+1,"."]}),a.jsx("td",{children:l.kategori_harga_jasa_kode_jasa}),a.jsx("td",{children:l.daftar_jasa_name}),a.jsx("td",{children:l.satuan_jasa_name}),a.jsx("td",{children:l.daftar_gudang_name}),a.jsxs("td",{children:["Rp. ",j(l.denda_yang_dikembalikan)]})]})}))})]})})}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]})}):a.jsx(a.Fragment,{})]})},Ya=({fakturPenjualanJasa:s,setFakturCancel:t=()=>{},setTanggalTransaksiAkhir:r=()=>{}})=>{const[_,A]=n.useState(q()),[y,O]=n.useState({label:"Pelunasan",value:"Pelunasan"}),R=["Pelunasan","Retur","Pengembalian_Denda"],[N,P]=n.useState(),[S,v]=n.useState([]),[D,x]=n.useState([]),[J,g]=n.useState(!0),[$,d]=n.useState([]),b=()=>{g(u=>!1),t(u=>!0),d(u=>R.filter(m=>m!="Pengembalian_Denda").map(m=>({label:m.replace("_"," "),value:m}))),s&&ta.custom("/riwayat_transaksi/"+s.uuid).then(u=>{u.data.length>0&&(t(m=>!1),r(m=>u.data[0].tanggal),u.data.filter(m=>m.type=="retur_penjualan_jasa").length>0&&d(m=>R.map(l=>({label:l.replace("_"," "),value:l})))),x(m=>Oa(u.data))})},k=async u=>{if(u.preventDefault(),await X(u.target)){let m=aa;y.value=="Retur"&&(m=oa),y.value=="Pengembalian_Denda"&&(m=ma);const l={faktur_penjualan_jasa:s.uuid,tanggal:_,bukti_transaksi:"EMPTY",kode_akun_perkiraan:N.value,keterangan:"EMPTY"};l[`nomor_${y.value.toLowerCase()}_penjualan_jasa`]="EMPTY",m.custom("","POST",null,{data:l}).then(()=>{W("Berhasil","Data Berhasil Disimpan"),b(),A(q())}).catch(E=>F(E))}},C=()=>{ka.custom("/kas_bank","GET").then(u=>{v(m=>u.data),u.data.length>0&&P({label:`${u.data[0].code} - ${u.data[0].name}`,value:u.data[0].uuid})})},w=()=>{ka.custom("/piutang_usaha","GET").then(u=>{const m=[u.data];v(l=>m),m.length>0&&P({label:`${m[0].code} - ${m[0].name}`,value:m[0].uuid})})};return n.useEffect(()=>{g(u=>!0)},[D]),n.useEffect(()=>{if(v(u=>[]),P(u=>null),C(),y.value=="Retur"&&(w(),D.length>0)){const u=D.filter(m=>m.data.filter(l=>l.type=="pelunasan_penjualan_jasa").length>0);if(u.length>0){const m=u[0].data.filter(l=>l.type=="pelunasan_penjualan_jasa");m.length>0&&aa.custom(`/cek_denda_pelunasan_penjualan/${m[0].uuid}`,"GET").then(l=>{l.data==0&&C()}).catch(l=>F(l))}}},[y]),n.useEffect(()=>{b(),C()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white rounded-md mt-4 py-6 px-6 shadow-2xl",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Riwayat Transaksi Penjualan Jasa"}),a.jsxs("form",{className:"mb-5 border-[3px] rounded-md py-2 px-3",onSubmit:u=>k(u),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(U,{label:"Tanggal",type:"datetime-local",onchange:u=>{A(u.target.value)},others:{value:_,name:"tanggal"}}),a.jsx(Z,{label:"Tipe Transaksi",addClass:"z-50",optionsDataList:$,onchange:u=>{O(u)},optionsLabel:"label",optionsValue:"value",selectName:"tipe_transaksi",selectValue:y}),a.jsx(Z,{label:"Kode Akun",optionsDataList:S,optionsLabel:["code","name"],optionsValue:"uuid",addClass:"z-50",optionsLabelIsArray:!0,optionsDelimiter:"-",selectValue:N,onchange:u=>{P(u)},selectName:"kodeAkun"})]}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(la,{})," Simpan"]})]}),a.jsx("div",{className:"flex flex-col max-h-[60vh] overflow-scroll no-scrollbar relative",children:J?a.jsx(a.Fragment,{children:D.map((u,m)=>a.jsxs("div",{className:"mb-5",children:[a.jsx("p",{className:"font-bold mb-3 sticky top-0 bg-gray-300 p-2 z-20",children:Fa("/",Ta(u.parent,!1))}),a.jsx("div",{className:"flex flex-col",children:u.data.map((l,E)=>{var K,i,B;return a.jsxs(a.Fragment,{children:[l.type=="pelunasan_penjualan_jasa"?a.jsx(a.Fragment,{children:a.jsx(Ua,{riwayatPelunasanPenjualanJasa:l,edited:((K=JSON.parse(l.perintah_stok_opname_nomor_surat_perintah))==null?void 0:K.hasil_stok_opname_count)>0?!1:m==0&&E==0,_getDaftarRiwayatTransaksi:b})}):a.jsx(a.Fragment,{}),l.type=="retur_penjualan_jasa"?a.jsx(a.Fragment,{children:a.jsx(Ga,{riwayatReturPenjualanJasa:l,edited:((i=JSON.parse(l.perintah_stok_opname_nomor_surat_perintah))==null?void 0:i.hasil_stok_opname_count)>0?!1:m==0&&E==0,_getDaftarRiwayatTransaksi:b})}):a.jsx(a.Fragment,{}),l.type=="pengembalian_denda_penjualan_jasa"?a.jsx(a.Fragment,{children:a.jsx(Ia,{riwayatPengembalianDendaPenjualanJasa:l,edited:((B=JSON.parse(l.perintah_stok_opname_nomor_surat_perintah))==null?void 0:B.hasil_stok_opname_count)>0?!1:m==0&&E==0,_getDaftarRiwayatTransaksi:b})}):a.jsx(a.Fragment,{})]})})})]}))}):a.jsx(a.Fragment,{children:a.jsx("p",{className:"font-bold",children:"Riwayat Transaksi Belum Ada."})})})]})})},Va=ya.forwardRef((s,t)=>a.jsxs("div",{ref:t,children:[a.jsx(Ka,{bulan:s.bulan,tahun:s.tahun,title:"INVOICE"}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",children:"KEPADA :"}),a.jsx("p",{children:"Customer 1"}),a.jsx("p",{children:"CS00001 | 081276391273"})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-bold",children:"TANGGAL :"}),a.jsx("p",{children:"Senin, 19 Agustus 2024"})]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO FAKTUR PENJUALAN BARANG :"}),a.jsx("p",{children:"1890309801297939"})]}),a.jsx("div",{className:"text-right",children:a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO PESANAN PENJUALAN BARANG :"}),a.jsx("p",{children:"1890309801297939"})]})})]}),a.jsxs("div",{className:"mt-4 grid grid-cols-12 text-sm gap-x-2 py-2 font-bold border-t-2 px-6",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("p",{children:"No."})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{children:"Kode Jasa"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{children:"Nama Jasa"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{children:"Satuan Jasa"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{children:"Harga Jasa"})})]}),s.rincianPesananPenjualanJasa.map((r,_)=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"py-3  border-t-2",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 px-6 py-3 items-start font-bold",children:[a.jsx("div",{className:"col-span-1",children:a.jsxs("p",{className:"text-sm",children:[_+1,"."]})}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-sm",children:r.kategori_harga_jasa_kode_jasa}),a.jsx("p",{className:"text-sm my-1",children:r.daftar_gudang_name})]}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:r.daftar_jasa_name})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:r.satuan_jasa_name})}),a.jsxs("div",{className:"col-span-3",children:[a.jsxs("p",{className:"text-sm",children:["Rp. ",j(r.harga)]}),a.jsxs("p",{className:"text-sm",children:["PPN : Rp. ",j(r.ppn)]})]})]}),a.jsxs("div",{className:"grid grid-cols-12 text-sm gap-x-2 px-6 font-bold",children:[a.jsx("div",{className:"col-span-1"}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("p",{children:["Jumlah : ",j(r.jumlah)]}),r!=null&&r.retur?a.jsx(a.Fragment,{children:a.jsxs("p",{children:["Retur : ",j(r.retur)]})}):a.jsx(a.Fragment,{})]}),a.jsx("div",{className:"col-span-3",children:r.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsx("p",{children:"Diskon"}),a.jsx("p",{children:"Harga Diskon"}),a.jsx("p",{children:"PPN Diskon"})]}):a.jsx(a.Fragment,{})}),a.jsx("div",{className:"col-span-3",children:r.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["Rp. ",j(r.diskon_angka)," (",r.diskon_persentase," % )"]}),a.jsxs("p",{children:["Rp. ",j(r.harga_setelah_diskon)]}),a.jsxs("p",{children:["Rp. ",j(r.ppn_setelah_diskon)]})]}):a.jsx(a.Fragment,{})}),a.jsxs("div",{className:"col-span-3",children:["Total Harga ",a.jsxs("p",{children:["Rp. ",j(r.total_harga)]})]})]})]})})),a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 px-6 py-5 items-start font-bold border-t-2",children:[a.jsxs("div",{className:"col-span-9",children:[a.jsx("p",{children:"PEMBAYARAN"}),a.jsx("p",{className:"font-normal mt-5",children:"TERBILANG"}),a.jsxs("p",{children:[La(3e5).toString().toUpperCase()," RUPIAH"]})]}),a.jsx("div",{className:"col-span-3",children:a.jsxs("p",{children:["TOTAL ",a.jsx("br",{})," Rp. ",j(3e5)]})})]}),a.jsx("div",{className:"grid grid-cols-12 gap-x-2 px-6 py-5 items-start font-bold",children:a.jsxs("div",{className:"col-span-12",children:[a.jsx("p",{className:"mb-2",children:"TIPE PEMBAYARAN : KREDIT"}),a.jsx("p",{className:"font-normal",children:"SYARAT PEMBAYARAN : PELUNASAN 30 HARI"})]})}),a.jsx("div",{className:"grid grid-cols-12 gap-x-2 px-6 py-5 items-start font-bold",children:a.jsxs("div",{className:"col-span-12",children:[a.jsx("p",{className:"mb-2",children:"KETERANGAN"}),a.jsx("p",{className:"font-normal",children:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Recusandae consequatur sequi doloremque, aliquid tempora earum officiis quae quis ipsa saepe in quo fuga animi cum eum perspiciatis! Nemo, inventore doloribus."})]})})]})),Ma=({pesananPenjualanJasa:s,setFakturStatus:t=()=>{},fakturStatus:r,ppnStatus:_,setTanggalTransaksiAkhir:A=()=>{}})=>{const[y,O]=n.useState(),[R,N]=n.useState(!0),[P,S]=n.useState([]),[v,D]=n.useState([]),[x,J]=n.useState(q()),[g,$]=n.useState(),[d,b]=n.useState(),[k,C]=n.useState(),[w,u]=n.useState(),[m,l]=n.useState(),[E,K]=n.useState(""),i=useRef(),B=useReactToPrint({content:()=>i.current}),L=()=>{Sa.custom("","GET").then(c=>{S(p=>c.data.entry),c.data.entry.length>0&&C(p=>({label:c.data.entry[0].name,value:c.data.entry[0].uuid}))})},H=()=>{Ja.custom("/type/"+k.value,"GET").then(c=>{D(p=>c.data),c.data.length>0&&u(p=>({label:c.data[0].name,value:c.data[0].uuid}))})},o=async c=>{c.preventDefault(),await X(c.target)&&ta.custom("","POST",null,{data:{pesanan_penjualan_jasa:s.uuid,tanggal:x,nomor_faktur_penjualan_jasa:g,bukti_transaksi:d,tipe_pembayaran:k.value,syarat_pembayaran:w.value,keterangan:m,nomor_faktur_pajak_penjualan_jasa:E||"EMPTY"}}).then(p=>{t(Y=>p.data.uuid)}).catch(p=>F(p))},T=()=>{ta.custom(`/${r}`,"DELETE").then(()=>{t(c=>null)}).catch(c=>F(c))};n.useEffect(()=>{k!=null&&k.value&&H()},[k]);const e=()=>{ta.custom(`/pesanan_penjualan_jasa/${s.uuid}`,"GET").then(c=>{c.data&&(O(p=>c.data),$(p=>c.data.nomor_faktur_penjualan_jasa),b(p=>c.data.bukti_transaksi),J(p=>c.data.tanggal),C(p=>c.data.tipe_pembayaran_name),u(p=>c.data.syarat_pembayaran_name),l(p=>c.data.keterangan),t(p=>c.data.uuid),K(p=>c.data.nomor_faktur_pajak_penjualan_jasa!="EMPTY"?c.data.nomor_faktur_pajak_penjualan_jasa:""))}).catch(c=>{t(p=>null)})};return n.useEffect(()=>{r!=null&&(e(),L())},[r]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white rounded-md py-6 px-6 shadow-2xl",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Faktur Penjualan Jasa"}),a.jsxs("form",{onSubmit:c=>o(c),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(U,{label:"Tanggal Faktur Penjualan Jasa",type:"datetime-local",onchange:c=>{J(c.target.value)},disabled:r,addClassInput:r?"border-none px-1":"",others:{value:x,name:"tanggalFakturPenjualanJasa",disabled:r}}),a.jsx(U,{label:"Nomor Faktur Penjualan Jasa",type:"text",onchange:c=>{$(c.target.value)},disabled:r,addClassInput:r?"border-none px-1":"",others:{value:g,name:"nomorFakturPenjualanJasa",disabled:r}}),a.jsx(U,{label:"Bukti Transaksi",type:"text",disabled:r,addClassInput:r?"border-none px-1":"",onchange:c=>{b(c.target.value)},others:{value:d,name:"buktiTransaksi",disabled:r}}),r?a.jsxs(a.Fragment,{children:[a.jsx(U,{label:"Tipe Pembayaran",type:"text",disabled:r,addClassInput:r?"border-none px-1":"",others:{value:k,name:"tipePembayaran",disabled:r}}),a.jsx(U,{label:"Syarat Pembayaran",type:"text",disabled:r,addClassInput:r?"border-none px-1":"",others:{value:w,name:"syaratPembayaran",disabled:r}})]}):a.jsxs(a.Fragment,{children:[a.jsx(Z,{label:"Tipe Pembayaran",optionsDataList:P,optionsLabel:"name",optionsValue:"uuid",selectValue:k,onchange:c=>{C(c)},selectName:"tipePembayaran"}),a.jsx(Z,{label:"Syarat Pembayaran",optionsDataList:v,optionsLabel:"name",optionsValue:"uuid",selectValue:w,onchange:c=>{u(c)},selectName:"syaratPembayaran"})]})]}),a.jsx("div",{className:"flex gap-x-2",children:a.jsx(U,{label:"Keterangan",type:"text",disabled:r,addClassInput:r?"border-none px-1":"",onchange:c=>{l(c.target.value)},others:{value:m,name:"keteranganFakturPenjualanJasa",disabled:r}})}),_?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex gap-x-2",children:a.jsx(U,{label:"Nomor Faktur Pajak",type:"text",disabled:r,addClassInput:r?"border-none px-1":"",onchange:c=>{K(c.target.value)},others:{value:E,name:"nomorFakturPajakFakturPenjualanJasa",disabled:r}})})}):a.jsx(a.Fragment,{}),r?a.jsx(a.Fragment,{children:R?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"btn btn-sm bg-red-800 mt-4 text-white",type:"button",onClick:()=>T(),children:[a.jsx(M,{})," Batalkan Faktur"]}),a.jsx("div",{className:"hidden",children:a.jsx(Va,{ref:i,rincianPesananPenjualanJasa})}),a.jsxs("button",{className:"btn btn-sm bg-red-800 mt-4 text-white",type:"button",onClick:B,children:[a.jsx(Ra,{})," Cetak Faktur"]})]}):a.jsx(a.Fragment,{})}):a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(la,{})," Simpan"]})})]})]}),r?a.jsx(a.Fragment,{children:a.jsx(Ya,{fakturPenjualanJasa:y,setFakturCancel:N,setTanggalTransaksiAkhir:A})}):a.jsx(a.Fragment,{})]})},qa=({setAddPenjualanJasa:s=()=>{}})=>{Ca();const[t,r]=n.useState(q()),[_,A]=n.useState(!1),[y,O]=n.useState(!1),[R,N]=n.useState(!1),[P,S]=n.useState(!1),[v,D]=n.useState([]),[x,J]=n.useState(!0),[g,$]=n.useState([]),[d,b]=n.useState([]),[k,C]=n.useState(""),[w,u]=n.useState(q()),[m,l]=n.useState(),[E,K]=n.useState(!1),[i,B]=n.useState(""),[L,H]=n.useState({page:1,size:2,count:118,lastPage:12}),o=({selected:h})=>{let f=L;f.page=h+1,H(f),p()},T=h=>{let f=L;f.size=h,f.page=1,H(f),p()},[e,c]=n.useState(),p=(h="")=>{h==""&&B(h),Da.custom(`?search=${h}&page=${L.page}&size=${L.size}`,"GET").then(f=>{var I,na;K(h.length<1),b((I=f==null?void 0:f.data)==null?void 0:I.entry),H((na=f==null?void 0:f.data)==null?void 0:na.pagination)}).catch(f=>{F(f)})},Y=()=>{ra.custom(`/${e.uuid}`,"DELETE").then(h=>{c(null),ga()}).catch(h=>F(h))},z=async h=>{h.preventDefault(),await X(h.target)&&ra.custom(x?`/${x.value}`:"",x?"PUT":"POST",null,{data:{nomor_pesanan_penjualan_jasa:k,tanggal_pesanan_penjualan_jasa:w,customer:m.uuid}}).then(f=>{if(x){const I=v.filter(na=>na.uuid==x.value);c(I[0])}else c(f.data);S(I=>!0)}).catch(f=>{F(f),x&&(pa(),S(I=>!0),c(v.filter(I=>I.uuid==x.value)[0]))})},pa=()=>{l(f=>null),u(f=>q()),C(f=>null);const h=v.filter(f=>f.uuid==x.value);if(h.length>0){const f=d.filter(I=>I.uuid==h[0].customer);f.length>0&&(l(I=>f[0]),u(h[0].tanggal_pesanan_penjualan_jasa),C(h[0].nomor_pesanan_penjualan_jasa))}};n.useEffect(()=>{x&&pa()},[x]);const ga=()=>{ra.custom("","GET").then(h=>{D(f=>h.data.entry),h.data.entry.length>0&&J(f=>({label:h.data.entry[0].nomor_pesanan_penjualan_jasa,value:h.data.entry[0].uuid}))}).catch(h=>F(h))};return n.useEffect(()=>{R?ga():(C(h=>""),J(h=>!1),u(h=>q()),l(h=>null))},[R]),n.useEffect(()=>{p()},[]),a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-white rounded-md shadow-sm h-max",children:a.jsxs("div",{className:"py-5 px-6 h-max w-full z-10",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-2",children:"Pesanan Penjualan Jasa"})}),a.jsxs("form",{onSubmit:h=>z(h),children:[a.jsxs("div",{className:"flex items-end gap-x-2",children:[a.jsxs("div",{className:"flex items-end gap-x-2 w-full",children:[R&&!e?a.jsx(a.Fragment,{children:a.jsx(Z,{label:"Nomor Pesanan Penjualan Jasa",optionsDataList:v,optionsLabel:"nomor_pesanan_penjualan_jasa",optionsValue:"uuid",selectValue:x,onchange:h=>{J(h)},selectName:"pesananPenjualanJasaSelected"})}):a.jsx(a.Fragment,{children:a.jsx(U,{label:"Nomor Pesanan Penjualan Jasa",type:"text",disabled:e&&P,addClassInput:e&&P?"border-none px-1":"",onchange:h=>{C(h.target.value)},others:{value:k,name:"nomorPesananPenjualanJasa",disabled:e&&P}})}),e?a.jsx(a.Fragment,{children:g.length!=0||_?a.jsx(a.Fragment,{}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:`btn btn-sm ${P?"bg-yellow-400 hover:bg-yellow-400":""}`,onClick:()=>{S(h=>h=!h)},children:[P?a.jsx($a,{}):a.jsx(M,{})," ",P?"Edit":"Batal Edit"," Nomor Pesanan"]}),a.jsxs("button",{type:"button",onClick:()=>Y(),className:"btn btn-sm bg-red-700 text-white",children:[a.jsx(sa,{})," Hapus Nomor Pesanan"]})]})}):a.jsx(a.Fragment,{children:a.jsxs("button",{type:"button",className:`btn btn-sm ${R?"bg-red-900":"bg-blue-900"} text-white border-none`,onClick:()=>{N(h=>h=!h)},children:[R?a.jsx(M,{}):a.jsx(fa,{}),R?"Batal Pesanan Penjualan":"Pilih Pesanan Penjualan"]})})]}),a.jsx(U,{label:"Tanggal Pesanan Penjualan Jasa",type:"datetime-local",onchange:h=>{u(h.target.value)},disabled:e,addClassInput:e?"border-none px-1":"",others:{value:w,name:"tanggalPesananPenjualanJasa",disabled:e}})]}),m?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"mt-5 relative px-1",children:[a.jsx("p",{className:"font-bold text-sm mb-3",children:"Customer Terpilih"}),a.jsxs("p",{className:"text-xl font-bold",children:[m.code," - ",m.name]}),a.jsxs("div",{className:"mt-3 flex gap-x-10",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Alamat Rumah"}),a.jsx("p",{className:"text-sm",children:m.alamat_rumah})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Alamat Kantor"}),a.jsx("p",{className:"text-sm",children:m.alamat_kantor})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"NPWP"}),a.jsx("p",{className:"text-sm",children:m.npwp})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Nomor Telepon"}),a.jsx("p",{className:"text-sm",children:m.no_telp})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Nomor Handphone"}),a.jsx("p",{className:"text-sm",children:m.no_hp})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Kode Harga"}),a.jsxs("p",{className:"text-sm",children:["Harga ",m.kode_harga]})]})]}),e?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"absolute top-0 right-3 flex mt-3 py-1 px-2 gap-x-2 items-center font-bold text-xs rounded-md bg-red-800 text-white",onClick:()=>{l(null)},type:"button",children:a.jsx(M,{})})})]})}):a.jsx(a.Fragment,{}),m?a.jsx(a.Fragment,{children:e&&P?a.jsx(a.Fragment,{children:a.jsxs("button",{type:"button",onClick:()=>{c(h=>null),l(h=>null),N(h=>!1),A(h=>!1)},className:"btn btn-sm bg-red-800 mt-4 text-white",children:[a.jsx(M,{})," Reset Pesanan Penjualan"]})}):a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(la,{})," Simpan"]})})}):a.jsx(a.Fragment,{})]}),m?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"mt-5",children:[a.jsxs("div",{className:"flex w-full items-center gap-x-2 mb-5",children:[a.jsx(G,{value:i,onchange:h=>B(h.target.value),other:{placeholder:"Cari Customer"}}),E?a.jsx(fa,{onClick:()=>{p(i)},className:"cursor-pointer"}):a.jsx(M,{onClick:()=>p(""),className:"cursor-pointer"})]}),a.jsxs("table",{className:"table table-zebra",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Kode Customer"}),a.jsx("th",{children:"Nama Customer"}),a.jsx("th",{children:"Kode Harga"}),a.jsx("th",{children:"Aksi"})]})}),a.jsx("tbody",{children:d==null?void 0:d.map((h,f)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[f+1,"."]}),a.jsx("td",{width:400,children:h.code}),a.jsx("td",{width:400,children:h.name}),a.jsxs("td",{width:400,children:["Harga ",h.kode_harga]}),a.jsx("td",{children:a.jsxs("button",{className:"flex py-1 px-5 gap-x-2 items-center rounded-xl bg-green-800 text-white",onClick:()=>{l(I=>h)},type:"button",children:[a.jsx(ea,{size:12.5}),a.jsx("p",{children:"Pilih"})]})})]},f)}))})]}),a.jsx(Ba,{paginateUpdatePage:o,paginate:L,setSize:T,shadow:"",sizeList:[2,4,6]})]})})]})}),e&&P?a.jsxs(a.Fragment,{children:[a.jsx(Ha,{pesananPenjualanJasa:e,customer:m,fakturStatus:_,setPPNStatus:O,tanggalTransaksiAkhir:t,rincianPesananPenjualanJasa:g,setRincianPesananPenjualanJasa:$}),a.jsx(Ma,{pesananPenjualanJasa:e,rincianPesananPenjualanJasa:g,setFakturStatus:A,fakturStatus:_,ppnStatus:y,setTanggalTransaksiAkhir:r})]}):a.jsx(a.Fragment,{})]})},ce=()=>{const[s,t]=n.useState(!1),[r,_]=n.useState(!1);return n.useState(""),n.useState(!0),a.jsx(Aa,{isLoading:s,children:a.jsxs("div",{children:[a.jsx(Ea,{title:"Penjualan Jasa"}),a.jsx(qa,{setAddPenjualanJasa:_})]})})};export{ce as default};
