import{r as l,O as z,j as e,b as C,h as D,ae as $,s as y,k as O,bG as S,n as F,R as K,u as U,o as W,e as A,p as G,i as H,a as I,F as J,q as V}from"./index-BFtBgOrg.js";import{P as q}from"./PageTitle-Hc-YSVDI.js";import{f as M,W as Y}from"./Wrap-Dk-wg8kL.js";import{P as Q}from"./Pagination-CNke5GoU.js";import{F as p}from"./FormInputWithLabel-zEsdZ3IQ.js";import{F as X}from"./FormSelectWithLabel-BuQTQxHx.js";import{a as Z}from"./actionEvent.helper-BujKUZ7B.js";import{P as E,l as ee}from"./PDFHeader-BGA35-Z9.js";import"./react-paginate-C1eAq6Tf.js";import"./FormInput-DctP6iug.js";import"./number.helper-efe0YCx6.js";import"./index-BKNjMPK8.js";const ae=({setAddPenggunaanPerlengkapanEvent:i=()=>{},penggunaanPerlengkapanEdit:a,getData:r=()=>{}})=>{const[x,h]=l.useState([]),[m,g]=l.useState(a!=null&&a.tanggal_beli?a.tanggal_beli:z()),[u,N]=l.useState(a!=null&&a.bukti_transaksi?a.bukti_transaksi:null),[j,v]=l.useState(a!=null&&a.jumlah?a.jumlah:null),[P,d]=l.useState(a!=null&&a.daftar_perlengkapan?a.daftar_perlengkapan:null),[b,f]=l.useState(a!=null&&a.keterangan?a.keterangan:null),w=()=>{$.custom("","GET").then(t=>{if(h(t.data.entry),t.data.entry.length>0){if(a){M({editObject:a.daftar_perlengkapan,dataList:t.data.entry,setState:d,labelKey:"name",valueKey:"uuid"});return}d({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}}).catch(t=>{y(t)})},c=async()=>{await O()&&S.custom(`${a!=null&&a.uuid?`/${a.uuid}`:""}`,a?"PUT":"POST",null,{data:{tanggal:m,bukti_transaksi:u,jumlah:j,daftar_perlengkapan:P.value,keterangan:b}}).then(()=>{a?F("Berhasil","Data berhasil diupdate"):F("Berhasil","Data berhasil disimpan"),i(),r()}).catch(t=>{y(t)})};return l.useEffect(()=>{w()},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[e.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[e.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[a?"Edit":"Tambahkan"," Penggunaan Perlengkapan"]}),e.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>i(),children:[e.jsx(C,{})," Batalkan Penggunaan Perlengkapan"]})]}),e.jsxs("div",{className:"flex gap-x-2",children:[e.jsx(p,{label:"Tanggal Beli",type:"datetime-local",onchange:t=>{g(t.target.value)},others:{value:m,name:"tanggalBeliPenggunaanPerlengkapan"}}),e.jsx(p,{label:"Bukti Transaksi",type:"text",onchange:t=>{N(t.target.value)},others:{value:u,name:"buktiTransaksiPenggunaanPerlengkapan"}}),e.jsx(p,{label:"Jumlah",type:"text",onchange:t=>{Z(t),v(t.target.value)},others:{value:j,name:"jumlahPenggunaanPerlengkapan"}}),e.jsx(X,{label:"Daftar Perlengkapan",optionsDataList:x,optionsLabel:"name",optionsValue:"uuid",selectValue:P,onchange:t=>{d(t)},selectName:"daftarPerlengkapanPenggunaanPerlengkapan"})]}),e.jsx("div",{className:"mt-5 flex gap-x-2",children:e.jsx(p,{label:"Keterangan Penggunaan Perlengkapan",type:"text",onchange:t=>{f(t.target.value)},others:{value:b,name:"keteranganPenggunaanPerlengkapan"}})}),e.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",onClick:()=>{c()},children:[e.jsx(D,{})," Simpan"]})]})})},te=K.forwardRef((i,a)=>{var r;return e.jsxs("div",{ref:a,children:[e.jsx(E,{bulan:i.bulan,tahun:i.tahun,title:"Penggunaan Perlengkapan"}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[e.jsx("th",{width:12,children:"No"}),e.jsx("th",{children:"Nama Penggunaan Perlengkapan"})]})}),e.jsx("tbody",{children:(r=i==null?void 0:i.data)==null?void 0:r.map((x,h)=>e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{children:h+1}),e.jsx("td",{children:x.name})]},h)}))})]})]})}),ge=()=>{const i=U(),{data:a}=i,[r,x]=l.useState([]),[h,m]=l.useState(!1),[g,u]=l.useState(!1),[N,j]=l.useState({name:""}),[v,P]=l.useState(!1),[d,b]=l.useState(""),f=l.useRef(),w=ee.useReactToPrint({content:()=>f.current}),[c,t]=l.useState({page:1,size:10,count:118,lastPage:12}),o=(n="")=>{n==""&&b(n),m(!0),S.custom(`?search=${n}&page=${c.page}&size=${c.size}`,"GET").then(s=>{var k,T;P(n.length<1),x((k=s==null?void 0:s.data)==null?void 0:k.entry),t((T=s==null?void 0:s.data)==null?void 0:T.pagination),m(!1)}).catch(s=>{y(s)})},_=n=>{let s=r[n];j(s),u(!g)},B=async n=>{if(await V("Hapus","Yakin ingin hapus data ini ?")){let s=r[n];S.custom(`/${s.uuid}`,"DELETE").then(()=>{F("Berhasil","Data berhasil dihapus"),o()}).catch(k=>{y(k)})}},L=({selected:n})=>{let s=c;s.page=n+1,t(s),o()},R=n=>{let s=c;s.size=n,s.page=1,t(s),o()};return l.useEffect(()=>{o()},[]),e.jsx(Y,{isLoading:h,children:e.jsxs("div",{children:[e.jsx(q,{title:"Penggunaan Perlengkapan"}),g?e.jsx(ae,{setAddPenggunaanPerlengkapanEvent:()=>u(!1),getData:o,penggunaanPerlengkapanEdit:N}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[e.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[e.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:d,onChange:n=>b(n.target.value)}),v?e.jsx(W,{onClick:()=>{o(d)},className:"cursor-pointer"}):e.jsx(C,{onClick:()=>o(""),className:"cursor-pointer"})]}),e.jsxs("div",{className:"flex gap-x-2 items-center",children:[e.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{j(null),u(!g)},children:[e.jsx(A,{})," Tambah Penggunaan Perlengkapan"]}),e.jsx("div",{className:"hidden",children:e.jsx(te,{data:r,ref:f,bulan:G(new Date().getMonth()),tahun:a.tahun})}),e.jsxs("button",{onClick:w,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[e.jsx(H,{})," Cetak Penggunaan Perlengkapan"]})]})]}),e.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[e.jsx("th",{width:12,children:"No"}),e.jsx("th",{children:"Tanggal"}),e.jsx("th",{children:"Bukti Transaksi"}),e.jsx("th",{children:"Jumlah"}),e.jsx("th",{children:"Perlengkapan"}),e.jsx("th",{children:"Aksi"})]})}),e.jsx("tbody",{children:r==null?void 0:r.map((n,s)=>e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsxs("td",{children:[s+1,"."]}),e.jsx("td",{children:n.tanggal}),e.jsx("td",{children:n.bukti_transaksi}),e.jsx("td",{children:n.jumlah}),e.jsx("td",{children:n.daftar_perlengkapan_name}),e.jsxs("td",{className:"flex gap-x-2",children:[e.jsx(I,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{_(s)}}),e.jsx(J,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{B(s)}})]})]},s)}))})]})}),e.jsx(Q,{paginateUpdatePage:L,paginate:c,setSize:R})]})]})})};export{ge as default};
