import{r as l,O as Z,j as e,b as G,h as E,a0 as ee,s as p,a2 as ae,A as te,az as se,k as ne,aA as I,n as V,R as le,u as oe,o as ie,e as re,p as ue,i as ce,c as he,a as pe,F as xe,q as ge}from"./index-CH4D0Lt-.js";import{P as me}from"./PageTitle-DbvUOkqr.js";import{f as P,W as be}from"./Wrap-5ys34sV1.js";import{P as je}from"./Pagination-BzIqssJ_.js";import{F as u}from"./FormInputWithLabel-DSO_Zp9u.js";import{i as F}from"./actionEvent.helper-BujKUZ7B.js";import{F as K}from"./FormSelectWithLabel-B3WnVhHo.js";import{p as x}from"./number.helper-efe0YCx6.js";import{P as ke,l as De}from"./PDFHeader-nmfnFTDc.js";import"./react-paginate-CJd_j2MB.js";import"./FormInput-S8fN4g0j.js";import"./index-BKNjMPK8.js";const ve=({setAddDaftarPerlengkapanEvent:i=()=>{},daftarPerlengkapanEdit:a,getData:o=()=>{}})=>{const[b,g]=l.useState([]),[S,j]=l.useState([]),[k,f]=l.useState([]),[y,C]=l.useState([]),[N,_]=l.useState(a!=null&&a.name?a.name:""),[D,d]=l.useState(a!=null&&a.nomor_invoice?a.nomor_invoice:""),[T,c]=l.useState(a!=null&&a.bukti_transaksi?a.bukti_transaksi:""),[m,r]=l.useState(a!=null&&a.tanggal_beli?a.tanggal_beli:Z()),[w,v]=l.useState(a!=null&&a.supplier?a.supplier:""),[L,A]=l.useState(a!=null&&a.kuantitas?x(a.kuantitas):""),[n,s]=l.useState(a!=null&&a.satuan_barang?a.satuan_barang:""),[h,B]=l.useState(a!=null&&a.harga_satuan?x(a.harga_satuan):""),[z,W]=l.useState(a!=null&&a.dpp?x(a.dpp):""),[O,q]=l.useState(a!=null&&a.ppn?x(a.ppn):""),[U,R]=l.useState(a!=null&&a.kode_akun_perkiraan?a.kode_akun_perkiraan:""),[H,$]=l.useState(a!=null&&a.kategori_perlengkapan?a.kategori_perlengkapan:""),M=()=>{ee.custom("","GET").then(t=>{if(g(t.data.entry),t.data.entry.length>0){if(a){P({editObject:a.supplier,dataList:t.data.entry,setState:v,labelKey:"name",valueKey:"uuid"});return}v({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}}).catch(t=>{p(t)})},Y=()=>{ae.custom("","GET").then(t=>{if(j(t.data.entry),t.data.entry.length>0){if(a){P({editObject:a.satuan_barang,dataList:t.data.entry,setState:s,labelKey:"name",valueKey:"uuid"});return}s({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}}).catch(t=>{p(t)})},J=()=>{te.custom("/aset_perlengkapan","GET").then(t=>{if(f(t.data),t.data.length>0){if(a){P({editObject:a.kode_akun_perkiraan,dataList:t.data,setState:R,labelKey:"name",valueKey:"uuid"});return}R({label:`${t.data[0].code} - ${t.data[0].name}`,value:t.data[0].uuid})}}).catch(t=>{p(t)})},Q=()=>{se.custom("","GET").then(t=>{if(C(t.data.entry),t.data.entry.length>0){if(a){P({editObject:a.kategori_perlengkapan,dataList:t.data.entry,setState:$,labelKey:"name",valueKey:"uuid"});return}$({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}}).catch(t=>{p(t)})},X=async()=>{await ne()&&I.custom(`${a!=null&&a.uuid?`/${a.uuid}`:""}`,a?"PUT":"POST",null,{data:{name:N,nomor_invoice:D,bukti_transaksi:T,tanggal_beli:m,kategori_perlengkapan:H.value,supplier:w.value,kuantitas:L,kode_akun_perkiraan:U.value,satuan_barang:n.value,harga_satuan:h,dpp:z,ppn:O}}).then(()=>{a?V("Berhasil","Data berhasil diupdate"):V("Berhasil","Data berhasil disimpan"),i(),o()}).catch(t=>{p(t)})};return l.useEffect(()=>{M(),Y(),J(),Q()},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[e.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[e.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[a?"Edit":"Tambahkan"," Daftar Perlengkapan"]}),e.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>i(),children:[e.jsx(G,{})," Batalkan Daftar Perlengkapan"]})]}),e.jsxs("div",{className:"flex gap-x-2",children:[e.jsx(u,{label:"Nama Perlengkapan",type:"text",onchange:t=>{_(t.target.value)},others:{value:N,name:"namaDaftarPerlengkapan"}}),e.jsx(u,{label:"Nomor Invoice",type:"text",onchange:t=>{d(t.target.value)},others:{value:D,name:"nomorInvoiceDaftarPerlengkapan"}}),e.jsx(u,{label:"Bukti Transaksi",type:"text",onchange:t=>{c(t.target.value)},others:{value:T,name:"buktiTransaksiDaftarPerlengkapan"}}),e.jsx(u,{label:"Tanggal Beli",type:"datetime-local",onchange:t=>{r(t.target.value)},others:{value:m,name:"tanggalBeliDaftarPerlengkapan"}}),e.jsx(K,{label:"Kode Akun",optionsDataList:k,optionsLabel:["code","name"],optionsLabelIsArray:!0,optionsValue:"uuid",optionsDelimiter:"-",selectValue:U,onchange:t=>{R(t)},selectName:"kodeAkunPerkiraanDaftarPerlengkapan"}),e.jsx(K,{label:"Kategori Perlengkapan",optionsDataList:y,optionsLabel:"name",optionsValue:"uuid",selectValue:H,onchange:t=>{$(t)},selectName:"kategoriPerlengkapanDaftarPerlengkapan"})]}),e.jsxs("div",{className:"mt-5 flex gap-x-2",children:[e.jsx(K,{label:"Supplier",optionsDataList:b,optionsLabel:"name",optionsValue:"uuid",selectValue:w,onchange:t=>{v(t)},selectName:"supplierDaftarPerlengkapan"}),e.jsx(u,{label:"Kuantitas",type:"text",onchange:t=>{F(t),A(t.target.value)},others:{value:L,name:"kuantitasDaftarPerlengkapan"}}),e.jsx(K,{label:"Satuan Barang",optionsDataList:S,optionsLabel:"name",optionsValue:"uuid",selectValue:n,onchange:t=>{s(t)},selectName:"satuanBarangDaftarPerlengkapan"}),e.jsx(u,{label:"Harga Satuan",type:"text",onchange:t=>{F(t),B(t.target.value)},others:{value:h,name:"hargaSatuanDaftarPerlengkapan"}})]}),e.jsxs("div",{className:"mt-5 flex gap-x-2",children:[e.jsx(u,{label:"DPP",type:"text",onchange:t=>{F(t),W(t.target.value)},others:{value:z,name:"DPPDaftarPerlengkapan"}}),e.jsx(u,{label:"PPN",type:"text",onchange:t=>{F(t),q(t.target.value)},others:{value:O,name:"PPNDaftarPerlengkapan"}})]}),e.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",onClick:()=>{X()},children:[e.jsx(E,{})," Simpan"]})]})})},Se=le.forwardRef((i,a)=>{var o;return e.jsxs("div",{ref:a,children:[e.jsx(ke,{bulan:i.bulan,tahun:i.tahun,title:"Daftar Perlengkapan"}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[e.jsx("th",{width:12,children:"No"}),e.jsx("th",{children:"Nama Daftar Perlengkapan"})]})}),e.jsx("tbody",{children:(o=i==null?void 0:i.data)==null?void 0:o.map((b,g)=>e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{children:g+1}),e.jsx("td",{children:b.name})]},g)}))})]})]})}),Ce=()=>{const i=oe(),{data:a}=i,[o,b]=l.useState([]),[g,S]=l.useState(!1),[j,k]=l.useState(!1),[f,y]=l.useState({name:""}),[C,N]=l.useState(!1),[_,D]=l.useState(""),d=l.useRef(),T=De.useReactToPrint({content:()=>d.current}),[c,m]=l.useState({page:1,size:10,count:118,lastPage:12}),r=(n="")=>{n==""&&D(n),S(!0),I.custom(`?search=${n}&page=${c.page}&size=${c.size}`,"GET").then(s=>{var h,B;N(n.length<1),b((h=s==null?void 0:s.data)==null?void 0:h.entry),m((B=s==null?void 0:s.data)==null?void 0:B.pagination),S(!1)}).catch(s=>{p(s)})},w=n=>{let s=o[n];y(s),k(!j)},v=async n=>{if(await ge("Hapus","Yakin ingin hapus data ini ?")){let s=o[n];I.custom(`/${s.uuid}`,"DELETE").then(()=>{V("Berhasil","Data berhasil dihapus"),r()}).catch(h=>{p(h)})}},L=({selected:n})=>{let s=c;s.page=n+1,m(s),r()},A=n=>{let s=c;s.size=n,s.page=1,m(s),r()};return l.useEffect(()=>{r()},[]),e.jsx(be,{isLoading:g,children:e.jsxs("div",{children:[e.jsx(me,{title:"Daftar Perlengkapan"}),j?e.jsx(ve,{setAddDaftarPerlengkapanEvent:()=>k(!1),getData:r,daftarPerlengkapanEdit:f}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[e.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[e.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:_,onChange:n=>D(n.target.value)}),C?e.jsx(ie,{onClick:()=>{r(_)},className:"cursor-pointer"}):e.jsx(G,{onClick:()=>r(""),className:"cursor-pointer"})]}),e.jsxs("div",{className:"flex gap-x-2 items-center",children:[e.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{y(null),k(!j)},children:[e.jsx(re,{})," Tambah Daftar Perlengkapan"]}),e.jsx("div",{className:"hidden",children:e.jsx(Se,{data:o,ref:d,bulan:ue(new Date().getMonth()),tahun:a.tahun})}),e.jsxs("button",{onClick:T,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[e.jsx(ce,{})," Cetak Daftar Perlengkapan"]})]})]}),e.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[e.jsx("th",{width:12,children:"No"}),e.jsx("th",{children:"Nama Daftar Perlengkapan"}),e.jsx("th",{children:"Nomor Invoice"}),e.jsx("th",{children:"Tanggal Beli"}),e.jsx("th",{children:"Kategori Perlengkapan"}),e.jsx("th",{children:"Total Beli"}),e.jsx("th",{children:"DPP"}),e.jsx("th",{children:"PPN"}),e.jsx("th",{children:"Aksi"})]})}),e.jsx("tbody",{children:o==null?void 0:o.map((n,s)=>e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsxs("td",{children:[s+1,"."]}),e.jsx("td",{children:n.name}),e.jsx("td",{children:n.nomor_invoice}),e.jsx("td",{children:`${n.tanggal_beli.split("T")[0]} ${he(n.tanggal_beli.split("T")[1])}`}),e.jsx("td",{children:n.kategori_perlengkapan_name}),e.jsx("td",{children:x(n.harga_satuan*n.kuantitas)}),e.jsx("td",{children:x(n.dpp)}),e.jsx("td",{children:x(n.ppn)}),e.jsxs("td",{className:"flex gap-x-2",children:[e.jsx(pe,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{w(s)}}),e.jsx(xe,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{v(s)}})]})]},s)}))})]})}),e.jsx(je,{paginateUpdatePage:L,paginate:c,setSize:A})]})]})})};export{Ce as default};
