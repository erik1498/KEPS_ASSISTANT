import{r,j as a,h as G,aN as C,s as T,O,b as $,k as U,aO as F,n as S,ax as V,R as D,u as I,o as W,e as H,p as J,i as q,a as M,F as Y,q as Q}from"./index-DZCXWm7f.js";import{P as X}from"./PageTitle-CmhTXHkp.js";import{f as L,W as Z}from"./Wrap-DcwCOsCB.js";import{P as E}from"./Pagination-CKy31gga.js";import{F as P}from"./FormInputWithLabel-CJ6pr1p6.js";import{F as A}from"./FormSelectWithLabel-BRttMTTK.js";import{i as aa}from"./actionEvent.helper-BujKUZ7B.js";import{p as ea}from"./number.helper-efe0YCx6.js";import{F as ta}from"./FormInput-BS-RLPlt.js";import{P as sa,l as na}from"./PDFHeader-C5EAnyc_.js";import"./react-paginate-DQywGu_z.js";import"./index-BKNjMPK8.js";const R=({transferBahanBaku:i,preview:e})=>{const[n,o]=r.useState([]),g=()=>{C.custom(`/by_transfer_bahan_baku/${i.uuid}`).then(t=>{o(u=>t.data)}).catch(t=>T(t))},_=(t,u)=>{let d=n;d=d.map(c=>(c.stok_awal_bahan_baku==u&&(c.jumlah=t),c)),o(c=>d)},x=t=>{n[t].stok_awal_bahan_baku_tujuan?C.custom(n[t].uuid?`/${n[t].uuid}`:"",n[t].uuid?"PUT":"POST",null,{data:{transfer_bahan_baku:i.uuid,stok_awal_bahan_baku:n[t].stok_awal_bahan_baku,jumlah:n[t].jumlah,stok_awal_bahan_baku_tujuan:n[t].stok_awal_bahan_baku_tujuan}}).then(()=>{t<n.length-1?x(t+1):g()}).catch(u=>T(u)):x(t+1)};return r.useEffect(()=>{g()},[i]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"my-5 bg-white py-5 rounded-md",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Daftar Bahan Baku"}),a.jsx("div",{className:"overflow-x-auto max-h-[40vh] h-max no-scrollbar pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 z-50 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Bahan Baku"}),a.jsx("th",{children:"Kode Bahan Baku"}),a.jsx("th",{children:"Satuan Bahan Baku"}),a.jsx("th",{width:150,children:"Jumlah"})]})}),a.jsx("tbody",{children:n==null?void 0:n.map((t,u)=>t.stok_awal_bahan_baku_tujuan&&a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[u+1,"."]}),a.jsx("td",{children:t.daftar_bahan_baku_nama_bahan_baku}),a.jsx("td",{children:t.kategori_harga_bahan_baku_kode_bahan_baku}),a.jsx("td",{children:t.satuan_bahan_baku}),a.jsx("td",{children:e?a.jsx(a.Fragment,{children:t.jumlah}):a.jsx(a.Fragment,{children:a.jsx(ta,{name:"jumlah",type:"text",other:{defaultValue:t.jumlah},onchange:d=>{aa(d),_(d.target.value,t.stok_awal_bahan_baku)},value:ea(t.jumlah)})})})]},u)}))})]})}),e?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-3 text-white",onClick:()=>{x(0)},children:[a.jsx(G,{})," Simpan"]})})]})})},la=({setAddTransferBahanBakuEvent:i=()=>{},transferBahanBakuEdit:e,getData:n=()=>{}})=>{const[o,g]=r.useState(e!=null&&e.tanggal?e.tanggal:O()),[_,x]=r.useState(e!=null&&e.kode_transfer_bahan_baku?e.kode_transfer_bahan_baku:""),[t,u]=r.useState(e!=null&&e.daftar_gudang_asal?e.daftar_gudang_asal:""),[d,c]=r.useState(e!=null&&e.daftar_gudang_akhir?e.daftar_gudang_akhir:""),[v,w]=r.useState([]),[f,y]=r.useState([]),[b,j]=r.useState(),k=async()=>{await U()&&F.custom(`${e!=null&&e.uuid?`/${e.uuid}`:""}`,e?"PUT":"POST",null,{data:{tanggal:o,kode_transfer_bahan_baku:_,daftar_gudang_asal:t.value,daftar_gudang_akhir:d.value}}).then(s=>{e?(j(p=>e),S("Berhasil","Data berhasil diupdate")):(j(p=>s.data),S("Berhasil","Data berhasil disimpan"))}).catch(s=>{T(s)})};r.useEffect(()=>{const s=v.filter(p=>p.uuid!=t.value);y(s),s.length>0&&c({label:s[0].name,value:s[0].uuid})},[t]);const m=()=>{V.custom("","GET").then(s=>{if(w(p=>s.data.entry),s.data.entry.length>0){if(e){L({editObject:e.daftar_gudang_asal,dataList:s.data.entry,setState:u,labelKey:"name",valueKey:"uuid"}),L({editObject:e.daftar_gudang_akhir,dataList:s.data.entry,setState:c,labelKey:"name",valueKey:"uuid"});return}u({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}})};return r.useEffect(()=>{m()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[e?"Edit":"Tambahkan"," Transfer Bahan Baku"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>{n(),i()},children:[a.jsx($,{})," Batalkan Transfer Bahan Baku"]})]}),a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(P,{label:"Tanggal Transfer Bahan Baku",type:"datetime-local",onchange:s=>{g(s.target.value)},others:{value:o,disabled:b,tanggal:"tanggalTransferBahanBaku"}}),a.jsx(P,{label:"Kode Transfer Bahan Baku",type:"text",onchange:s=>{x(s.target.value)},others:{value:_,disabled:b,tanggal:"kodeTransferBahanBaku"}}),a.jsx(A,{label:"Gudang Asal",optionsDataList:f,optionsLabel:"name",optionsValue:"uuid",selectValue:t,disabled:b,onchange:s=>{u(s)},selectName:"gudangAsalTransferBahanBaku"}),a.jsx(A,{label:"Gudang Akhir",optionsDataList:f,optionsLabel:"name",optionsValue:"uuid",selectValue:d,disabled:b,onchange:s=>{c(s)},selectName:"gudangAkhirTransferBahanBaku"})]}),b?a.jsx(a.Fragment,{children:a.jsx(R,{transferBahanBaku:b})}):a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",onClick:()=>{k()},children:[a.jsx(G,{})," Simpan"]})}),e&&!b?a.jsx(a.Fragment,{children:a.jsx(R,{transferBahanBaku:e,preview:!0})}):a.jsx(a.Fragment,{})]})})},ra=D.forwardRef((i,e)=>{var n;return a.jsxs("div",{ref:e,children:[a.jsx(sa,{bulan:i.bulan,tahun:i.tahun,title:"Transfer Bahan Baku"}),a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Transfer Bahan Baku"})]})}),a.jsx("tbody",{children:(n=i==null?void 0:i.data)==null?void 0:n.map((o,g)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:g+1}),a.jsx("td",{children:o.name})]},g)}))})]})]})}),pa=()=>{const i=I(),{data:e}=i,[n,o]=r.useState([]),[g,_]=r.useState(!1),[x,t]=r.useState(!1),[u,d]=r.useState({name:""}),[c,v]=r.useState(!1),[w,f]=r.useState(""),y=r.useRef(),b=na.useReactToPrint({content:()=>y.current}),[j,k]=r.useState({page:1,size:10,count:118,lastPage:12}),m=(h="")=>{h==""&&f(h),_(!0),F.custom(`?search=${h}&page=${j.page}&size=${j.size}&tahun=${e.tahun}`,"GET").then(l=>{var N,B;v(h.length<1),o((N=l==null?void 0:l.data)==null?void 0:N.entry),k((B=l==null?void 0:l.data)==null?void 0:B.pagination),_(!1)}).catch(l=>{T(l)})},s=h=>{let l=n[h];d(l),t(!x)},p=async h=>{if(await Q("Hapus","Yakin ingin hapus data ini ?")){let l=n[h];F.custom(`/${l.uuid}`,"DELETE").then(()=>{S("Berhasil","Data berhasil dihapus"),m()}).catch(N=>{T(N)})}},z=({selected:h})=>{let l=j;l.page=h+1,k(l),m()},K=h=>{let l=j;l.size=h,l.page=1,k(l),m()};return r.useEffect(()=>{m()},[]),a.jsx(Z,{isLoading:g,children:a.jsxs("div",{children:[a.jsx(X,{title:"Transfer Bahan Baku"}),x?a.jsx(la,{setAddTransferBahanBakuEvent:()=>t(!1),getData:m,transferBahanBakuEdit:u}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:w,onChange:h=>f(h.target.value)}),c?a.jsx(W,{onClick:()=>{m(w)},className:"cursor-pointer"}):a.jsx($,{onClick:()=>m(""),className:"cursor-pointer"})]}),a.jsxs("div",{className:"flex gap-x-2 items-center",children:[a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{d(null),t(!x)},children:[a.jsx(H,{})," Tambah Transfer Bahan Baku"]}),a.jsx("div",{className:"hidden",children:a.jsx(ra,{data:n,ref:y,bulan:J(new Date().getMonth()),tahun:e.tahun})}),a.jsxs("button",{onClick:b,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[a.jsx(q,{})," Cetak Transfer Bahan Baku"]})]})]}),a.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Tanggal"}),a.jsx("th",{children:"Kode"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Gudang Akhir"}),a.jsx("th",{children:"Aksi"})]})}),a.jsx("tbody",{children:n==null?void 0:n.map((h,l)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[l+1,"."]}),a.jsx("td",{children:h.tanggal}),a.jsx("td",{children:h.kode_transfer_bahan_baku}),a.jsx("td",{children:h.daftar_gudang_asal_name}),a.jsx("td",{children:h.daftar_gudang_akhir_name}),a.jsxs("td",{className:"flex gap-x-2",children:[a.jsx(M,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{s(l)}}),a.jsx(Y,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{p(l)}})]})]},l)}))})]})}),a.jsx(E,{paginateUpdatePage:z,paginate:j,setSize:K})]})]})})};export{pa as default};
