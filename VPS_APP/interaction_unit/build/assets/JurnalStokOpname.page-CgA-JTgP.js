import{j as a,p as E,w as K,r as n,W,x as A,Q as M,f as y,z as Q,bU as m,t as p,C as q,B as H}from"./index-Les8lMu8.js";import{F as i}from"./FormInputWithLabel-BfngycS3.js";import{J as X}from"./JurnalStokOpnameRowData-BDahMGZO.js";import{D as Y}from"./DebetKreditStatusCard-Dl9bHa9v.js";import"./JurnalStokOpnameUraian-DRjyU9q9.js";const Z=({item:t,balanceStatus:u=!0,forPrint:c=!1})=>t.total.debet!=0&&t.total.kredit!=0?a.jsxs("div",{className:`flex flex-col px-3 w-full bg-white text-[13px] ${c?"":"shadow-md"}`,children:[a.jsx("div",{className:"grid grid-cols-12 sticky top-0 bg-white py-2 border-b-2",children:a.jsxs("div",{className:"p-2 col-span-9 text-black flex items-end",children:[a.jsx("div",{className:"text-[28px] font-bold",children:u?a.jsx("p",{className:`text-[45px] -ml-1 text-white px-2 rounded-md ${t.total.debet==t.total.kredit?"bg-green-900":"bg-red-900"}`,children:t.tanggal<10?`0${t.tanggal}`:t.tanggal}):a.jsx("p",{className:"text-[45px] -ml-1 text-white px-2 rounded-md bg-green-900",children:t.tanggal<10?`0${t.tanggal}`:t.tanggal})}),a.jsx("div",{className:"flex flex-col",children:a.jsxs("div",{className:"flex items-end",children:[a.jsxs("div",{className:"text-gray-900 flex flex-col justify-end px-2",children:[a.jsxs("h1",{children:[t.bulan,".",t.tahun]}),a.jsx("h2",{className:"text-[13px] font-bold",children:t.hari})]}),a.jsxs("div",{className:"flex flex-col px-2 border-l-2 border-gray-600",children:[a.jsx("h1",{className:"font-bold",children:"Total"}),a.jsxs("div",{className:"flex gap-x-4",children:[a.jsx("div",{className:"text-right",children:a.jsx("h1",{className:" text-green-900 font-bold flex flex-row",children:E(t.total.debet)})}),a.jsx("div",{className:"text-right",children:a.jsx("h1",{className:" text-red-900 font-bold",children:E(t.total.kredit)})})]})]})]})})]})}),t.buktiTransaksi.map(o=>a.jsx(a.Fragment,{children:a.jsx(X,{forPrint:c,item1:o,balanceStatus:!0})}))]}):a.jsx(a.Fragment,{}),na=()=>{var v,k,N,S,w,_,O,P;const t=K(),{data:u}=t,[c,o]=n.useState(!1),[x,g]=n.useState([]),[r,I]=n.useState(null),[L,J]=n.useState(0),[T,B]=n.useState(0),[b,z]=n.useState([]),[F,f]=n.useState(!1),[U,$]=n.useState([]),R=()=>{o(e=>!0),m.custom(`?tahun=${u.tahun}`,"GET").then(e=>{o(l=>!1),g(l=>e.data.entry)}).catch(e=>{o(l=>!1),p(e)})},s=()=>{const e=x.filter(l=>l.uuid==(r==null?void 0:r.value));return e.length>0?e[0]:null},V=()=>{m.custom(`/jurnal/${r.value}`,"GET").then(e=>{z(e.data)}).catch(e=>p(e))},G=async()=>{const e=await q(H(b));console.log(e),J(e.totalDebet),B(e.totalKredit),$(e==null?void 0:e.returnData)},j=()=>{var e,l;m.custom("/validasi","PUT",null,{data:{validasi:!((e=s())!=null&&e.validasi),perintah_stok_opname:(l=s())==null?void 0:l.uuid}}).then(()=>{const d=x.findIndex(C=>{var D;return C.uuid==((D=s())==null?void 0:D.uuid)}),h=x;h[d].validasi=!s().validasi,f(h[d].validasi),g(C=>h)}).catch(d=>p(d))};return n.useEffect(()=>{G()},[b]),n.useEffect(()=>{if(r){const e=x.filter(l=>{var d;return l.uuid==((d=s())==null?void 0:d.uuid)});f(e.at(0).validasi),V()}},[r]),n.useEffect(()=>{R()},[]),a.jsx(W,{isLoading:c,children:a.jsxs("div",{children:[a.jsx(A,{title:"Jurnal Stok Opname"}),a.jsx("div",{className:"bg-white rounded-md shadow-sm h-max",children:a.jsxs("div",{className:"py-5 px-6 h-max w-full z-10",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-2",children:"Perintah Stok Opname"})}),a.jsxs("div",{className:"flex gap-y-2",children:[a.jsx(M,{label:"Perintah Stok Opname",optionsDataList:x,optionsLabel:"nomor_surat_perintah",optionsValue:"uuid",selectValue:r,onchange:e=>{I(e)},selectName:"perintahStokOpname"}),a.jsx(i,{label:"Pegawai Penanggung Jawab",disabled:!0,addClassInput:"border-none px-1",others:{value:(v=s())==null?void 0:v.pegawai_penanggung_jawab_name}}),a.jsx(i,{label:"Pegawai Pelaksana",disabled:!0,addClassInput:"border-none px-1",others:{value:(k=s())==null?void 0:k.pegawai_pelaksana_name}})]}),a.jsxs("div",{className:"mt-5 flex gap-x-2",children:[a.jsx(i,{label:"Kategori Barang",disabled:!0,addClassInput:"border-none px-1",others:{value:(N=s())==null?void 0:N.kategori_barang_name}}),a.jsx(i,{label:"Gudang Asal",disabled:!0,addClassInput:"border-none px-1",others:{value:(S=s())==null?void 0:S.daftar_gudang_name}}),a.jsx(i,{label:"Tanggal Mulai",disabled:!0,addClassInput:"border-none px-1",others:{value:y((w=s())==null?void 0:w.tanggal)}}),a.jsx(i,{label:"Tanggal Selesai",disabled:!0,addClassInput:"border-none px-1",others:{value:((_=s())==null?void 0:_.tanggal_selesai)!="BELUM SELESAI"?y((O=s())==null?void 0:O.tanggal_selesai):"BELUM SELESAI"}}),a.jsx(i,{label:"Bulan Transaksi",disabled:!0,addClassInput:"border-none px-1",others:{value:Q(((P=s())==null?void 0:P.bulan_transaksi)-1)}})]}),a.jsx("div",{className:"mt-5 flex",children:F&&r?a.jsx("button",{onClick:()=>j(),className:"btn btn-sm bg-red-900 text-white",children:"Batal Validasi"}):a.jsx("button",{onClick:()=>j(),className:"btn btn-sm bg-green-900 text-white",children:"Validasi"})})]})}),a.jsxs("div",{className:"grid grid-cols-6 gap-x-2 mt-2",children:[a.jsx("div",{className:"col-span-1",children:a.jsx(Y,{debet:L,kredit:T})}),a.jsx("div",{className:"col-span-5",children:a.jsx("div",{className:"h-[65vh]",children:a.jsx("div",{className:"flex flex-col h-full overflow-y-scroll no-scrollbar w-full rounded-md",children:U.map((e,l)=>a.jsx(Z,{item:e,forPrint:!1},l))})})})]})]})})};export{na as default};
