import{R as q,j as a,f as z,p as $,r as c,a7 as M,d as I,Q as R,m as U,e as Z,n as B,b$ as E,t as k,o as aa,c0 as T,a3 as ea,as as J,bJ as sa,w as la,W as ta,x as na,y as ca,l as da,$ as ra,ae as G,b as ua,F as oa,bX as ha,D as ia,v as ja}from"./index-DkLWHN4U.js";import{P as xa,l as H}from"./PDFHeader-DqJvDgdi.js";import{F as V}from"./FormInputWithLabel-CsT-VGf4.js";import{i as ma}from"./actionEvent.helper-R7pYClSI.js";import"./react-paginate-ByHbu1vo.js";import"./index-BKNjMPK8.js";const ba=q.forwardRef((l,e)=>{var m,g,y,b,i,h,N,j,S,v,x,_;return a.jsxs("div",{ref:e,children:[a.jsx(xa,{bulan:l==null?void 0:l.bulan,tahun:l==null?void 0:l.tahun,title:"Surat Jalan",useTime:!1}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",children:"KEPADA :"}),a.jsx("p",{children:(m=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:m.customer_name}),a.jsx("p",{children:(g=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:g.customer_code}),a.jsxs("p",{className:"my-4",children:["Alamat:",a.jsx("br",{}),(y=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:y.customer_alamat_kantor]}),a.jsxs("p",{className:"mb-4",children:["HP: ",a.jsx("br",{}),(b=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:b.customer_no_hp]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-bold",children:"TANGGAL :"}),a.jsx("p",{children:z((i=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:i.tanggal)})]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO FAKTUR PENJUALAN BARANG :"}),a.jsx("p",{children:(N=(h=l==null?void 0:l.fakturPenjualanBarang)==null?void 0:h.at(0))==null?void 0:N.nomor_faktur_penjualan_barang})]}),a.jsx("div",{className:"text-right",children:a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO PESANAN PENJUALAN BARANG :"}),a.jsx("p",{children:(j=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:j.nomor_pesanan_penjualan_barang})]})})]}),a.jsx("div",{className:"flex justify-between",children:a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO SURAT JALAN :"}),a.jsx("p",{children:(S=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:S.nomor_surat_jalan})]})}),a.jsx("p",{className:"pt-5",children:"Dikirimkan barang-barang sebagai berikut :"}),a.jsxs("div",{className:"mt-4 grid grid-cols-12 text-sm gap-x-2 py-2 font-bold border-t-2",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("p",{children:"No."})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{children:"Kode Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{children:"Nama Barang"})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{children:"Satuan Barang"})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{children:"Jumlah Beli"})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{children:"Jumlah Pengiriman"})})]}),(v=l==null?void 0:l.pengirimanBarangList)==null?void 0:v.map((n,d)=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"py-3  border-y-2",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 py-3 items-start font-bold",children:[a.jsx("div",{className:"col-span-1",children:a.jsxs("p",{className:"text-sm",children:[d+1,"."]})}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-sm",children:n==null?void 0:n.kategori_harga_barang_kode_barang}),a.jsx("p",{className:"text-xs font-normal",children:n==null?void 0:n.daftar_gudang_name})]}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:n==null?void 0:n.daftar_barang_name})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-sm",children:n==null?void 0:n.satuan_barang_name})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-sm",children:$(n==null?void 0:n.jumlah)})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-sm",children:$(n==null?void 0:n.pengiriman)})})]}),a.jsx("p",{className:"font-normal text-xs pb-16",children:"Keterangan"})]})})),a.jsxs("div",{className:"grid grid-cols-12 py-5 gap-5 items-start font-bold",children:[l.gudangList.map(n=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"col-span-4 border-b-2 border-black",children:[a.jsxs("p",{className:"mb-20",children:["Pihak ",n]}),a.jsx("p",{children:" "})]})})),a.jsxs("div",{className:"col-span-4 border-b-2 border-black",children:[a.jsx("p",{className:"mb-20",children:"Penanggung Jawab"}),a.jsx("p",{className:"font-normal",children:(x=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:x.pegawai_penanggung_jawab_name})]}),a.jsxs("div",{className:"col-span-4 border-b-2 border-black",children:[a.jsx("p",{className:"mb-20",children:"Pelaksana"}),a.jsx("p",{className:"font-normal",children:(_=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:_.pegawai_pelaksana_name})]}),a.jsxs("div",{className:"col-span-4 border-b-2 border-black",children:[a.jsx("p",{className:"mb-20",children:"Diterima Oleh"}),a.jsx("p",{children:" "})]})]})]})}),Na=({setAddPengirimanBarangEvent:l=()=>{},pengirimanBarangEdit:e,getData:m=()=>{}})=>{const[g,y]=c.useState([]),[b,i]=c.useState(e!=null&&e.tanggal?e.tanggal:M()),[h,N]=c.useState(e!=null&&e.faktur_penjualan_barang?e.faktur_penjualan_barang:""),[j,S]=c.useState(e!=null&&e.nomor_surat_jalan?e.nomor_surat_jalan:""),[v,x]=c.useState(e!=null&&e.pegawai_penanggung_jawab?e.pegawai_penanggung_jawab:""),[_,n]=c.useState(e!=null&&e.pegawai_pelaksana?e.pegawai_pelaksana:""),[d,F]=c.useState(null),[f,p]=c.useState([]),[L,A]=c.useState([]),[t,r]=c.useState([]),u=async s=>{E.custom(`${t[s].uuid!=""?`/${t[s].uuid}`:""}`,t[s].uuid!=""?"PUT":"POST",null,{data:{pengiriman_barang:d,rincian_pesanan_penjualan_barang:t[s].rincian_pesanan_penjualan_barang,jumlah:`${t[s].jumlah}`,pengiriman:`${t[s].pengiriman}`}}).then(()=>{s+1<t.length?u(s+1):(m(),l())}).catch(o=>{k(o)})},w=c.useRef(),C=H.useReactToPrint({content:()=>w.current}),D=async s=>{s.preventDefault(),await aa(s.target)&&T.custom(e?`/${e.uuid}`:"",e?"PUT":"POST",null,{data:{tanggal:b,faktur_penjualan_barang:h.value,nomor_surat_jalan:j,pegawai_pelaksana:_.value,pegawai_penanggung_jawab:v.value}}).then(o=>{F(e?P=>e.uuid:P=>o.data.uuid)}).catch(o=>{k(o)})},W=()=>{ea.custom("","GET").then(s=>{if(A(s.data.entry),s.data.entry.length>0){if(e){J({editObject:e.pegawai_penanggung_jawab,dataList:s.data.entry,setState:x,labelKey:"name",valueKey:"uuid"}),J({editObject:e.pegawai_pelaksana,dataList:s.data.entry,setState:n,labelKey:"name",valueKey:"uuid"});return}x({label:s.data.entry[0].name,value:s.data.entry[0].uuid}),n({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>k(s))},Q=()=>{sa.custom("","GET").then(s=>{if(p(s.data.entry),s.data.entry.length>0){if(e){J({editObject:e.faktur_penjualan_barang,dataList:s.data.entry,setState:N,labelKey:"nomor_faktur_penjualan_barang",valueKey:"uuid"});return}N({label:s.data.entry[0].nomor_faktur_penjualan_barang,value:s.data.entry[0].uuid})}}).catch(s=>k(s))},X=()=>{T.custom(`/daftar_pesanan/${d}`,"GET").then(s=>{r(s.data)}).catch(s=>k(s))},Y=(s,o)=>{const P=t,K=t.findIndex(O=>O.rincian_pesanan_penjualan_barang==o);K>-1&&(P[K].pengiriman=s),r(O=>P)};return c.useEffect(()=>{let s=g;t.map(o=>{s.includes(o.daftar_gudang_name)||s.push(o.daftar_gudang_name)}),y(o=>s)},[t]),c.useEffect(()=>{d&&X()},[d]),c.useEffect(()=>{Q(),W(),e!=null&&e.preview&&F(e==null?void 0:e.uuid)},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[e?`${e!=null&&e.preview?"Lihat":"Edit"}`:"Tambahkan"," Pengiriman Barang"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>l(),children:[a.jsx(I,{})," ",e!=null&&e.preview?"Tutup":"Batalkan Pengiriman Barang"]})]}),a.jsxs("form",{onSubmit:s=>D(s),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(V,{label:"Tanggal",type:"datetime-local",onchange:s=>{i(s.target.value)},addClassInput:d||e?"border-none !px-1":"",disabled:d||e,others:{value:b,name:"tanggal"}}),a.jsx(R,{label:"Faktur Penjualan Barang",optionsDataList:f,optionsLabel:"nomor_faktur_penjualan_barang",optionsValue:"uuid",selectValue:h,addClass:d||e?"border-none !px-1":"",disabled:d||e,onchange:s=>{N(s)},selectName:"fakturPenjualanBarang"}),a.jsx(V,{label:"Nomor Surat Jalan",type:"text",addClassInput:d||e!=null&&e.preview?"border-none !px-1":"",onchange:s=>{S(s.target.value)},disabled:d||(e==null?void 0:e.preview),others:{value:j,name:"nomorSuratJalan"}}),a.jsx(R,{label:"Pegawai Penanggung Jawab",optionsDataList:L,optionsLabel:"name",optionsValue:"uuid",selectValue:v,addClass:d||e!=null&&e.preview?"border-none !px-1":"",disabled:d||(e==null?void 0:e.preview),onchange:s=>{x(s)},selectName:"pegawaiPenanggungJawab"}),a.jsx(R,{label:"Pegawai Pelaksana",addClass:d||e!=null&&e.preview?"border-none !px-1":"",optionsDataList:L,optionsLabel:"name",optionsValue:"uuid",selectValue:_,disabled:d||(e==null?void 0:e.preview),onchange:s=>{n(s)},selectName:"pegawaiPelaksana"})]}),d?a.jsx(a.Fragment,{}):a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(U,{})," Simpan"]})]}),d?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto rounded-md h-max max-h-[90vh] no-scrollbar mt-5 pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Jumlah Beli"}),a.jsx("th",{width:30,children:"Jumlah Pengiriman"})]})}),a.jsx("tbody",{children:t==null?void 0:t.map((s,o)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[o+1,"."]}),a.jsx("td",{children:s.kategori_harga_barang_kode_barang}),a.jsx("td",{children:s.daftar_barang_name}),a.jsx("td",{children:s.satuan_barang_name}),a.jsx("td",{children:s.jumlah}),a.jsx("td",{children:e!=null&&e.preview?a.jsx(a.Fragment,{children:s.pengiriman}):a.jsx(a.Fragment,{children:a.jsx(Z,{name:"pengiriman_"+o,type:"text",other:{defaultValue:s.pengiriman},onchange:P=>{ma(P,s.jumlah),Y(P.target.value,s.rincian_pesanan_penjualan_barang)}})})})]},o)}))})]})}),e!=null&&e.preview?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden",children:a.jsx(ba,{ref:w,pengirimanBarangList:t,gudangList:g,pengirimanBarangEdit:e,fakturPenjualanBarang:f.filter(s=>s.uuid==h.value)})}),a.jsxs("button",{className:"btn btn-sm bg-red-800 mt-4 text-white",type:"button",onClick:C,children:[a.jsx(B,{})," Cetak Surat Jalan"]})]}):a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",type:"button",onClick:()=>{u(0)},children:[a.jsx(U,{})," Simpan"]})]}):a.jsx(a.Fragment,{})]})})},ka=()=>{la();const[l,e]=c.useState([]),[m,g]=c.useState([]),[y,b]=c.useState(!1),[i,h]=c.useState(!1),[N,j]=c.useState({name:""}),[S,v]=c.useState(!1),[x,_]=c.useState(""),n=c.useRef();H.useReactToPrint({content:()=>n.current});const[d,F]=c.useState({page:1,size:10,count:118,lastPage:12}),f=(t="")=>{t==""&&_(t),b(!0),T.custom(`?search=${t}`,"GET").then(r=>{var w,C;let u=ha(r.data.entry,"nomor_faktur_penjualan_barang");v(t.length<1),g(u),e((w=r==null?void 0:r.data)==null?void 0:w.entry),F((C=r==null?void 0:r.data)==null?void 0:C.pagination),b(!1)}).catch(r=>{k(r)})},p=t=>{t.preview=!1,j(t),h(!i)},L=t=>{t.preview=!0,j(t),h(!i)},A=async t=>{await ia("Hapus","Yakin ingin hapus data ini ?")&&T.custom(`/${t.uuid}`,"DELETE").then(()=>{ja("Berhasil","Data berhasil dihapus"),f()}).catch(r=>{k(r)})};return c.useEffect(()=>{f()},[]),a.jsx(ta,{isLoading:y,children:a.jsxs("div",{children:[a.jsx(na,{title:"Pengiriman Barang"}),i?a.jsx(Na,{setAddPengirimanBarangEvent:()=>h(!1),getData:f,pengirimanBarangEdit:N}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:x,onChange:t=>_(t.target.value)}),S?a.jsx(ca,{onClick:()=>{f(x)},className:"cursor-pointer"}):a.jsx(I,{onClick:()=>f(""),className:"cursor-pointer"})]}),a.jsx("div",{className:"flex gap-x-2 items-center",children:a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{j(null),h(!i)},children:[a.jsx(da,{})," Tambah Pengiriman Barang"]})})]}),a.jsx("div",{className:"overflow-x-auto px-3 bg-white shadow-xl rounded-md",children:m==null?void 0:m.map((t,r)=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-3 border-b-2 border-gray-400",children:[a.jsx("p",{className:"text-xs",children:"Nomor Faktur Penjualan"}),a.jsx("p",{className:"font-bold",children:t.parent})]}),t.data.map((u,w)=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"px-6 py-4 flex gap-x-4 items-center",children:[a.jsx(ra,{className:"text-blue-800",size:11}),a.jsxs("div",{className:"grid grid-cols-9 w-full",children:[a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Tanggal"}),a.jsx("p",{className:"text-sm font-bold",children:z(u.tanggal)})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Nomor Surat Jalan"}),a.jsx("p",{className:"text-sm font-bold",children:u==null?void 0:u.nomor_surat_jalan})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Penanggung Jawab"}),a.jsx("p",{className:"text-sm font-bold",children:u.pegawai_penanggung_jawab_name})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Pelaksana"}),a.jsx("p",{className:"text-sm font-bold",children:u.pegawai_pelaksana_name})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsx("p",{className:"text-xs",children:"Aksi"}),w==0?a.jsx(a.Fragment,{children:a.jsx("div",{children:a.jsxs("div",{className:"flex items-center",children:[a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-green-400",onClick:()=>{L(u)},children:[a.jsx(G,{size:10}),"Lihat"]}),a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-yellow-400",onClick:()=>{p(u)},children:[a.jsx(ua,{size:10}),"Edit"]}),a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-red-600",onClick:()=>{A(u)},children:[a.jsx(oa,{size:10}),"Hapus"]})]})})}):a.jsx(a.Fragment,{children:a.jsx("div",{children:a.jsx("div",{className:"flex items-center",children:a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-green-400",onClick:()=>{L(u)},children:[a.jsx(G,{size:10}),"Lihat"]})})})})]})]})]})}))]}))})]})]})})};export{ka as default};
