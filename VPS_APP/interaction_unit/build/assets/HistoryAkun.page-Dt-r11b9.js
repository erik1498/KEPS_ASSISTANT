import{G as j,I as T,r as i,j as e,p as m,c as E,P as R,J as D,A as N,R as L,w as O,i as H,W as J,x as B,d as C,y as I,h as K,z as $,n as U,K as _,B as M,t as z}from"./index-mkcrex3p.js";import{B as G}from"./BulanSelectedListCard-DtwZoyqk.js";import{J as V}from"./JurnalStokOpnameUraian-ewqWBme4.js";import{P as W}from"./PendapatanRowUraian-DhJJpL8f.js";import{J as Y}from"./JurnalPenyusutanRowUraian-Be9_Iq8f.js";import{P as q,l as Q}from"./PDFHeader-BGRASuEm.js";import"./index-BKNjMPK8.js";const X=a=>new Promise((l,n)=>{let t=0,d=0;try{t=j(a.map(s=>s.debet)),d=j(a.map(s=>s.kredit))}catch{t=0,d=0}let u=[],r="00",c=[],h=[];a.map(s=>{s.tanggal!=r&&(r=s.tanggal,u[`${parseInt(r)}`]={total:{kredit:0,debet:0},dataList:a.filter(p=>p.tanggal==r),tanggal:s.tanggal,bulan:s.bulan,tahun:s.tahun,hari:T[new Date(`${s.tahun}-${s.bulan}-${r}`).getDay()]},c=[],h=[]),c.push(s.debet),h.push(s.kredit),u[`${parseInt(r)}`].total={debet:j(c),kredit:j(h)}}),l({totalDebet:t,totalKredit:d,returnData:u})}),Z=({item:a})=>{const[l,n]=i.useState(null);return i.useEffect(()=>{a.detail_data=JSON.parse(JSON.parse(a.uraian).detail),n(t=>a)},[]),e.jsx(e.Fragment,{children:e.jsx(V,{data:l})})},ee=({item:a})=>{const[l,n]=i.useState(null);return i.useEffect(()=>{let{uraian:t,...d}=a;const u=JSON.parse(t),r=Object.keys(u);for(let c=0;c<r.length;c++){const h=r[c];d[h]=u[h]}n(c=>d)},[]),e.jsx(e.Fragment,{children:e.jsx(W,{data:l,showDetail:!0})})},v=({item:a,balanceStatus:l=!0,forPrint:n})=>e.jsxs("div",{className:`flex flex-col w-full bg-white text-[13px] ${n?"":"px-3 shadow-md"}`,children:[e.jsxs("div",{className:"grid grid-cols-12 sticky top-0 bg-white py-2 border-b-2",children:[e.jsxs("div",{className:"p-2 col-span-12 text-black flex items-end",children:[e.jsx("div",{className:"text-[28px] font-bold",children:e.jsx("p",{className:"text-[45px] -ml-1 text-white px-2 rounded-md bg-blue-900",children:a.tanggal})}),e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex items-end",children:[e.jsxs("div",{className:"text-gray-900 flex flex-col justify-end px-2",children:[e.jsxs("h1",{children:[a.bulan,".",a.tahun]}),e.jsx("h2",{className:"text-[13px] font-bold",children:a.hari})]}),l?e.jsxs("div",{className:"flex flex-col px-2 border-l-2 border-gray-600",children:[e.jsx("h1",{className:"font-bold",children:"Total"}),e.jsxs("div",{className:"flex gap-x-4",children:[e.jsx("div",{className:"text-right text-gray-900",children:e.jsx("h1",{className:" text-green-900 font-bold flex flex-row",children:m(a.total.debet)})}),e.jsx("div",{className:"text-right text-gray-900",children:e.jsx("h1",{className:" text-red-900 font-bold",children:m(a.total.kredit)})})]})]}):e.jsx(e.Fragment,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-12 col-span-12 items-end pt-1 font-bold",children:[e.jsx("div",{className:"col-span-1 text-gray-900 flex flex-col px-2",children:e.jsx("p",{children:"Waktu"})}),e.jsx("div",{className:"col-span-3 text-gray-900 flex flex-col px-2",children:e.jsx("p",{children:"Uraian"})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:e.jsx("h1",{children:"Debet"})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:e.jsx("h1",{children:"Kredit"})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:e.jsx("h1",{children:"Saldo Debet"})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:e.jsx("h1",{children:"Saldo Kredit"})})]})]}),a.dataList.map((t,d)=>e.jsx(e.Fragment,{children:t.debet=="0.00"&&t.kredit=="0.00"?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:[d>0?e.jsx("hr",{}):e.jsx(e.Fragment,{}),d<=a.dataList.length?e.jsxs("div",{className:"grid grid-cols-12 items-start py-1",children:[e.jsx("div",{className:"col-span-1 px-2 text-black",children:E(t.waktu)}),e.jsx("div",{className:"col-span-3 text-gray-900 flex flex-col px-2",children:R.includes(t.sumber)?e.jsx(Z,{item:t}):e.jsx(e.Fragment,{children:D.includes(t.sumber)?e.jsx(ee,{item:t}):e.jsx(e.Fragment,{children:N.includes(t.sumber)?e.jsx(Y,{data:t,bg_color:!0}):e.jsx("p",{children:t.uraian})})})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:parseFloat(t.debet).toFixed(2)!="0.00"?e.jsx("h1",{className:" text-green-900 font-bold",children:m(parseFloat(t.debet).toFixed(2))}):e.jsx(e.Fragment,{})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:parseFloat(t.kredit).toFixed(2)!="0.00"?e.jsx("h1",{className:" text-red-900 font-bold",children:m(parseFloat(t.kredit).toFixed(2))}):e.jsx(e.Fragment,{})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:e.jsx("h1",{className:" text-green-900 font-bold",children:m(parseFloat(t.saldoDebet).toFixed(2))})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:e.jsx("h1",{className:" text-red-900 font-bold",children:m(parseFloat(t.saldoKredit).toFixed(2))})})]}):e.jsx(e.Fragment,{})]})}))]}),ae=L.forwardRef((a,l)=>e.jsxs("div",{ref:l,children:[e.jsx(q,{bulan:a.bulan,tahun:a.tahun,title:"History Akun"}),e.jsx("h1",{className:"text-4xl font-bold mt-5",children:a.kode_akun_perkiraan}),a.data.map((n,t)=>e.jsx(v,{item:n,balanceStatus:a.balanceStatus,forPrint:!0},t))]})),ce=()=>{const a=O(),{data:l}=a,[n,t]=i.useState(new Date().getMonth()),[d,u]=i.useState(""),[r,c]=i.useState(!0),[h,s]=i.useState([]),[p,S]=i.useState(H()),y=i.useRef(),F=Q.useReactToPrint({content:()=>y.current}),[A,k]=i.useState(!1),f=(o="")=>{o==""&&u(o),k(!0),_.custom(`/${p.value}/${n+1}/${l.tahun}?search=${o}`,"GET").then(async x=>{let P=x==null?void 0:x.data.filter(g=>!N.includes(g.sumber)),b=x==null?void 0:x.data.filter(g=>N.includes(g.sumber)).map(g=>(g.detail_data=JSON.stringify(JSON.parse(g.uraian).detail),g));b=M(b);let w=await X(P.concat(...b));c(o.length<1),s(w.returnData),k(!1)}).catch(x=>{z(x)})};return i.useEffect(()=>{p.value!=""&&f()},[n,p]),e.jsx(e.Fragment,{children:e.jsx(J,{isLoading:A,children:e.jsxs("div",{children:[e.jsx(B,{title:"History Akun"}),e.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[e.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[e.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:d,onChange:o=>u(o.target.value)}),r?e.jsx(I,{className:"cursor-pointer",onClick:()=>f(d)}):e.jsx(C,{className:"cursor-pointer",onClick:()=>{f("")}})]}),e.jsx("div",{className:"w-[400px]",children:e.jsx(K,{optionsDataList:l.kodeAkun,optionsLabel:["code","name"],optionsValue:"uuid",optionsLabelIsArray:!0,optionsDelimiter:"-",selectValue:p,onchange:o=>S(o),selectName:"kodeAkun",addClass:"w-full"})})]}),e.jsxs("div",{className:"grid grid-cols-6",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx(G,{bulan:n,setBulan:t}),e.jsx("div",{className:"hidden",children:e.jsx(ae,{data:h,balanceStatus:r,ref:y,tahun:l.tahun,bulan:$(n),kode_akun_perkiraan:p.label})}),e.jsxs("button",{onClick:F,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[e.jsx(U,{})," Cetak History Akun"]})]}),e.jsx("div",{className:"col-span-5",children:e.jsx("div",{className:"h-[65vh] pl-2",children:e.jsx("div",{className:"flex flex-col h-full overflow-y-scroll no-scrollbar w-full rounded-md",children:h.map((o,x)=>e.jsx(v,{item:o,balanceStatus:r,forPrint:!1},x))})})})]})]})})})};export{ce as default};
