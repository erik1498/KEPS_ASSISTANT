import{w as z,r as n,a7 as W,j as a,d as U,Q as R,m as V,e as H,b$ as A,t as h,o as Q,c0 as F,a3 as X,as as $,bJ as Y,W as q,x as M,y as Z,l as D,n as B,f as E,b as aa,F as ea,bX as ta,D as na,v as sa}from"./index-D7FFK5V-.js";import{l as la}from"./index-jWbY3wwG.js";import{F as I}from"./FormInputWithLabel-rzCFdr6g.js";import{i as ra}from"./actionEvent.helper-DGW4m-ag.js";import"./react-paginate-DytSg5hj.js";const oa=({setAddPengirimanBarangEvent:C=()=>{},pengirimanBarangEdit:t,getData:j=()=>{}})=>{z();const[w,L]=n.useState(t!=null&&t.tanggal?t.tanggal:W()),[p,i]=n.useState(t!=null&&t.faktur_penjualan_barang?t.faktur_penjualan_barang:""),[b,T]=n.useState(t!=null&&t.nomor_surat_jalan?t.nomor_surat_jalan:""),[_,f]=n.useState(t!=null&&t.pegawai_penanggung_jawab?t.pegawai_penanggung_jawab:""),[P,x]=n.useState(t!=null&&t.pegawai_pelaksana?t.pegawai_pelaksana:""),[s,y]=n.useState(null),[J,k]=n.useState([]),[N,d]=n.useState([]),[r,v]=n.useState([]),l=async e=>{A.custom(`${r[e].uuid!=""?`/${r[e].uuid}`:""}`,r[e].uuid!=""?"PUT":"POST",null,{data:{pengiriman_barang:s,rincian_pesanan_penjualan_barang:r[e].rincian_pesanan_penjualan_barang,jumlah:`${r[e].jumlah}`,pengiriman:`${r[e].pengiriman}`}}).then(()=>{e+1<r.length?l(e+1):(j(),C())}).catch(c=>{h(c)})},o=async e=>{e.preventDefault(),await Q(e.target)&&F.custom(t?`/${t.uuid}`:"",t?"PUT":"POST",null,{data:{tanggal:w,faktur_penjualan_barang:p.value,nomor_surat_jalan:b,pegawai_pelaksana:P.value,pegawai_penanggung_jawab:_.value}}).then(c=>{y(t?g=>t.uuid:g=>c.data.uuid)}).catch(c=>{h(c)})},u=()=>{X.custom("","GET").then(e=>{if(d(e.data.entry),e.data.entry.length>0){if(t){$({editObject:t.pegawai_penanggung_jawab,dataList:e.data.entry,setState:f,labelKey:"name",valueKey:"uuid"}),$({editObject:t.pegawai_pelaksana,dataList:e.data.entry,setState:x,labelKey:"name",valueKey:"uuid"});return}f({label:e.data.entry[0].name,value:e.data.entry[0].uuid}),x({label:e.data.entry[0].name,value:e.data.entry[0].uuid})}}).catch(e=>h(e))},m=()=>{Y.custom("","GET").then(e=>{if(k(e.data.entry),e.data.entry.length>0){if(t){$({editObject:t.faktur_penjualan_barang,dataList:e.data.entry,setState:i,labelKey:"nomor_faktur_penjualan_barang",valueKey:"uuid"});return}i({label:e.data.entry[0].nomor_faktur_penjualan_barang,value:e.data.entry[0].uuid})}}).catch(e=>h(e))},S=()=>{F.custom(`/daftar_pesanan/${s}`,"GET").then(e=>{v(e.data)}).catch(e=>h(e))},G=(e,c)=>{const g=r,K=r.findIndex(O=>O.rincian_pesanan_penjualan_barang==c);K>-1&&(g[K].pengiriman=e),v(O=>g)};return n.useEffect(()=>{s&&S()},[s]),n.useEffect(()=>{m(),u()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[t?"Edit":"Tambahkan"," Pengiriman Barang"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>C(),children:[a.jsx(U,{})," Batalkan Pengiriman Barang"]})]}),a.jsxs("form",{onSubmit:e=>o(e),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(I,{label:"Tanggal",type:"datetime-local",onchange:e=>{L(e.target.value)},addClassInput:s||t?"border-none !px-1":"",disabled:s||t,others:{value:w,name:"tanggal"}}),a.jsx(R,{label:"Faktur Penjualan Barang",optionsDataList:J,optionsLabel:"nomor_faktur_penjualan_barang",optionsValue:"uuid",selectValue:p,addClass:s||t?"border-none !px-1":"",disabled:s||t,onchange:e=>{i(e)},selectName:"fakturPenjualanBarang"}),a.jsx(I,{label:"Nomor Surat Jalan",type:"text",addClassInput:s?"border-none !px-1":"",onchange:e=>{T(e.target.value)},disabled:s,others:{value:b,name:"nomorSuratJalan"}}),a.jsx(R,{label:"Pegawai Penanggung Jawab",optionsDataList:N,optionsLabel:"name",optionsValue:"uuid",selectValue:_,addClass:s?"border-none !px-1":"",disabled:s,onchange:e=>{f(e)},selectName:"pegawaiPenanggungJawab"}),a.jsx(R,{label:"Pegawai Pelaksana",addClass:s?"border-none !px-1":"",optionsDataList:N,optionsLabel:"name",optionsValue:"uuid",selectValue:P,disabled:s,onchange:e=>{x(e)},selectName:"pegawaiPelaksana"})]}),s?a.jsx(a.Fragment,{}):a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(V,{})," Simpan"]})]}),s?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto rounded-md h-max max-h-[90vh] no-scrollbar mt-5 pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Jumlah Beli"}),a.jsx("th",{width:30,children:"Jumlah Pengiriman"})]})}),a.jsx("tbody",{children:r==null?void 0:r.map((e,c)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[c+1,"."]}),a.jsx("td",{children:e.kategori_harga_barang_kode_barang}),a.jsx("td",{children:e.daftar_barang_name}),a.jsx("td",{children:e.satuan_barang_name}),a.jsx("td",{children:e.jumlah}),a.jsx("td",{children:a.jsx(H,{name:"pengiriman_"+c,type:"text",other:{defaultValue:e.pengiriman},onchange:g=>{ra(g,e.jumlah),G(g.target.value,e.rincian_pesanan_penjualan_barang)}})})]},c)}))})]})}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",type:"button",onClick:()=>{l(0)},children:[a.jsx(V,{})," Simpan"]})]}):a.jsx(a.Fragment,{})]})})},ha=()=>{z();const[C,t]=n.useState([]),[j,w]=n.useState([]),[L,p]=n.useState(!1),[i,b]=n.useState(!1),[T,_]=n.useState({name:""}),[f,P]=n.useState(!1),[x,s]=n.useState(""),y=n.useRef(),J=la.useReactToPrint({content:()=>y.current}),[k,N]=n.useState({page:1,size:10,count:118,lastPage:12}),d=(l="")=>{l==""&&s(l),p(!0),F.custom(`?search=${l}&page=${k.page}&size=${k.size}`,"GET").then(o=>{var m,S;let u=ta(o.data.entry,"nomor_faktur_penjualan_barang");P(l.length<1),w(u),t((m=o==null?void 0:o.data)==null?void 0:m.entry),N((S=o==null?void 0:o.data)==null?void 0:S.pagination),p(!1)}).catch(o=>{h(o)})},r=l=>{_(l),b(!i)},v=async l=>{await na("Hapus","Yakin ingin hapus data ini ?")&&F.custom(`/${l.uuid}`,"DELETE").then(()=>{sa("Berhasil","Data berhasil dihapus"),d()}).catch(o=>{h(o)})};return n.useEffect(()=>{d()},[]),a.jsx(q,{isLoading:L,children:a.jsxs("div",{children:[a.jsx(M,{title:"Pengiriman Barang"}),i?a.jsx(oa,{setAddPengirimanBarangEvent:()=>b(!1),getData:d,pengirimanBarangEdit:T}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:x,onChange:l=>s(l.target.value)}),f?a.jsx(Z,{onClick:()=>{d(x)},className:"cursor-pointer"}):a.jsx(U,{onClick:()=>d(""),className:"cursor-pointer"})]}),a.jsxs("div",{className:"flex gap-x-2 items-center",children:[a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{_(null),b(!i)},children:[a.jsx(D,{})," Tambah Pengiriman Barang"]}),a.jsx("div",{className:"hidden"}),a.jsxs("button",{onClick:J,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[a.jsx(B,{})," Cetak Pengiriman Barang"]})]})]}),a.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md",children:j==null?void 0:j.map((l,o)=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-gray-200 p-3",children:[a.jsx("p",{className:"text-xs text-gray-500 font-bold",children:"Nomor Faktur Penjualan"}),a.jsx("p",{className:"font-bold",children:l.parent})]}),l.data.map((u,m)=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"px-6 py-4 flex justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 font-bold",children:"Nomor Surat Jalan"}),a.jsx("p",{className:"font-bold text-md",children:u==null?void 0:u.nomor_surat_jalan}),a.jsxs("p",{className:"text-xs text-gray-500 font-bold",children:["Tanggal : ",E(u==null?void 0:u.tanggal)]}),a.jsxs("div",{className:"flex gap-x-2",children:[a.jsxs("p",{className:"text-xs font-bold mt-3 bg-gray-400 px-2 py-1 rounded-md text-white",children:["Penanggung Jawab : ",u.pegawai_penanggung_jawab_name]}),a.jsxs("p",{className:"text-xs font-bold mt-3 bg-gray-400 px-2 py-1 rounded-md text-white",children:["Pelaksana : ",u.pegawai_pelaksana_name]})]})]}),m==0?a.jsx(a.Fragment,{children:a.jsx("div",{children:a.jsxs("div",{className:"flex items-center",children:[a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-yellow-400",onClick:()=>{r(u)},children:[a.jsx(aa,{size:10}),"Edit"]}),a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-red-600",onClick:()=>{v(u)},children:[a.jsx(ea,{size:10}),"Hapus"]})]})})}):a.jsx(a.Fragment,{})]})}))]}))})]})]})})};export{ha as default};
