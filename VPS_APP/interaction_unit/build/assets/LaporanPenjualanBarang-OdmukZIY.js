import{r as t,j as a,bh as w,b4 as S,f as H,c as R,aE as T,s as d,aC as p}from"./index-DHco5UoW.js";import{W as y}from"./Wrap-UDT2yOyM.js";import{P as D}from"./PageTitle-DhSJ_t28.js";import{F as x}from"./FormSelectWithLabel-C9nmHSNn.js";import{g as E}from"./jurnalUmum.helper-CYiiM-mT.js";import{p as o}from"./number.helper-_FlTjox4.js";import"./FormInput-DQocwEvt.js";const W=()=>{const[u,P]=t.useState(!1),[i,h]=t.useState(),[j,f]=t.useState([]),[g,b]=t.useState([]),[N,B]=t.useState([]),[l,v]=t.useState(),[m,c]=t.useState(),_=()=>{T.custom("/transaksi","GET").then(s=>{b(s.data)}).catch(s=>d(s))},L=()=>{c(s=>null),p.custom(`/gudang_barang/${l.value}`,"GET").then(s=>{B(s.data),s.data.length>0&&c(r=>({label:s.data[0].daftar_gudang_name,value:s.data[0].uuid}))}).catch(s=>d(s))},k=()=>{p.custom(`/riwayat_penjualan/${m.value}`,"GET").then(s=>{const r=E(s.data);f(n=>r)}).catch(s=>d(s))};return t.useEffect(()=>{if(l){L();const s=g.filter(r=>r.uuid==l.value)[0];h(r=>s)}},[l]),t.useEffect(()=>{_()},[]),a.jsx(y,{isLoading:u,children:a.jsxs("div",{children:[a.jsx(D,{title:"Laporan Penjualan Barang"}),a.jsxs("div",{className:"grid grid-cols-12",children:[a.jsx("div",{className:"col-span-3",children:a.jsxs("div",{className:"bg-white py-6 px-6 rounded-md",children:[a.jsxs("div",{className:"flex items-end gap-x-2",children:[a.jsx(x,{label:"Kode Barang",optionsDataList:g,optionsLabel:"kode_barang",optionsValue:"uuid",selectValue:l,onchange:s=>{v(s)},selectName:"kategoriHargaBarang"}),a.jsx(x,{label:"Gudang Asal",optionsDataList:N,optionsLabel:"daftar_gudang_name",optionsValue:"uuid",selectValue:m,onchange:s=>{c(s)},selectName:"gudangBarang"})]}),i?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"px-1 gap-x-2 rounded-md py-5",children:[a.jsx("p",{className:"text-xl font-extrabold",children:i.daftar_barang_name}),a.jsx("p",{className:"font-bold bg-blue-800 px-2 text-white rounded-md w-max mt-2",children:i.satuan_barang_name})]})}):a.jsx(a.Fragment,{}),a.jsxs("button",{className:"btn mt-3 btn-sm bg-blue-800 text-white",onClick:()=>k(),children:[a.jsx(w,{})," Lihat Laporan Penjualan Barang"]})]})}),a.jsx("div",{className:"col-span-9 px-2 h-[80vh] overflow-y-scroll no-scrollbar",children:a.jsxs("div",{className:"bg-white rounded-md p-3",children:[a.jsx("h1",{className:"font-bold text-2xl pb-6",children:"Laporan Riwayat Penjualan Barang"}),j.map((s,r)=>a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"font-bold sticky top-0 bg-gray-300 p-2 z-20",children:S("/",H(s.parent,!1))}),a.jsx("div",{className:"flex flex-col",children:s.data.map((n,F)=>{const e=JSON.parse(n.detail);return a.jsxs("div",{className:"my-6 pl-6",children:[a.jsxs("div",{className:"grid grid-cols-12 mb-3",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("p",{className:"text-sm pr-2 font-medium",children:R(n.tanggal.split("T")[1])})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm pr-2 font-medium px-3",children:n.type.replaceAll("_"," ").toUpperCase()})})]}),a.jsxs("div",{className:"grid grid-cols-12",children:[a.jsx("div",{className:"col-span-1"}),a.jsxs("div",{className:"col-span-3",children:[a.jsx("p",{className:"text-sm pr-2 px-3 pb-2 font-bold",children:n.bukti_transaksi}),a.jsxs("p",{className:"text-sm pr-2 px-3 pb-2 font-bold",children:["Oleh ",n.customer," ( ",n.customer_code," )"]}),e!=null&&e.jumlah?a.jsxs("p",{className:"text-sm pr-2 font-normal px-3",children:[" Jumlah ",o(e.jumlah)," ",e.satuan_barang]}):"",e!=null&&e.diskon_persentase?a.jsxs("p",{className:"text-sm pr-2 font-normal px-3",children:[" Diskon ",e.diskon_persentase," % "]}):"",e!=null&&e.total?a.jsxs("p",{className:"text-sm pr-2 font-normal px-3",children:[" Total Rp.",o(e.total)]}):"",e!=null&&e.nilai_pelunasan?a.jsxs("p",{className:"text-sm pr-2 font-normal px-3",children:[" Nilai Pelunasan Rp.",o(e.nilai_pelunasan)]}):"",e!=null&&e.retur?a.jsxs("p",{className:"text-sm pr-2 font-normal px-3",children:[" Jumlah Retur ",o(e.retur)," Dengan Nilai Rp.",o(e.nilai_retur)]}):""]})]})]})})})]}))]})})]})]})})};export{W as default};
