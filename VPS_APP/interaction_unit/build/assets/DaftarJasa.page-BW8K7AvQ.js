import{r as i,a8 as Q,j as a,Q as C,m as $,F as O,o as G,aX as V,t as x,ag as X,am as F,e as B,p as I,aC as Z,aY as T,aV as P,d as Y,aZ as A,v as z,aD as q,at as R,aE as E,aF as aa,R as ea,w as ta,W as sa,x as na,y as la,l as ia,z as ra,n as ca,b as oa,D as ua}from"./index-w4WRH1zx.js";import{P as ha}from"./Pagination-hXZ8aV_7.js";import{F as U}from"./FormInputWithLabel-KhAr-6m5.js";import{i as W}from"./actionEvent.helper-DeauyOY9.js";import{P as da,l as ja}from"./PDFHeader-jGZBZNfE.js";import"./react-paginate-DlRX8p9z.js";import"./index-BKNjMPK8.js";const xa=({idDaftarJasa:h,kategoriHargaJasaList:t})=>{const[d,u]=i.useState(),[g,S]=i.useState(t.length>0?{label:t[0].kode_jasa,value:t[0].uuid}:null),[b,f]=i.useState(0),[v,N]=i.useState(Q()),[w,y]=i.useState([]),[k,J]=i.useState([]),D=async l=>{l.preventDefault(),await G(l.target)&&V.custom("","POST",null,{data:{daftar_jasa:h,cabang:d.value,kategori_harga_jasa:g.value,jumlah:`${b}`,tanggal:`${v}`}}).then(()=>{j()}).catch(m=>{x(m)})},p=()=>{X.custom("","GET").then(l=>{y(l.data.entry),l.data.entry.length>0&&u({label:l.data.entry[0].name,value:l.data.entry[0].uuid})}).catch(l=>{x(l)})},j=()=>{V.custom(`/${h}`,"GET").then(l=>{J(l.data)}).catch(l=>{x(l)})},_=l=>{V.custom(`/${l.uuid}`,"DELETE").catch(m=>{x(m)}).finally(()=>j())};return i.useEffect(()=>{p(),j()},[]),a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"mt-16 mb-5 uppercase text-gray-600 font-bold",children:"Stok Awal Jasa"}),a.jsx("form",{onSubmit:l=>D(l),className:"pb-6",children:a.jsxs("div",{className:"flex gap-x-2 items-end",children:[a.jsx(C,{label:"Cabang Jasa",optionsDataList:w,optionsLabel:"name",optionsValue:"uuid",selectValue:d,onchange:l=>{u(l)},selectName:"cabangJasa"}),a.jsx(C,{label:"Kode Jasa",optionsDataList:t,optionsLabel:"kode_jasa",optionsValue:"uuid",selectValue:g,onchange:l=>{S(l)},selectName:"kategoriHargaJasa"}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx($,{})," Simpan"]})]})}),a.jsxs("table",{className:"table table-sm table-zebra",children:[a.jsxs("thead",{className:"py-4 text-black",children:[a.jsx("th",{children:"No"}),a.jsx("th",{children:"Daftar Cabang Name"}),a.jsx("th",{children:"Kode Jasa"}),a.jsx("th",{children:"Satuan"}),a.jsx("th",{children:"Aksi"})]}),a.jsx("tbody",{children:k.map((l,m)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:m+1}),a.jsx("td",{children:l.cabang_name}),a.jsx("td",{children:l.kategori_harga_jasa_kode_jasa}),a.jsx("td",{children:l.satuan_jasa_name}),a.jsx("td",{width:100,children:a.jsx("div",{className:"flex gap-x-2",children:a.jsx(O,{onClick:()=>_(l),className:"text-red-500 cursor-pointer",size:12})})})]})}))})]})]})},ga=({idDaftarJasa:h})=>{const[t,d]=i.useState(!1),[u,g]=i.useState([]),[S,b]=i.useState([]),[f,v]=i.useState(),[N,w]=i.useState(),[y,k]=i.useState([]),J=()=>{v(e=>null),b(e=>[]),d(e=>!1),Z.custom("","GET").then(e=>{b(e.data.entry),d(o=>!0),v({label:e.data.entry[0].name,value:e.data.entry[0].uuid})}).catch(e=>{x(e)})},D=async e=>{if(e.preventDefault(),await G(e.target)){let o={daftar_jasa:h,satuan_jasa:f.value,kode_jasa:N};F.map((r,n)=>{o[`harga_${r.value}`]=y[n]}),T.custom("","POST",null,{data:o}).then(()=>{p()}).catch(r=>{x(r)})}},p=()=>{T.custom(`/${h}`,"GET").then(e=>{g(o=>e.data.entry)}).catch(e=>{x(e)})},j=e=>{let o={daftar_jasa:e.daftar_jasa,satuan_jasa:e.satuan_jasa,kode_jasa:e.kode_jasa};F.filter(r=>r.value!="beli").map((r,n)=>{o[`harga_${r.value}`]=`${e[`harga_${r.value}`]}`}),T.custom(`/${e.uuid}`,"PUT",null,{data:o}).catch(r=>{x(r)}).finally(()=>p())},_=e=>{let o={daftar_jasa:e.daftar_jasa,satuan_jasa:e.satuan_jasa,kode_jasa:e.kode_jasa};F.map((r,n)=>{o[`harga_${r.value}`]=`${e[`harga_${n+1}`]}`}),T.custom(`/${e.uuid}`,"DELETE").catch(r=>{x(r)}).finally(()=>p())},l=(e,o,r)=>{const n=u.findIndex(c=>c.uuid==r);if(n!=-1){let c=u;c.at(n)[`harga_${o}`]=I(e),g(L=>c)}},m=(e,o)=>{const r=u.findIndex(n=>n.uuid==o);if(r!=-1){let n=u;n.at(r).kode_jasa=e,g(c=>n)}};return i.useEffect(()=>{J()},[u]),i.useEffect(()=>{p()},[]),a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"mt-16 mb-5 uppercase text-gray-600 font-bold",children:"Kategori Harga"}),t?a.jsxs("form",{onSubmit:e=>D(e),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(C,{label:"Satuan Jasa",optionsDataList:S,optionsLabel:"name",optionsValue:"uuid",selectValue:f,onchange:e=>{v(e)},selectName:"satuanJasa"}),a.jsx(U,{label:"Kode Jasa",type:"text",onchange:e=>{w(e.target.value)},others:{value:N,name:"kodeJasa"}})]}),a.jsx("div",{className:"mt-5 flex gap-x-2",children:F.filter(e=>e.value!="beli").map((e,o)=>a.jsx(a.Fragment,{children:a.jsx(U,{label:e.label,type:"text",onchange:r=>{W(r);const n=[...y];n[o]=r.target.value,k(c=>n)},others:{value:y[o],name:`hargaJasa[${o}]`}})}))}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx($,{})," Simpan"]})]}):a.jsx(a.Fragment,{}),a.jsxs("table",{className:"mt-5 table table-sm table-zebra",children:[a.jsxs("thead",{className:"py-4 text-black",children:[a.jsx("th",{children:"No"}),a.jsx("th",{children:"Satuan Jasa"}),a.jsx("th",{children:"Kode Jasa"}),F.filter(e=>e.value!="beli").map(e=>a.jsx("th",{children:e.label})),a.jsx("th",{children:"Aksi"})]}),a.jsx("tbody",{children:u.map((e,o)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:o+1}),a.jsx("td",{children:e.satuan_jasa_name}),a.jsx("td",{children:a.jsx(B,{name:"kode_jasa"+o,type:"text",other:{defaultValue:e.kode_jasa},onchange:r=>{m(r.target.value,e.uuid)}})}),F.filter(r=>r.value!="beli").map(r=>a.jsx("td",{width:150,children:a.jsx(B,{name:"harga_"+r.value,type:"text",other:{defaultValue:I(e[`harga_${r.value}`])},onchange:n=>{W(n),l(n.target.value,r.value,e.uuid)}})})),a.jsx("td",{width:100,children:a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx($,{onClick:()=>j(e),className:"text-green-800 cursor-pointer",size:12}),a.jsx(O,{onClick:()=>_(e),className:"text-red-500 cursor-pointer",size:12})]})})]})}))})]}),a.jsx(xa,{idDaftarJasa:h,kategoriHargaJasaList:u})]})},ma=({setAddDaftarJasaEvent:h=()=>{},daftarJasaEdit:t,getData:d=()=>{}})=>{const[u,g]=i.useState(!1),[S,b]=i.useState(t!=null&&t.uuid?t.uuid:null),[f,v]=i.useState([]),[N,w]=i.useState([]),[y,k]=i.useState([]),[J,D]=i.useState(t!=null&&t.name?t.name:""),[p,j]=i.useState(t!=null&&t.kategori_jasa?t.kategori_jasa:""),[_,l]=i.useState(t!=null&&t.jenis_jasa?t.jenis_jasa:""),[m,e]=i.useState(t!=null&&t.jenis_penjualan_jasa?t.jenis_penjualan_jasa:""),[o,r]=i.useState(t!=null&&t.ppn?{label:P.filter(s=>s.value==t.ppn).at(0).label,value:P.filter(s=>s.value==t.ppn).at(0).value}:{label:P[0].label,value:P[0].value}),n=async s=>{s.preventDefault(),await G(s.target)&&A.custom(`${t!=null&&t.uuid?`/${t.uuid}`:""}`,t?"PUT":"POST",null,{data:{name:J,kategori_jasa:p.value,jenis_jasa:_.value,jenis_penjualan_jasa:m.value,ppn:o.value,status:1}}).then(H=>{t?z("Berhasil","Data berhasil diupdate"):(b(M=>H.data.uuid),z("Berhasil","Data berhasil disimpan")),g(M=>!0)}).catch(H=>{x(H)})},c=()=>{q.custom("","GET").then(s=>{if(v(s.data.entry),s.data.entry.length>0){if(t){R({editObject:t.kategori_jasa,dataList:s.data.entry,setState:j,labelKey:"name",valueKey:"uuid"});return}j({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>{x(s)})},L=()=>{E.custom("","GET").then(s=>{if(w(s.data.entry),s.data.entry.length>0){if(t){R({editObject:t.jenis_jasa,dataList:s.data.entry,setState:l,labelKey:"name",valueKey:"uuid"});return}l({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>{x(s)})},K=()=>{aa.custom("","GET").then(s=>{if(k(s.data.entry),s.data.entry.length>0){if(t){R({editObject:t.jenis_penjualan_jasa,dataList:s.data.entry,setState:e,labelKey:"name",valueKey:"uuid"});return}e({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>{x(s)})};return i.useEffect(()=>{c(),L(),K()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[t?"Edit":"Tambahkan"," Daftar Jasa"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>h(),children:[a.jsx(Y,{})," Batalkan Daftar Jasa"]})]}),a.jsxs("form",{onSubmit:s=>n(s),children:[a.jsx("div",{className:"flex gap-x-2",children:a.jsx(U,{label:"Nama Daftar Jasa",type:"text",onchange:s=>{D(s.target.value)},others:{value:J,name:"namaDaftarJasa",disabled:u}})}),a.jsxs("div",{className:"mt-5 flex gap-x-2",children:[a.jsx(C,{label:"Kategori Jasa",optionsDataList:f,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:p,onchange:s=>{j(s)},selectName:"kategoriDaftarJasa"}),a.jsx(C,{label:"Jenis Jasa",optionsDataList:N,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:_,onchange:s=>{l(s)},selectName:"JenisDaftarJasa"}),a.jsx(C,{label:"Jenis Penjualan Jasa",optionsDataList:y,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:m,onchange:s=>{e(s)},selectName:"jenisPenjualanDaftarJasa"})]}),a.jsx("div",{className:"mt-5 flex -gap-x-2",children:a.jsx(C,{label:"PPN",optionsDataList:P,optionsLabel:"label",optionsValue:"value",disabled:u,selectValue:o,onchange:s=>{r(s)},selectName:"ppnDaftarJasa"})}),u?a.jsx(a.Fragment,{}):a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx($,{})," Simpan"]})]}),u?a.jsx(ga,{idDaftarJasa:S}):a.jsx(a.Fragment,{})]})})},pa=ea.forwardRef((h,t)=>{var d;return a.jsxs("div",{ref:t,children:[a.jsx(da,{bulan:h.bulan,tahun:h.tahun,title:"Daftar Jasa"}),a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Daftar Jasa"}),a.jsx("th",{children:"Kode Daftar Jasa"})]})}),a.jsx("tbody",{children:(d=h==null?void 0:h.data)==null?void 0:d.map((u,g)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:g+1}),a.jsx("td",{children:u.name}),a.jsx("td",{children:u.code})]},g)}))})]})]})}),Na=()=>{const h=ta(),{data:t}=h,[d,u]=i.useState([]),[g,S]=i.useState(!1),[b,f]=i.useState(!1),[v,N]=i.useState({name:""}),[w,y]=i.useState(!1),[k,J]=i.useState(""),D=i.useRef(),p=ja.useReactToPrint({content:()=>D.current}),[j,_]=i.useState({page:1,size:10,count:118,lastPage:12}),l=(n="")=>{n==""&&J(n),S(!0),A.custom(`?search=${n}&page=${j.page}&size=${j.size}`,"GET").then(c=>{var L,K;y(n.length<1),u((L=c==null?void 0:c.data)==null?void 0:L.entry),_((K=c==null?void 0:c.data)==null?void 0:K.pagination),S(!1)}).catch(c=>{x(c)})},m=n=>{let c=d[n];N(c),f(!b)},e=async n=>{if(await ua("Hapus","Yakin ingin hapus data ini ?")){let c=d[n];A.custom(`/${c.uuid}`,"DELETE").then(()=>{z("Berhasil","Data berhasil dihapus"),l()}).catch(L=>{x(L)})}},o=({selected:n})=>{let c=j;c.page=n+1,_(c),l()},r=n=>{let c=j;c.size=n,c.page=1,_(c),l()};return i.useEffect(()=>{l()},[]),a.jsx(sa,{isLoading:g,children:a.jsxs("div",{children:[a.jsx(na,{title:"Daftar Jasa"}),b?a.jsx(ma,{setAddDaftarJasaEvent:()=>f(!1),getData:l,daftarJasaEdit:v}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:k,onChange:n=>J(n.target.value)}),w?a.jsx(la,{onClick:()=>{l(k)},className:"cursor-pointer"}):a.jsx(Y,{onClick:()=>l(""),className:"cursor-pointer"})]}),a.jsxs("div",{className:"flex gap-x-2 items-center",children:[a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{N(null),f(!b)},children:[a.jsx(ia,{})," Tambah Daftar Jasa"]}),a.jsx("div",{className:"hidden",children:a.jsx(pa,{data:d,ref:D,bulan:ra(new Date().getMonth()),tahun:t.tahun})}),a.jsxs("button",{onClick:p,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[a.jsx(ca,{})," Cetak Daftar Jasa"]})]})]}),a.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Daftar Jasa"}),a.jsx("th",{children:"Kategori Jasa"}),a.jsx("th",{children:"Jenis Jasa"}),a.jsx("th",{children:"Jenis Penjualan Jasa"}),a.jsx("th",{children:"PPN"}),a.jsx("th",{children:"Aksi"})]})}),a.jsx("tbody",{children:d==null?void 0:d.map((n,c)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[c+1,"."]}),a.jsx("td",{children:n.name}),a.jsx("td",{children:n.kategori_jasa_name}),a.jsx("td",{children:n.jenis_jasa_name}),a.jsx("td",{children:n.jenis_penjualan_jasa_name}),a.jsx("td",{children:n.ppn==1?"Ya":"Tidak"}),a.jsxs("td",{className:"flex gap-x-2",children:[a.jsx(oa,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{m(c)}}),a.jsx(O,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{e(c)}})]})]},c)}))})]})}),a.jsx(ha,{paginateUpdatePage:o,paginate:j,setSize:r})]})]})})};export{Na as default};
