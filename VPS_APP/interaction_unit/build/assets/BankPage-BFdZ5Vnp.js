import{j as a,p as N,r as l,i as R,a as E,e as M,h as aa,F as ea,k as sa,l as W,m as z,o as P,b0 as H,t as v,U as q,a_ as L,a7 as ta,d as O,Q as U,b1 as I,w as la,W as na,x as ia,y as ra,D as V,v as G,C as ca}from"./index-Da9CN-uw.js";import{B as oa}from"./BulanSelectedListCard-BS3ac-pi.js";import{D as da}from"./DebetKreditStatusCard-C9_CTXOW.js";import{B as ua}from"./BankRowData-DDsFxyY8.js";import{F as K}from"./FormInputWithLabel-CRkZCM1K.js";import{i as Y}from"./actionEvent.helper-cSgMuxg7.js";import{C as xa}from"./CheckListBox-DdPS0jXA.js";const ha=({item:r,deleteItem:c=()=>{},editItem:g=()=>{},deleteByBuktiTransaksi:p=()=>{},balanceStatus:o=!0,forPrint:u=!1})=>a.jsxs("div",{className:`flex flex-col w-full bg-white text-[13px] px-3 ${u?"":"shadow-md"}`,children:[a.jsx("div",{className:"grid grid-cols-12 sticky top-0 bg-white py-2 border-b-2",children:a.jsxs("div",{className:"p-2 col-span-9 text-black flex items-end",children:[a.jsx("div",{className:"text-[28px] font-bold",children:o?a.jsx("p",{className:`text-[45px] -ml-1 text-white px-2 rounded-md ${r.total.debet==r.total.kredit?"bg-green-900":"bg-red-900"}`,children:parseFloat(r.tanggal)<10?`0${r.tanggal}`:r.tanggal}):a.jsx("p",{className:"text-[45px] -ml-1 text-white px-2 rounded-md bg-green-900",children:parseFloat(r.tanggal)<10?`0${r.tanggal}`:r.tanggal})}),a.jsx("div",{className:"flex flex-col",children:a.jsxs("div",{className:"flex items-end",children:[a.jsxs("div",{className:"text-gray-900 flex flex-col justify-end px-2",children:[a.jsxs("h1",{children:[r.bulan,".",r.tahun]}),a.jsx("h2",{className:"text-[13px] font-bold",children:r.hari})]}),a.jsxs("div",{className:"flex flex-col px-2 border-l-2 border-gray-600",children:[a.jsx("h1",{className:"font-bold",children:"Total"}),a.jsxs("div",{className:"flex gap-x-4",children:[a.jsx("div",{className:"text-right",children:a.jsx("h1",{className:" text-green-900 font-bold flex flex-row",children:N(r.total.debet)})}),a.jsx("div",{className:"text-right",children:a.jsx("h1",{className:" text-red-900 font-bold",children:N(r.total.kredit)})})]})]})]})})]})}),r.buktiTransaksi.map(x=>a.jsx(a.Fragment,{children:a.jsx(ua,{item1:x,balanceStatus:o,deleteByBuktiTransaksi:p,deleteItem:c,editItem:g,forPrint:u})}))]}),ma=({idTransaksiBank:r,nilaiTransaksi:c=0,type:g=1})=>{const[p,o]=l.useState(!1),[u,x]=l.useState({totalDebet:g==1?c:0,totalKredit:g==0?c:0}),[k,$]=l.useState([]),[j,T]=l.useState([]),[n,b]=l.useState([{waktu:`${new Date().getHours()<10?"0"+new Date().getHours():new Date().getHours()}:${new Date().getMinutes()<10?"0"+new Date().getMinutes():new Date().getMinutes()}:${new Date().getSeconds()<10?"0"+new Date().getSeconds():new Date().getSeconds()}`,kodeAkun:R(),uraian:"",nilai:"0"}]),y=t=>{let e=[...n],s=[...j];e[t].uuid&&s.push(e[t]),T(i=>s),b(i=>[]),e.splice(t,1),b(e)},A=async()=>{await P()&&(f(0),D(0))},D=async t=>{j[t]&&(o(e=>!0),H.custom(`/${j[t].uuid}`,"DELETE").then(()=>{o(e=>!1),D(t+=1)}).catch(e=>{o(s=>!1),v(e)}))},f=async t=>{n[t]&&(o(e=>!0),H.custom(n[t].uuid?`/${n[t].uuid}`:"",n[t].uuid?"PUT":"POST",null,{data:{kode_akun_perkiraan:n[t].kodeAkun.value,waktu:n[t].waktu,transaksi_bank:r,uraian:n[t].uraian,nilai:n[t].nilai}}).then(e=>{n[t].uuid||(n[t].uuid=e.data.uuid),o(s=>!1),f(t+=1)}).catch(e=>{v(e),o(s=>!1)}))},C=()=>{let t=[...n];t.push({waktu:`${new Date().getHours()<10?"0"+new Date().getHours():new Date().getHours()}:${new Date().getMinutes()<10?"0"+new Date().getMinutes():new Date().getMinutes()}:${new Date().getSeconds()<10?"0"+new Date().getSeconds():new Date().getSeconds()}`,kodeAkun:R(),uraian:"",nilai:"0"}),b(e=>t)},S=()=>{let t=0;n.map(e=>{t+=E(e.nilai)}),x(e=>({totalDebet:g==0?t:c,totalKredit:g==1?t:c}))},w=(t,e,s)=>{let i=[...n];b(B=>[]),i[e][s]=t,b(B=>i)};l.useEffect(()=>{S()},[n]);const F=t=>{q.custom("/no_bank","GET").then(e=>{$(s=>e.data)})},_=()=>{H.custom(`/${r}`,"GET").then(t=>{b(e=>t.data.map(s=>{const i=k.filter(B=>B.uuid==s.kode_akun_perkiraan).at(0);return i?{uuid:s.uuid,nilai:N(s.nilai),waktu:s.waktu,uraian:s.uraian,kodeAkun:{label:`${i.code} - ${i.name}`,value:s.kode_akun_perkiraan}}:{uuid:s.uuid,nilai:N(s.nilai),waktu:s.waktu,uraian:s.uraian,kodeAkun:R()}}))}).catch(t=>{v(t)})};return l.useEffect(()=>{_()},[k]),l.useEffect(()=>{F()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"flex flex-col px-6 mt-6 w-full",children:[a.jsxs("div",{className:"grid grid-cols-7 w-max gap-x-2 items-center",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("label",{className:"form-control w-full bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text font-bold",children:"Debet"})})})}),a.jsx("div",{className:"col-span-3",children:a.jsx("label",{className:"form-control w-full bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text font-bold",children:"Kredit"})})})}),a.jsx("div",{className:"col-span-3",children:a.jsx("label",{className:"form-control w-full bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text font-bold",children:"Status"})})})}),a.jsx("div",{className:"col-span-1",children:a.jsx("label",{className:"form-control w-full bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text",children:N(u.totalDebet)})})})}),a.jsx("div",{className:"col-span-3",children:a.jsx("label",{className:"form-control w-full bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text",children:N(u.totalKredit)})})})}),a.jsx("div",{className:"col-span-3",children:a.jsx("label",{className:"form-control w-full bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:`label-text font-bold text-white px-3 py-2 rounded-md ${E(u.totalDebet)==E(u.totalKredit)?"bg-green-600":"bg-red-600"}`,children:E(u.totalDebet)==E(u.totalKredit)?"Seimbang":"Tidak Seimbang"})})})})]}),a.jsx("label",{className:"form-control w-full max-w-xs bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"flex items-center gap-x-2 label-text text-gray-800 font-bold mt-4",children:a.jsx("p",{children:"Rincian Transaksi Bank"})})})}),a.jsxs("div",{className:"grid w-full grid-cols-12 gap-x-2 border-b-2",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("label",{className:"form-control w-full max-w-xs bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text text-gray-600",children:"Waktu"})})})}),a.jsx("div",{className:"col-span-3",children:a.jsx("label",{className:"form-control w-full max-w-xs bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text text-gray-600",children:"Kode Akun"})})})}),a.jsx("div",{className:"col-span-6",children:a.jsx("label",{className:"form-control w-full max-w-xs bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text text-gray-600",children:"Uraian"})})})}),a.jsx("div",{className:"col-span-2",children:a.jsx("label",{className:"form-control w-full max-w-xs bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text text-gray-600",children:"Nilai"})})})})]}),a.jsx("div",{className:"grid w-full items-end grid-cols-12 gap-x-2",children:n.map((t,e)=>a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-5 col-span-1",children:a.jsx(M,{name:`waktu_${e}`,type:"time",value:t.waktu,addClass:"required",onchange:s=>w(s.target.value,e,"waktu"),other:{autoComplete:!1,step:1}})}),a.jsx("div",{className:"mb-5 col-span-3",children:a.jsx(aa,{optionsDataList:k,optionsLabel:["code","name"],optionsValue:"uuid",optionsLabelIsArray:!0,optionsDelimiter:"-",selectValue:t.kodeAkun,onchange:s=>{w(s,e,"kodeAkun")},addClass:"required",selectName:`kodeAkun_${e}`})}),a.jsx("div",{className:"mb-5 col-span-6",children:a.jsx(M,{name:`uraian_${e}`,type:"text",value:t.uraian,addClass:"required",onchange:s=>w(s.target.value,e,"uraian"),other:{autoComplete:!1}})}),a.jsx("div",{className:"mb-5 col-span-2",children:a.jsxs("div",{className:"w-full indicator",children:[a.jsx("span",{className:"indicator-item indicator-bottom badge bg-red-800 text-white px-2 py-4 cursor-pointer",onClick:()=>y(e),children:a.jsx(ea,{})}),a.jsx(M,{name:`nilai_${e}`,type:"text",value:N(t.nilai),onchange:s=>{Y(s),w(s.target.value,e,"nilai")},other:{autoComplete:!1}})]})})]}))}),a.jsxs("div",{className:"flex sticky bottom-0 bg-white py-3 w-full items-end gap-x-2",children:[sa("demo_permission")&&n.length<2?a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-blue-800 mt-4 text-white",onClick:()=>C(),children:[a.jsx(W,{})," Tambah Transaksi"]})}):a.jsx(a.Fragment,{children:a.jsx("p",{className:"text-red-500 font-bold text-xs",children:"* Hanya Mengijinkan 2 Inputan Dalam Mode Demo"})}),a.jsxs("button",{disabled:p,className:"btn btn-sm bg-green-800 mt-4 text-white",onClick:()=>A(),children:[a.jsx(z,{})," ",p?"Sedang Menyimpan":"Simpan"]})]})]})})},ba=({setAddTransaksiEvent:r,transaksiSelected:c})=>{const[g,p]=l.useState(!1),[o,u]=l.useState({label:L[0].label,value:L[0].value}),[x,k]=l.useState(null),[$,j]=l.useState(null),[T,n]=l.useState(ta()),[b,y]=l.useState(""),[A,D]=l.useState(""),[f,C]=l.useState("0"),[S,w]=l.useState([]),F=e=>{q.custom("/bank","GET").then(s=>{if(w(s.data),s.data.length>0)if(e){const i=s.data.filter(B=>B.uuid==e);i.length>0&&j({label:`${i[0].code} - ${i[0].name}`,value:i[0].uuid})}else j({label:`${s.data[0].code} - ${s.data[0].name}`,value:s.data[0].uuid})})},_=async e=>{e.preventDefault(),await P(e.target)&&(p(s=>!0),I.custom(`${c?"/"+c:""}`,c?"PUT":"POST",null,{data:{tanggal:T,bukti_transaksi:b,kode_akun_perkiraan:$.value,uraian:A,nilai:f,type:o.value}}).then(s=>{k(c||s.data.uuid),p(i=>!1)}).catch(s=>{v(s),p(i=>!1)}))},t=()=>{I.custom(`/${c}`).then(e=>{n(s=>e.data.tanggal),y(s=>e.data.bukti_transaksi),D(s=>e.data.uraian),C(s=>N(e.data.nilai)),u({label:L.filter(s=>s.value==e.data.type).at(0).label,value:e.data.type}),F(e.data.kode_akun_perkiraan)}).catch(e=>{v(e)})};return l.useEffect(()=>{c&&t()},[c]),l.useEffect(()=>{F()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white rounded-md shadow-2xl h-[70vh] overflow-scroll no-scrollbar relative",children:[a.jsxs("div",{className:"sticky top-0 pt-3 px-6 h-max bg-white w-full z-10",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[c!=null?"Edit ":"Tambah "," Transaksi"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>r(),children:[a.jsx(O,{})," Batalkan Transaksi"]})]}),a.jsxs("form",{onSubmit:e=>_(e),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(K,{label:"Hari/Tanggal",type:"datetime-local",onchange:e=>{n(e.target.value)},disabled:x,others:{value:T,name:"hariTanggal"}}),a.jsx(K,{label:"Bukti Transaksi",type:"text",disabled:x,onchange:e=>{y(e.target.value)},others:{value:b,name:"buktiTransaksi"}})]}),a.jsxs("div",{className:"mt-5 flex gap-x-2",children:[a.jsx(U,{label:"Tipe Transaksi",optionsDataList:L,optionsLabel:"label",disabled:x,optionsValue:"value",selectValue:o,onchange:e=>{u(e)},selectName:"tipeTransaksi"}),a.jsx(U,{label:"Kode Akun",optionsDataList:S,optionsLabel:["code","name"],optionsValue:"uuid",optionsLabelIsArray:!0,optionsDelimiter:"-",disabled:x,selectValue:$,onchange:e=>{j(e)},selectName:"kodeAkun"}),a.jsx(K,{label:"Uraian",type:"text",disabled:x,onchange:e=>{D(e.target.value)},others:{value:A,name:"uraian"}}),a.jsx(K,{label:"Nilai",type:"text",onchange:e=>{Y(e),C(e.target.value)},disabled:x,others:{value:f,name:"nilai"}})]}),x?a.jsx(a.Fragment,{}):a.jsxs("button",{disabled:g,className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(z,{})," ",g?"Sedang Menyimpan":"Simpan"]})]})]}),x?a.jsx(a.Fragment,{children:a.jsx(ma,{kodeAkunList:S,idTransaksiBank:x,nilaiTransaksi:f,type:o.value})}):a.jsx(a.Fragment,{})]})})},va=()=>{const r=la(),{data:c,setData:g}=r,[p,o]=l.useState(!1),[u,x]=l.useState(!0),[k,$]=l.useState(L.map(d=>d.value)),[j,T]=l.useState(""),[n,b]=l.useState(new Date().getMonth()),[y,A]=l.useState([]),[D,f]=l.useState([]),[C,S]=l.useState(),[w,F]=l.useState(0),[_,t]=l.useState(0),[e,s]=l.useState(!1),i=(d="")=>{o(!0),d==""&&T(d),I.custom(`/${n+1}/${c.tahun}?search=${d}`,"GET").then(async h=>{A(m=>h.data),o(!1)}).catch(h=>{v(h)})},B=async d=>{await V("Hapus","Yakin ingin hapus data ini ?")&&H.custom(`/${d}`,"DELETE").then(h=>{G("Berhasil","Transaksi berhasil dihapus"),i()}).catch(h=>{v(h),i()})},J=async d=>{await V("Hapus","Yakin ingin hapus data di bukti transaksi ini ?")&&(o(!0),I.custom(`/${d.data[0][0].uuid}`,"DELETE").then(()=>{G("Berhasil","Transaksi berhasil dihapus"),i()}).catch(h=>{v(h),i()}))},Q=async d=>{o(!0),S(d.data[0][0].uuid),s(!0),o(!1)},X=async()=>{const d=y.filter(m=>k.filter(Z=>Z==m.type).length>0);let h=await ca(d.map(m=>(m.bulan=n+1,m.tahun=c.tahun,m.waktu=m.waktu?m.waktu:m.tanggal.split("T")[1].replace(".000",""),m.tanggal=m.tanggal.length>2?new Date(m.tanggal).getDate():m.tanggal,m)));f(h.returnData),F(h.totalDebet),t(h.totalKredit)};return l.useEffect(()=>{X()},[k,y]),l.useEffect(()=>{i()},[n]),l.useEffect(()=>{e||i()},[e]),l.useEffect(()=>{}),a.jsx(na,{isLoading:p,children:a.jsx("div",{children:e?a.jsx(ba,{setAddTransaksiEvent:()=>s(!e),transaksiSelected:C}):a.jsxs(a.Fragment,{children:[a.jsx(ia,{title:"Transaksi Bank"}),a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:j,onChange:d=>T(d.target.value)}),u?a.jsx(ra,{className:"cursor-pointer",onClick:()=>i(j)}):a.jsx(O,{className:"cursor-pointer",onClick:()=>{i("")}})]}),a.jsx("div",{children:a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{S(null),s(!0)},children:[a.jsx(W,{})," Tambah Transaksi"]})})]}),a.jsxs("div",{className:"grid grid-cols-6",children:[a.jsxs("div",{className:"col-span-1",children:[a.jsx(oa,{bulan:n,setBulan:b}),u?a.jsx(da,{debet:w,kredit:_}):a.jsx(a.Fragment,{})]}),a.jsx("div",{className:"col-span-5",children:a.jsxs("div",{className:"h-[65vh] pl-2",children:[a.jsx(xa,{checkListBox:k,setCheckListBox:$,checkListBoxList:L,label:"Tipe Transaksi"}),a.jsx("div",{className:"flex flex-col h-full overflow-y-scroll no-scrollbar w-full rounded-md",children:D.map((d,h)=>a.jsx(ha,{deleteByBuktiTransaksi:J,deleteItem:B,editItem:Q,item:d,balanceStatus:u},h))})]})})]})]})})})};export{va as default};
