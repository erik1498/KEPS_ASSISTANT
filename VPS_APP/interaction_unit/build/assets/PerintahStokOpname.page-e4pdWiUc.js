import{u as U,r as l,O as G,j as a,b as J,aQ as z,h as D,k as M,br as V,n as k,s as m,a8 as Q,a5 as S,K as Y,R as X,o as Z,e as O,p as $,i as E,f as aa,a as ea,F as sa,q as ta}from"./index-DHco5UoW.js";import{e as v,W as na}from"./Wrap-UDT2yOyM.js";import{P as la}from"./Pagination-BRJ4tswB.js";import{F as p}from"./FormInputWithLabel-Be1eo8uL.js";import{F as N}from"./FormSelectWithLabel-C9nmHSNn.js";import{P as ia,l as ca}from"./PDFHeader-CVMgwoPg.js";import{P as ra}from"./PageTitle-DhSJ_t28.js";import"./FormInput-DQocwEvt.js";import"./index-BKNjMPK8.js";const ga=({setAddPerintahStokOpnameEvent:r=()=>{},perintahStokOpnameEdit:e,getData:i=()=>{}})=>{const w=U(),{data:o}=w,[P,f]=l.useState(e!=null&&e.tanggal?e.tanggal:G()),[d,L]=l.useState(e!=null&&e.bulan_transaksi?e.bulan_transaksi:G()),[y,K]=l.useState(e!=null&&e.nomor_surat_perintah?e.nomor_surat_perintah:""),[F,b]=l.useState(e!=null&&e.pegawai_penanggung_jawab?e.pegawai_penanggung_jawab:""),[_,x]=l.useState(e!=null&&e.pegawai_pelaksana?e.pegawai_pelaksana:""),[T,g]=l.useState(e!=null&&e.kategori_barang?e.kategori_barang:""),[h,c]=l.useState(e!=null&&e.gudang_asal?e.gudang_asal:"");l.useState(e!=null&&e.validasi?e.validasi:"");const[u,A]=l.useState(),[C,R]=l.useState([]),[n,t]=l.useState([]),[j,B]=l.useState([]),W=async()=>{await M()&&V.custom(`${e!=null&&e.uuid?`/${e.uuid}`:""}`,e?"PUT":"POST",null,{data:{tanggal:P,bulan_transaksi:d.value,tahun:o.tahun,nomor_surat_perintah:y,pegawai_penanggung_jawab:F.value,pegawai_pelaksana:_.value,kategori_barang:T.value,gudang_asal:h.value,validasi:!1}}).then(()=>{e?k("Berhasil","Data berhasil diupdate"):k("Berhasil","Data berhasil disimpan"),r(),i()}).catch(s=>{m(s)})},H=()=>{Q.custom("","GET").then(s=>{if(t(s.data.entry),s.data.entry.length>0){if(e){v({editObject:e.kategori_barang,dataList:s.data.entry,setState:g,labelKey:"name",valueKey:"uuid"});return}g({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>m(s))},I=()=>{S.custom("","GET").then(s=>{if(B(s.data.entry),s.data.entry.length>0){if(e){v({editObject:e.gudang_asal,dataList:s.data.entry,setState:c,labelKey:"name",valueKey:"uuid"}),v({editObject:e.bulan_transaksi,dataList:z(),setState:L,labelKey:"label",valueKey:"value"});return}c({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>m(s))},q=()=>{Y.custom("","GET").then(s=>{if(R(s.data.entry),s.data.entry.length>0){if(e){v({editObject:e.pegawai_penanggung_jawab,dataList:s.data.entry,setState:b,labelKey:"name",valueKey:"uuid"}),v({editObject:e.pegawai_pelaksana,dataList:s.data.entry,setState:x,labelKey:"name",valueKey:"uuid"});return}b({label:s.data.entry[0].name,value:s.data.entry[0].uuid}),x({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>m(s))};return l.useEffect(()=>{q(),H(),I()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[e?"Edit":"Tambahkan"," Perintah Stok Opname"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>r(),children:[a.jsx(J,{})," Batalkan Perintah Stok Opname"]})]}),a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(p,{label:"Tanggal",type:"datetime-local",onchange:s=>{f(s.target.value)},others:{value:P,name:"tanggal"}}),a.jsx(p,{label:"Nomor Perintah Stok Opname",type:"text",onchange:s=>{K(s.target.value)},others:{value:y,name:"nomorPerintahStokOpname"}}),a.jsx(N,{label:"Bulan Transaksi",optionsDataList:z(),optionsLabel:"label",optionsValue:"value",disabled:u,selectValue:d,onchange:s=>{L(s)},selectName:"bulanTransaksi"}),a.jsx(N,{label:"Pegawai Penanggung Jawab",optionsDataList:C,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:F,onchange:s=>{b(s)},selectName:"pegawaiPenanggungJawab"})]}),a.jsxs("div",{className:"mt-5 flex gap-x-2",children:[a.jsx(N,{label:"Pegawai Pelaksana",optionsDataList:C,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:_,onchange:s=>{x(s)},selectName:"pegawaiPelaksana"}),a.jsx(N,{label:"Kategori Barang",optionsDataList:n,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:T,onchange:s=>{g(s)},selectName:"kategoriBarang"}),a.jsx(N,{label:"Gudang Asal",optionsDataList:j,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:h,onchange:s=>{c(s)},selectName:"gudangAsal"})]}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",onClick:()=>{W()},children:[a.jsx(D,{})," Simpan"]})]})})},ua=X.forwardRef((r,e)=>{var i;return a.jsxs("div",{ref:e,children:[a.jsx(ia,{bulan:r.bulan,tahun:r.tahun,title:"Perintah Stok Opname"}),a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Perintah Stok Opname"})]})}),a.jsx("tbody",{children:(i=r==null?void 0:r.data)==null?void 0:i.map((w,o)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:o+1}),a.jsx("td",{children:w.name})]},o)}))})]})]})}),fa=()=>{const r=U(),{data:e}=r,[i,w]=l.useState([]),[o,P]=l.useState(!1),[f,d]=l.useState(!1),[L,y]=l.useState({name:""}),[K,F]=l.useState(!1),[b,_]=l.useState(""),x=l.useRef(),T=ca.useReactToPrint({content:()=>x.current}),[g,h]=l.useState({page:1,size:10,count:118,lastPage:12}),c=(n="")=>{n==""&&_(n),P(!0),V.custom(`?search=${n}&page=${g.page}&size=${g.size}&tahun=${e.tahun}`,"GET").then(t=>{var j,B;F(n.length<1),w((j=t==null?void 0:t.data)==null?void 0:j.entry),h((B=t==null?void 0:t.data)==null?void 0:B.pagination),P(!1)}).catch(t=>{m(t)})},u=n=>{let t=i[n];y(t),d(!f)},A=async n=>{if(await ta("Hapus","Yakin ingin hapus data ini ?")){let t=i[n];V.custom(`/${t.uuid}`,"DELETE").then(()=>{k("Berhasil","Data berhasil dihapus"),c()}).catch(j=>{m(j)})}},C=({selected:n})=>{let t=g;t.page=n+1,h(t),c()},R=n=>{let t=g;t.size=n,t.page=1,h(t),c()};return l.useEffect(()=>{c()},[]),a.jsx(na,{isLoading:o,children:a.jsxs("div",{children:[a.jsx(ra,{title:"Perintah Stok Opname"}),f?a.jsx(ga,{setAddPerintahStokOpnameEvent:()=>d(!1),getData:c,perintahStokOpnameEdit:L}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:b,onChange:n=>_(n.target.value)}),K?a.jsx(Z,{onClick:()=>{c(b)},className:"cursor-pointer"}):a.jsx(J,{onClick:()=>c(""),className:"cursor-pointer"})]}),a.jsxs("div",{className:"flex gap-x-2 items-center",children:[a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{y(null),d(!f)},children:[a.jsx(O,{})," Tambah Perintah Stok Opname"]}),a.jsx("div",{className:"hidden",children:a.jsx(ua,{data:i,ref:x,bulan:$(new Date().getMonth()),tahun:e.tahun})}),a.jsxs("button",{onClick:T,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[a.jsx(E,{})," Cetak Perintah Stok Opname"]})]})]}),a.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Tanggal"}),a.jsx("th",{children:"Bulan Transaksi"}),a.jsx("th",{children:"Nomor Perintah Stok Opname"}),a.jsx("th",{children:"Pegawai Penanggung Jawab"}),a.jsx("th",{children:"Pegawai Pelaksana"}),a.jsx("th",{children:"Kategori Barang"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Aksi"})]})}),a.jsx("tbody",{children:i==null?void 0:i.map((n,t)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[t+1,"."]}),a.jsx("td",{children:aa(n.tanggal,!0)}),a.jsx("td",{children:$(n.bulan_transaksi-1)}),a.jsx("td",{children:n.nomor_surat_perintah}),a.jsx("td",{children:n.pegawai_penanggung_jawab_name}),a.jsx("td",{children:n.pegawai_pelaksana_name}),a.jsx("td",{children:n.kategori_barang_name}),a.jsx("td",{children:n.daftar_gudang_name}),a.jsxs("td",{className:"flex gap-x-2",children:[a.jsx(ea,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{u(t)}}),a.jsx(sa,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{A(t)}})]})]},t)}))})]})}),a.jsx(la,{paginateUpdatePage:C,paginate:g,setSize:R})]})]})})};export{fa as default};
