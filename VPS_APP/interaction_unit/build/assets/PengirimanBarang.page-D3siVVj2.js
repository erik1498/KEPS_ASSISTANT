import{R as X,r as n,j as a,f as z,p as U,a7 as Y,d as I,Q as J,m as G,e as q,n as M,b$ as Z,t as k,o as B,c0 as R,a3 as E,as as K,bJ as aa,w as ea,W as sa,x as la,y as ta,l as na,$ as ca,ae as V,b as da,F as ra,bX as ua,D as ha,v as oa}from"./index-CO8-hfmv.js";import{P as ia,l as H}from"./PDFHeader-DRSjrNMu.js";import{F as p}from"./FormInputWithLabel-l7OAzjDT.js";import{i as ja}from"./actionEvent.helper-DI7EF-i2.js";import"./react-paginate-CmyO5oXO.js";import"./index-BKNjMPK8.js";const xa=X.forwardRef((l,e)=>{var S,m,i,x,F,b,f,v,N,c,g,L;const[_,y]=n.useState([]);return n.useEffect(()=>{var o;let t=_;(o=l==null?void 0:l.pengirimanBarangList)==null||o.map(w=>{t.includes(w.daftar_gudang_name)||t.push(w.daftar_gudang_name)}),y(w=>t)},[l==null?void 0:l.pengirimanBarangList]),a.jsxs("div",{ref:e,children:[a.jsx(ia,{bulan:l==null?void 0:l.bulan,tahun:l==null?void 0:l.tahun,title:"Surat Jalan",useTime:!1}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",children:"KEPADA :"}),a.jsx("p",{children:(S=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:S.customer_name}),a.jsx("p",{children:(m=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:m.customer_code}),a.jsxs("p",{className:"my-4",children:["Alamat:",a.jsx("br",{}),(i=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:i.customer_alamat_kantor]}),a.jsxs("p",{className:"mb-4",children:["HP: ",a.jsx("br",{}),(x=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:x.customer_no_hp]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-bold",children:"TANGGAL :"}),a.jsx("p",{children:z((F=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:F.tanggal)})]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO FAKTUR PENJUALAN BARANG :"}),a.jsx("p",{children:(f=(b=l==null?void 0:l.fakturPenjualanBarang)==null?void 0:b.at(0))==null?void 0:f.nomor_faktur_penjualan_barang})]}),a.jsx("div",{className:"text-right",children:a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO PESANAN PENJUALAN BARANG :"}),a.jsx("p",{children:(v=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:v.nomor_pesanan_penjualan_barang})]})})]}),a.jsx("div",{className:"flex justify-between",children:a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO SURAT JALAN :"}),a.jsx("p",{children:(N=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:N.nomor_surat_jalan})]})}),a.jsx("p",{className:"pt-5",children:"Dikirimkan barang-barang sebagai berikut :"}),a.jsxs("div",{className:"mt-4 grid grid-cols-12 text-sm gap-x-2 py-2 font-bold border-t-2",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("p",{children:"No."})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{children:"Kode Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{children:"Nama Barang"})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{children:"Satuan Barang"})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{children:"Jumlah Beli"})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{children:"Jumlah Pengiriman"})})]}),(c=l==null?void 0:l.pengirimanBarangList)==null?void 0:c.map((t,o)=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"py-3  border-y-2",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 py-3 items-start font-bold",children:[a.jsx("div",{className:"col-span-1",children:a.jsxs("p",{className:"text-sm",children:[o+1,"."]})}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-sm",children:t==null?void 0:t.kategori_harga_barang_kode_barang}),a.jsx("p",{className:"text-xs font-normal",children:t==null?void 0:t.daftar_gudang_name})]}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:t==null?void 0:t.daftar_barang_name})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-sm",children:t==null?void 0:t.satuan_barang_name})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-sm",children:U(t==null?void 0:t.jumlah)})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-sm",children:U(t==null?void 0:t.pengiriman)})})]}),a.jsx("p",{className:"font-normal text-xs pb-16",children:"Keterangan"})]})})),a.jsxs("div",{className:"grid grid-cols-12 py-5 gap-5 items-start font-bold",children:[_.map(t=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"col-span-3 border-b-2 border-black",children:[a.jsxs("p",{className:"mb-20",children:["Pihak ",t]}),a.jsx("p",{children:" "})]})})),a.jsxs("div",{className:"col-span-3 border-b-2 border-black",children:[a.jsx("p",{className:"mb-20",children:"Penanggung Jawab"}),a.jsx("p",{className:"font-normal",children:(g=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:g.pegawai_penanggung_jawab_name})]}),a.jsxs("div",{className:"col-span-3 border-b-2 border-black",children:[a.jsx("p",{className:"mb-20",children:"Pelaksana"}),a.jsx("p",{className:"font-normal",children:(L=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:L.pegawai_pelaksana_name})]}),a.jsxs("div",{className:"col-span-3 border-b-2 border-black",children:[a.jsx("p",{className:"mb-20",children:"Diterima Oleh"}),a.jsx("p",{children:" "})]})]})]})}),ma=({setAddPengirimanBarangEvent:l=()=>{},pengirimanBarangEdit:e,getData:_=()=>{}})=>{const[y,S]=n.useState(e!=null&&e.tanggal?e.tanggal:Y()),[m,i]=n.useState(e!=null&&e.faktur_penjualan_barang?e.faktur_penjualan_barang:""),[x,F]=n.useState(e!=null&&e.nomor_surat_jalan?e.nomor_surat_jalan:""),[b,f]=n.useState(e!=null&&e.pegawai_penanggung_jawab?e.pegawai_penanggung_jawab:""),[v,N]=n.useState(e!=null&&e.pegawai_pelaksana?e.pegawai_pelaksana:""),[c,g]=n.useState(null),[L,t]=n.useState([]),[o,w]=n.useState([]),[r,T]=n.useState([]),d=async s=>{Z.custom(`${r[s].uuid!=""?`/${r[s].uuid}`:""}`,r[s].uuid!=""?"PUT":"POST",null,{data:{pengiriman_barang:c,rincian_pesanan_penjualan_barang:r[s].rincian_pesanan_penjualan_barang,jumlah:`${r[s].jumlah}`,pengiriman:`${r[s].pengiriman}`}}).then(()=>{s+1<r.length?d(s+1):(_(),l())}).catch(j=>{k(j)})},u=n.useRef(),h=H.useReactToPrint({content:()=>u.current}),C=async s=>{s.preventDefault(),await B(s.target)&&R.custom(e?`/${e.uuid}`:"",e?"PUT":"POST",null,{data:{tanggal:y,faktur_penjualan_barang:m.value,nomor_surat_jalan:x,pegawai_pelaksana:v.value,pegawai_penanggung_jawab:b.value}}).then(j=>{g(e?P=>e.uuid:P=>j.data.uuid)}).catch(j=>{k(j)})},A=()=>{E.custom("","GET").then(s=>{if(w(s.data.entry),s.data.entry.length>0){if(e){K({editObject:e.pegawai_penanggung_jawab,dataList:s.data.entry,setState:f,labelKey:"name",valueKey:"uuid"}),K({editObject:e.pegawai_pelaksana,dataList:s.data.entry,setState:N,labelKey:"name",valueKey:"uuid"});return}f({label:s.data.entry[0].name,value:s.data.entry[0].uuid}),N({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>k(s))},D=()=>{aa.custom("","GET").then(s=>{if(t(s.data.entry),s.data.entry.length>0){if(e){K({editObject:e.faktur_penjualan_barang,dataList:s.data.entry,setState:i,labelKey:"nomor_faktur_penjualan_barang",valueKey:"uuid"});return}i({label:s.data.entry[0].nomor_faktur_penjualan_barang,value:s.data.entry[0].uuid})}}).catch(s=>k(s))},W=()=>{R.custom(`/daftar_pesanan/${c}`,"GET").then(s=>{T(s.data)}).catch(s=>k(s))},Q=(s,j)=>{const P=r,O=r.findIndex($=>$.rincian_pesanan_penjualan_barang==j);O>-1&&(P[O].pengiriman=s),T($=>P)};return n.useEffect(()=>{c&&W()},[c]),n.useEffect(()=>{D(),A(),e!=null&&e.preview&&g(e==null?void 0:e.uuid)},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[e?`${e!=null&&e.preview?"Lihat":"Edit"}`:"Tambahkan"," Pengiriman Barang"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>l(),children:[a.jsx(I,{})," ",e!=null&&e.preview?"Tutup":"Batalkan Pengiriman Barang"]})]}),a.jsxs("form",{onSubmit:s=>C(s),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(p,{label:"Tanggal",type:"datetime-local",onchange:s=>{S(s.target.value)},addClassInput:c||e?"border-none !px-1":"",disabled:c||e,others:{value:y,name:"tanggal"}}),a.jsx(J,{label:"Faktur Penjualan Barang",optionsDataList:L,optionsLabel:"nomor_faktur_penjualan_barang",optionsValue:"uuid",selectValue:m,addClass:c||e?"border-none !px-1":"",disabled:c||e,onchange:s=>{i(s)},selectName:"fakturPenjualanBarang"}),a.jsx(p,{label:"Nomor Surat Jalan",type:"text",addClassInput:c||e!=null&&e.preview?"border-none !px-1":"",onchange:s=>{F(s.target.value)},disabled:c||(e==null?void 0:e.preview),others:{value:x,name:"nomorSuratJalan"}}),a.jsx(J,{label:"Pegawai Penanggung Jawab",optionsDataList:o,optionsLabel:"name",optionsValue:"uuid",selectValue:b,addClass:c||e!=null&&e.preview?"border-none !px-1":"",disabled:c||(e==null?void 0:e.preview),onchange:s=>{f(s)},selectName:"pegawaiPenanggungJawab"}),a.jsx(J,{label:"Pegawai Pelaksana",addClass:c||e!=null&&e.preview?"border-none !px-1":"",optionsDataList:o,optionsLabel:"name",optionsValue:"uuid",selectValue:v,disabled:c||(e==null?void 0:e.preview),onchange:s=>{N(s)},selectName:"pegawaiPelaksana"})]}),c?a.jsx(a.Fragment,{}):a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(G,{})," Simpan"]})]}),c?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto rounded-md h-max max-h-[90vh] no-scrollbar mt-5 pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Jumlah Beli"}),a.jsx("th",{width:30,children:"Jumlah Pengiriman"})]})}),a.jsx("tbody",{children:r==null?void 0:r.map((s,j)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[j+1,"."]}),a.jsx("td",{children:s.kategori_harga_barang_kode_barang}),a.jsx("td",{children:s.daftar_barang_name}),a.jsx("td",{children:s.satuan_barang_name}),a.jsx("td",{children:s.jumlah}),a.jsx("td",{children:e!=null&&e.preview?a.jsx(a.Fragment,{children:s.pengiriman}):a.jsx(a.Fragment,{children:a.jsx(q,{name:"pengiriman_"+j,type:"text",other:{defaultValue:s.pengiriman},onchange:P=>{ja(P,s.jumlah),Q(P.target.value,s.rincian_pesanan_penjualan_barang)}})})})]},j)}))})]})}),e!=null&&e.preview?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden",children:a.jsx(xa,{ref:u,pengirimanBarangList:r,pengirimanBarangEdit:e,fakturPenjualanBarang:L.filter(s=>s.uuid==m.value)})}),a.jsxs("button",{className:"btn btn-sm bg-red-800 mt-4 text-white",type:"button",onClick:h,children:[a.jsx(M,{})," Cetak Surat Jalan"]})]}):a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",type:"button",onClick:()=>{d(0)},children:[a.jsx(G,{})," Simpan"]})]}):a.jsx(a.Fragment,{})]})})},wa=()=>{ea();const[l,e]=n.useState([]),[_,y]=n.useState([]),[S,m]=n.useState(!1),[i,x]=n.useState(!1),[F,b]=n.useState({name:""}),[f,v]=n.useState(!1),[N,c]=n.useState(""),g=n.useRef();H.useReactToPrint({content:()=>g.current});const[L,t]=n.useState({page:1,size:10,count:118,lastPage:12}),o=(d="")=>{d==""&&c(d),m(!0),R.custom(`?search=${d}`,"GET").then(u=>{var C,A;let h=ua(u.data.entry,"nomor_faktur_penjualan_barang");v(d.length<1),y(h),e((C=u==null?void 0:u.data)==null?void 0:C.entry),t((A=u==null?void 0:u.data)==null?void 0:A.pagination),m(!1)}).catch(u=>{k(u)})},w=d=>{d.preview=!1,b(d),x(!i)},r=d=>{d.preview=!0,b(d),x(!i)},T=async d=>{await ha("Hapus","Yakin ingin hapus data ini ?")&&R.custom(`/${d.uuid}`,"DELETE").then(()=>{oa("Berhasil","Data berhasil dihapus"),o()}).catch(u=>{k(u)})};return n.useEffect(()=>{o()},[]),a.jsx(sa,{isLoading:S,children:a.jsxs("div",{children:[a.jsx(la,{title:"Pengiriman Barang"}),i?a.jsx(ma,{setAddPengirimanBarangEvent:()=>x(!1),getData:o,pengirimanBarangEdit:F}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:N,onChange:d=>c(d.target.value)}),f?a.jsx(ta,{onClick:()=>{o(N)},className:"cursor-pointer"}):a.jsx(I,{onClick:()=>o(""),className:"cursor-pointer"})]}),a.jsx("div",{className:"flex gap-x-2 items-center",children:a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{b(null),x(!i)},children:[a.jsx(na,{})," Tambah Pengiriman Barang"]})})]}),a.jsx("div",{className:"overflow-x-auto px-3 bg-white shadow-xl rounded-md",children:_==null?void 0:_.map((d,u)=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-3 border-b-2 border-gray-400",children:[a.jsx("p",{className:"text-xs",children:"Nomor Faktur Penjualan"}),a.jsx("p",{className:"font-bold",children:d.parent})]}),d.data.map((h,C)=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"px-6 py-4 flex gap-x-4 items-center",children:[a.jsx(ca,{className:"text-blue-800",size:11}),a.jsxs("div",{className:"grid grid-cols-9 w-full",children:[a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Tanggal"}),a.jsx("p",{className:"text-sm font-bold",children:z(h.tanggal)})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Nomor Surat Jalan"}),a.jsx("p",{className:"text-sm font-bold",children:h==null?void 0:h.nomor_surat_jalan})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Penanggung Jawab"}),a.jsx("p",{className:"text-sm font-bold",children:h.pegawai_penanggung_jawab_name})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Pelaksana"}),a.jsx("p",{className:"text-sm font-bold",children:h.pegawai_pelaksana_name})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsx("p",{className:"text-xs",children:"Aksi"}),C==0?a.jsx(a.Fragment,{children:a.jsx("div",{children:a.jsxs("div",{className:"flex items-center",children:[a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-green-400",onClick:()=>{r(h)},children:[a.jsx(V,{size:10}),"Lihat"]}),a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-yellow-400",onClick:()=>{w(h)},children:[a.jsx(da,{size:10}),"Edit"]}),a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-red-600",onClick:()=>{T(h)},children:[a.jsx(ra,{size:10}),"Hapus"]})]})})}):a.jsx(a.Fragment,{children:a.jsx("div",{children:a.jsx("div",{className:"flex items-center",children:a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-green-400",onClick:()=>{r(h)},children:[a.jsx(V,{size:10}),"Lihat"]})})})})]})]})]})}))]}))})]})]})})};export{wa as default};
