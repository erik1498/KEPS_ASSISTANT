import{r as s,j as a,h as sa,aw as Pa,s as $,k as J,bt as da,R as va,f as fa,b as Y,y as X,i as Fa,F as Z,az as ya,bu as ca,c as xa,b7 as ha,b8 as ga,n as V,bv as na,bb as ua,bw as ba,bx as ma,by as ja,bz as oa,O as M,bg as Ta,bA as ea,A as _a,Y as Ba,u as Ra,a as Sa,o as ka,a0 as $a,bB as ia}from"./index-BFtBgOrg.js";import{P as Ca}from"./PageTitle-Hc-YSVDI.js";import{v as Na,W as Da}from"./Wrap-Dk-wg8kL.js";import{F as H}from"./FormInputWithLabel-zEsdZ3IQ.js";import{F as q}from"./FormSelectWithLabel-BuQTQxHx.js";import{i as W}from"./actionEvent.helper-BujKUZ7B.js";import{p as g,a as O,k as Ea}from"./number.helper-efe0YCx6.js";import{T as wa}from"./ToggleBox-BuOhxKmX.js";import{P as Aa,l as La}from"./PDFHeader-BGA35-Z9.js";import{P as za}from"./Pagination-CNke5GoU.js";import{F as K}from"./FormInput-DctP6iug.js";import{g as Ga}from"./jurnalUmum.helper-caEROVYd.js";import"./index-BKNjMPK8.js";import"./react-paginate-C1eAq6Tf.js";const Ha=({pesananPembelianBarang:t,_getDataRincianDaftarPasananPembelian:l,kategoriHargaBarangList:c})=>{const[y,_]=s.useState(!1),[B,L]=s.useState([]),[j,z]=s.useState(),[k,D]=s.useState(),[p,C]=s.useState(),[m,T]=s.useState(0),[N,w]=s.useState(0),[v,E]=s.useState(0),[R,i]=s.useState(0),[P,n]=s.useState(0),[d,x]=s.useState(0),[e,f]=s.useState(0),[u,S]=s.useState(0),r=()=>{C(h=>null),Pa.custom(`/gudang_barang/${k.value}/${t.uuid}/pembelian`,"GET").then(h=>{L(h.data),h.data.length>0&&C(F=>({label:h.data[0].daftar_gudang_name,value:h.data[0].uuid}))}).catch(h=>$(h))},A=async h=>{h.preventDefault(),await J(h.target)&&da.custom("","POST",null,{data:{pesanan_pembelian_barang:t.uuid,kategori_harga_barang:k.value,stok_awal_barang:p.value,jumlah:`${m}`,harga:`${N}`,harga_setelah_diskon:`${u}`,ppn:`${v}`,ppn_setelah_diskon:`${e}`,diskon_angka:`${R}`,diskon_persentase:`${P}`,total_harga:`${d}`}}).then(F=>{l()}).catch(F=>$(F))},ta=h=>{try{const F=O(h.target.value)*O(N)/100;n(h.target.value),i(I=>I=g(F))}catch{i(I=>0)}},la=()=>{try{const h=O(R)*100/O(N);n(F=>F=h),G()}catch{n(F=>0)}};s.useEffect(()=>{j&&la()},[R]);const G=()=>{const h=O(m),F=O(N)-O(R);S(Q=>F);const I=j.ppn==1?F*Na/100:0;f(Q=>I);const ra=h*F+I*h;x(Q=>ra)};return s.useEffect(()=>{j&&G()},[m]),s.useEffect(()=>{if(k){r();const h=c.filter(F=>F.uuid==k.value);h.length>0&&(T(F=>0),w(F=>h[0].harga_beli),E(F=>h[0].harga_beli*Na/100),_(F=>0),i(F=>0),n(F=>0),z(h[0]))}},[k]),s.useEffect(()=>{D({label:c[0].kode_barang,value:c[0].uuid})},[]),a.jsx(a.Fragment,{children:a.jsxs("form",{className:"gap-x-2 py-3",onSubmit:h=>A(h),children:[a.jsxs("div",{className:"flex items-end gap-x-2",children:[a.jsx(q,{label:"Kode Barang",optionsDataList:c,optionsLabel:"kode_barang",optionsValue:"uuid",selectValue:k,onchange:h=>{D(h)},selectName:"kategoriHargaBarang"}),a.jsx(q,{label:"Gudang Asal",optionsDataList:B,optionsLabel:"daftar_gudang_name",optionsValue:"uuid",selectValue:p,onchange:h=>{C(h)},selectName:"gudangBarang"})]}),j?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"gap-x-2 bg-gray-300 my-4 rounded-md px-2 py-3",children:[a.jsx("p",{className:"text-xl font-extrabold",children:j.daftar_barang_name}),a.jsx("p",{className:"font-bold bg-blue-800 px-2 text-white rounded-md w-max mt-2",children:j.satuan_barang_name})]}),p?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(H,{label:"Jumlah",type:"text",onchange:h=>{W(h),T(h.target.value)},others:{value:m,name:"jumlah"}}),a.jsx(H,{label:"Harga",type:"text",addClassInput:"border-none px-1",disabled:!0,others:{value:`Rp. ${g(N)}`,name:"harga"}}),a.jsx(H,{label:"PPN",type:"text",disabled:!0,addClassInput:"border-none px-1",others:{value:`Rp. ${g(v)}`,name:"ppn"}})]}),a.jsx("div",{className:"mt-5",children:a.jsx(wa,{label:"Gunakan Diskon ?",setToggleBox:_,toggleBox:y,toggleBoxList:[{label:"Tidak",value:0},{label:"Ya",value:1}]})}),y?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mt-5 flex gap-x-2",children:[a.jsx(H,{label:"Diskon Angka",type:"text",onchange:h=>{W(h),i(h.target.value)},others:{value:R,name:"diskonAngka"}}),a.jsx(H,{label:"Diskon Persentase",type:"text",onchange:h=>{W(h),ta(h)},others:{value:P,name:"diskonPersentase"}})]}),a.jsxs("div",{className:"mt-5 gap-x-2 px-1",children:[a.jsx("p",{className:"font-bold mt-2",children:"Harga Setelah Diskon"}),a.jsxs("p",{className:"font-bold mt-2 text-xl",children:["Rp. ",g(u)]}),j.ppn==1?a.jsx(a.Fragment,{children:a.jsxs("p",{className:"font-bold mb-5 mt-2",children:["PPN Rp. ",g(e)]})}):a.jsx(a.Fragment,{})]})]}):a.jsx(a.Fragment,{}),a.jsxs("div",{className:"mt-5 gap-x-2 px-1",children:[a.jsx("p",{className:"font-bold text-sm",children:"Total Harga"}),a.jsxs("p",{className:"font-bold text-4xl",children:["Rp. ",g(d)]})]})]}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{}),p?a.jsx(a.Fragment,{children:a.jsxs("button",{className:"mt-3 btn w-full bg-green-800 text-white",children:[a.jsx(sa,{})," Simpan Pesanan"]})}):a.jsx(a.Fragment,{})]})})},Ka=va.forwardRef((t,l)=>a.jsxs("div",{ref:l,children:[a.jsx(Aa,{bulan:t.bulan,tahun:t.tahun,title:"PESANAN PEMBELIAN BARANG"}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",children:"KEPADA :"}),a.jsx("p",{children:t.supplier.name}),a.jsx("p",{children:t.supplier.code}),a.jsxs("p",{children:["HP. ",t.supplier.no_hp]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-bold",children:"TANGGAL :"}),a.jsx("p",{children:fa(t.tanggalPesananPembelianBarang)})]})]}),a.jsx("div",{className:"flex justify-between",children:a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO PESANAN PEMBELIAN BARANG :"}),a.jsx("p",{children:t.nomorPesananPembelianBarang})]})}),a.jsxs("div",{className:"mt-4 grid grid-cols-12 text-sm gap-x-2 py-2 font-bold border-t-2",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("p",{children:"No."})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{children:"Kode Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{children:"Nama Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{children:"Satuan Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{children:"Harga Barang"})})]}),t.rincianPesananPembelianBarang.map((c,y)=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"py-3  border-t-2",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 py-3 items-start font-bold",children:[a.jsx("div",{className:"col-span-1",children:a.jsxs("p",{className:"text-sm",children:[y+1,"."]})}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-sm",children:c.kategori_harga_Barang_kode_Barang}),a.jsx("p",{className:"text-sm my-1",children:c.daftar_gudang_name})]}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:c.daftar_Barang_name})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:c.satuan_Barang_name})}),a.jsxs("div",{className:"col-span-3",children:[a.jsxs("p",{className:"text-sm",children:["Rp. ",g(c.harga)]}),a.jsxs("p",{className:"text-sm",children:["PPN : Rp. ",g(c.ppn)]})]})]}),a.jsxs("div",{className:"grid grid-cols-12 text-sm gap-x-2 font-bold",children:[a.jsx("div",{className:"col-span-1"}),a.jsx("div",{className:"col-span-2",children:a.jsxs("p",{children:["Jumlah : ",g(c.jumlah)]})}),a.jsx("div",{className:"col-span-3",children:c.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsx("p",{children:"Diskon"}),a.jsx("p",{children:"Harga Diskon"}),a.jsx("p",{children:"PPN Diskon"})]}):a.jsx(a.Fragment,{})}),a.jsx("div",{className:"col-span-3",children:c.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["Rp. ",g(c.diskon_angka)," (",c.diskon_persentase," % )"]}),a.jsxs("p",{children:["Rp. ",g(c.harga_setelah_diskon)]}),a.jsxs("p",{children:["Rp. ",g(c.ppn_setelah_diskon)]})]}):a.jsx(a.Fragment,{})}),a.jsxs("div",{className:"col-span-3",children:["Total Harga ",a.jsxs("p",{children:["Rp. ",g(c.total_harga)]})]})]})]})})),a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 pt-5 items-start font-bold border-t-2",children:[a.jsx("div",{className:"col-span-9",children:a.jsx("p",{children:"PEMBAYARAN"})}),a.jsx("div",{className:"col-span-3",children:a.jsxs("p",{children:["TOTAL ",a.jsx("br",{})," Rp. ",g(t.total)]})})]}),a.jsxs("div",{className:"pb-5",children:[a.jsx("p",{className:"font-bold mt-5",children:"TERBILANG"}),a.jsxs("p",{className:"font-normal",children:[Ea(t.total).toString().toUpperCase()," RUPIAH"]})]})]})),Ua=({pesananPembelianBarang:t,tanggalPesananPembelianBarang:l,nomorPesananPembelianBarang:c,supplier:y,fakturStatus:_,tanggalTransaksiAkhir:B,rincianPesananPembelianBarang:L,setRincianPesananPembelianBarang:j=()=>{}})=>{const[z,k]=s.useState([]),[D,p]=s.useState(!1),[C,m]=s.useState(0),T=s.useRef(),N=La.useReactToPrint({content:()=>T.current}),w=()=>{da.custom(`/${t.uuid}`,"GET").then(i=>{j(i.data)}).catch(i=>$(i))},v=()=>{ya.custom("/transaksi","GET").then(i=>{k(i.data)}).catch(i=>$(i))},E=i=>{da.custom(`/${i}`,"DELETE").then(P=>{w()}).catch(P=>$(P))},R=()=>{ca.custom("/pesanan_by_tanggal","POST",null,{data:{faktur_pembelian_barang:_,tanggal:B}}).then(i=>{j(n=>i.data);const P=i.data.reduce((n,d)=>n+parseFloat(d.piutang),0);m(n=>P)})};return s.useEffect(()=>{v(),_?R():w()},[_,B,D]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"grid grid-cols-12 gap-x-2",children:[a.jsx("div",{className:`${_?"hidden":"col-span-4"}`,children:z.length>0?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white rounded-md my-4 py-6 px-6 shadow-2xl",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Detail Barang Pesanan"}),a.jsx(Ha,{_getDataRincianDaftarPasananPembelian:w,_hapusPesanan:()=>{},kategoriHargaBarangList:z,pesananPembelianBarang:t})]})}):a.jsx(a.Fragment,{})}),a.jsx("div",{className:`${_?"col-span-12":"col-span-8"}`,children:a.jsxs("div",{className:`bg-white my-4 rounded-md no-scrollbar relative ${_?"h-max max-h-[60vh]":"h-[70vh]"} overflow-y-scroll`,children:[a.jsxs("div",{className:"sticky top-0",children:[a.jsxs("div",{className:"bg-white py-4 px-6 rounded-md",children:[a.jsx("p",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Total Pesanan"}),a.jsxs("p",{className:"font-bold text-4xl",children:["Rp. ",g(L.reduce((i,P)=>i+parseFloat(P.total_harga),0))]}),_?a.jsx(a.Fragment,{children:C>0?a.jsxs("div",{className:"flex items-center gap-x-2 w-max my-2 px-2 py-1 rounded-md border-2 border-red-800",children:[a.jsx(Y,{className:"text-red-800",size:13}),a.jsx("p",{className:"mb-0 text-red-800 font-bold",children:"Belum Lunas"})]}):a.jsxs("div",{className:"flex items-center gap-x-2 w-max my-2 px-2 py-1 rounded-md border-2 border-green-800",children:[a.jsx(X,{className:"text-green-800",size:13}),a.jsx("p",{className:"mb-0 text-green-800 font-bold",children:"Lunas"})]})}):a.jsx(a.Fragment,{}),a.jsxs("div",{className:"mt-5 flex items-center gap-x-2",children:[_?a.jsx(a.Fragment,{children:D?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn bg-gray-100 text-red-500 btn-sm border-red-500",onClick:()=>{p(i=>i=!i)},children:"Tutup Daftar Pesanan"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn bg-gray-100 btn-sm border-gray-500",onClick:()=>{p(i=>i=!i)},children:"Lihat Daftar Pesanan"})})}):a.jsx(a.Fragment,{}),a.jsx("div",{className:"hidden",children:a.jsx(Ka,{supplier:y,ref:T,rincianPesananPembelianBarang:L,pesananPembelianBarang:t,tanggalPesananPembelianBarang:l,nomorPesananPembelianBarang:c,total:L.reduce((i,P)=>i+parseFloat(P.total_harga),0)})}),a.jsxs("button",{className:"btn bg-red-800 text-white btn-sm border-red",onClick:N,children:[a.jsx(Fa,{})," Cetak Pesanan Pembelian Barang"]})]})]}),_&&!D?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"grid grid-cols-12 text-sm gap-x-2 py-2 font-bold border-t-2 bg-gray-100 px-6",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("p",{className:"text-gray-500",children:"No."})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Kode Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Nama Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Satuan Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Harga Barang"})})]})})]}),_&&!D?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:L.map((i,P)=>a.jsxs("div",{className:"py-3  border-t-2",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 px-6 items-start font-bold",children:[a.jsx("div",{className:"col-span-1",children:a.jsxs("p",{className:"text-sm",children:[P+1,"."]})}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-sm",children:i.kategori_harga_barang_kode_barang}),a.jsx("p",{className:"text-xs my-1 font-normal",children:i.daftar_gudang_name})]}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:i.daftar_barang_name})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:i.satuan_barang_name})}),a.jsxs("div",{className:"col-span-3",children:[a.jsxs("p",{className:"text-sm",children:["Rp. ",g(i.harga)]}),a.jsxs("p",{className:"text-xs font-normal",children:["PPN : Rp. ",g(i.ppn)]})]})]}),a.jsxs("div",{className:"grid grid-cols-12 text-xs gap-x-2 px-6 text-gray-500 font-bold",children:[a.jsx("div",{className:"col-span-1"}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("p",{children:["Jumlah : ",g(i.jumlah)]}),_?a.jsx(a.Fragment,{children:a.jsxs("p",{children:["Retur : ",g(i.retur)]})}):a.jsx(a.Fragment,{})]}),a.jsx("div",{className:"col-span-3",children:i.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsx("p",{children:"Diskon"}),a.jsx("p",{children:"Harga Diskon"}),a.jsx("p",{children:"PPN Diskon"})]}):a.jsx(a.Fragment,{})}),a.jsx("div",{className:"col-span-3",children:i.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["Rp. ",g(i.diskon_angka)," (",i.diskon_persentase," % )"]}),a.jsxs("p",{children:["Rp. ",g(i.harga_setelah_diskon)]}),a.jsxs("p",{children:["Rp. ",g(i.ppn_setelah_diskon)]})]}):a.jsx(a.Fragment,{})}),a.jsxs("div",{className:"col-span-3",children:["Total Harga ",a.jsxs("p",{children:["Rp. ",g(i.total_harga)]}),_?a.jsxs(a.Fragment,{children:["Status ",a.jsx("p",{children:i.piutang!="0"?`Belum Lunas ( Rp. ${g(i.piutang)} )`:"Sudah Lunas"})]}):a.jsx(a.Fragment,{})]})]}),_?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsx("div",{className:"grid grid-cols-12 gap-x-2 px-6",children:a.jsx("div",{className:"col-span-1 col-start-2 mb-3",children:a.jsxs("button",{className:"btn w-max btn-sm bg-red-700 text-white",onClick:n=>{E(i.uuid)},children:[a.jsx(Z,{})," Hapus"]})})})})]}))})]})})]})})},Oa=({riwayatPelunasanPembelianBarang:t,edited:l,_getDaftarRiwayatTransaksi:c=()=>{}})=>{const[y,_]=s.useState(t.nomor_transaksi!="EMPTY"?t.nomor_transaksi:""),[B,L]=s.useState(t.bukti_transaksi!="EMPTY"?t.bukti_transaksi:""),[j,z]=s.useState(t.keterangan!="EMPTY"?t.keterangan:"Tidak Ada"),[k,D]=s.useState(t.total),[p,C]=s.useState(t.total_denda),[m,T]=s.useState([]),[N,w]=s.useState(!1),[v,E]=s.useState(l),R=()=>{ca.custom(`/pesanan/${t.uuid}`).then(e=>{T(e.data)}).catch(e=>$(e))},i=(e,f)=>{let u=m,S=0;u=u.map(r=>(r.uuid==f&&(r.nilai_pelunasan=e),S+=O(r.nilai_pelunasan),r)),D(r=>S),T(r=>u)},P=(e,f)=>{let u=m,S=0;u=u.map(r=>(r.uuid==f&&(r.nilai_pelunasan_denda=e),S+=O(r.nilai_pelunasan_denda),r)),C(r=>S),T(r=>u)},n=async()=>{for(let e=0;e<m.length;e++)await ca.custom(`${m[e].rincian_pelunasan_pembelian_barang?`/${m[e].rincian_pelunasan_pembelian_barang}`:""}`,m[e].rincian_pelunasan_pembelian_barang?"PUT":"POST",null,{data:{pelunasan_pembelian_barang:t.uuid,rincian_pesanan_pembelian_barang:m[e].uuid,sudah_dibayar:m[e].sudah_dibayar,piutang:m[e].piutang,nilai_pelunasan:`${m[e].nilai_pelunasan}`,nilai_pelunasan_denda:`${m[e].nilai_pelunasan_denda}`}}).then(()=>{V("Berhasil","Data Berhasil Disimpan")}).catch(f=>$(f));R()},d=()=>{na.custom("/"+t.uuid,"DELETE").then(()=>{c()}).catch(e=>$(e))},x=async()=>{await ua(),await J()&&na.custom("/"+t.uuid,"PUT",null,{data:{nomor_pelunasan_pembelian_barang:y,bukti_transaksi:B,keterangan:j,faktur_pembelian_barang:t.faktur_pembelian_barang,tanggal:t.tanggal,kode_akun_perkiraan:t.kode_akun_perkiraan}}).then(()=>{V("Berhasil","Data Berhasil Disimpan")}).catch(e=>$(e))};return s.useEffect(()=>{N&&R()},[N]),a.jsxs("div",{className:"border-b-2 py-2",children:[a.jsx("div",{className:"cursor-pointer",onClick:()=>{E(e=>e=!e)},children:a.jsxs("div",{className:"flex items-center justify-between gap-x-2 px-4",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsx("p",{className:"text-sm pr-2 font-medium",children:xa(t.tanggal.split("T")[1])}),a.jsx("p",{className:"text-sm pr-2 font-medium px-3 border-l-2 border-black",children:"Pelunasan Pembelian Barang"})]}),v?a.jsx(ha,{size:15}):a.jsx(ga,{size:15})]})}),v?a.jsx(a.Fragment,{children:a.jsx("div",{className:"ml-4 py-4 px-4",children:v?a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"text-left text-sm",children:[a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Nomor Pelunasan Pembelian Barang"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(K,{addClass:"px-0",name:"nomor_pelunasan_pembelian_barang",value:y,onchange:e=>_(e.target.value)}):t.nomor_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Bukti Transaksi"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(K,{addClass:"px-0",name:"bukti_transaksi",value:B,onchange:e=>L(e.target.value)}):t.bukti_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-5":""}`,children:"Kode Akun"}),a.jsx("td",{className:`px-5 ${l?"pb-5":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-5":""}`,children:[t.kode_akun_perkiraan_code," - ",t.kode_akun_perkiraan_name]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Total Pelunasan"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-3":""}`,children:["Rp. ",g(k)]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Total Pelunasan Denda"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-3":""}`,children:["Rp. ",g(p)]})]})]}),a.jsx("p",{className:`text-sm mt-3 ${l?"mt-5":""}`,children:"Keterangan"}),a.jsx("p",{className:"text-sm mb-3",children:l?a.jsx(K,{addClass:"mt-5",name:"keterangan",value:j,onchange:e=>z(e.target.value)}):t.keterangan}),a.jsxs("div",{className:"my-2 flex justify-between",children:[a.jsx("div",{children:l?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"mr-2 btn btn-sm bg-green-900 text-white",onClick:()=>x(),children:[a.jsx(X,{size:12}),"Simpan"]}),a.jsxs("button",{className:"mr-2 btn btn-sm bg-red-500 text-white",onClick:()=>d(),children:[a.jsx(Z,{size:12}),"Hapus"]})]}):a.jsx(a.Fragment,{})}),N?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm border-red-500 text-red-500",onClick:()=>w(e=>e=!e),children:"Tutup Daftar Pelunasan"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm bg-white border-gray-400",onClick:()=>w(e=>e=!e),children:"Lihat Daftar Pelunasan"})})]}),N?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Pelunasan Sudah Dibayar"}),a.jsx("th",{children:"Piutang"}),a.jsx("th",{width:200,children:"Nilai Pelunasan"}),a.jsx("th",{width:200,children:"Nilai Pelunasan Denda"})]}),a.jsx("tbody",{children:m.map((e,f)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[f+1,"."]}),a.jsx("td",{children:e.kategori_harga_barang_kode_barang}),a.jsx("td",{children:e.daftar_barang_name}),a.jsx("td",{children:e.satuan_barang_name}),a.jsx("td",{children:e.daftar_gudang_name}),a.jsxs("td",{children:["Rp. ",g(e.sudah_dibayar)]}),a.jsxs("td",{children:["Rp. ",g(e.piutang)]}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(K,{name:"nilai_pelunasan",type:"text",other:{defaultValue:0},onchange:u=>{W(u,e.piutang),i(u.target.value,e.uuid)},value:g(e.nilai_pelunasan)})}):a.jsxs(a.Fragment,{children:["Rp. ",g(e.nilai_pelunasan)]})}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(K,{name:"nilai_pelunasan_denda",type:"text",other:{defaultValue:0},onchange:u=>{P(u.target.value,e.uuid)},value:g(e.nilai_pelunasan_denda)})}):a.jsxs(a.Fragment,{children:["Rp. ",g(e.nilai_pelunasan_denda)]})})]})}))})]})}),l?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn btn-sm bg-green-900 text-white",onClick:()=>{n()},children:"Simpan"})})}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})})}):a.jsx(a.Fragment,{})]})},Ia=({riwayatReturPembelianBarang:t,edited:l,_getDaftarRiwayatTransaksi:c=()=>{}})=>{const[y,_]=s.useState(t.nomor_transaksi!="EMPTY"?t.nomor_transaksi:""),[B,L]=s.useState(t.bukti_transaksi!="EMPTY"?t.bukti_transaksi:""),[j,z]=s.useState(t.keterangan!="EMPTY"?t.keterangan:"Tidak Ada"),[k,D]=s.useState(t.total),[p,C]=s.useState(!1),[m,T]=s.useState([]),[N,w]=s.useState(!1),[v,E]=s.useState(l),R=()=>{ba.custom(`/pesanan/${t.uuid}`).then(e=>{T(e.data)}).catch(e=>$(e))},i=(e,f)=>{let u=m,S=0;u=u.map(r=>(r.uuid==f&&(r.nilai_retur=e),S+=O(r.nilai_retur),r)),D(r=>S),T(r=>u)},P=(e,f)=>{let u=m;u=u.map(S=>(S.uuid==f&&(S.retur=e),S)),T(S=>u)},n=async()=>{for(let e=0;e<m.length;e++)await ba.custom(`${m[e].rincian_retur_pembelian_barang?`/${m[e].rincian_retur_pembelian_barang}`:""}`,m[e].rincian_retur_pembelian_barang?"PUT":"POST",null,{data:{retur_pembelian_barang:t.uuid,rincian_pesanan_pembelian_barang:m[e].uuid,jumlah:`${m[e].jumlah_fix}`,denda_sudah_dibayar:`${m[e].denda_sudah_dibayar}`,sudah_dibayar:`${m[e].sudah_dibayar_fix}`,retur:`${m[e].retur}`,nilai_retur:`${m[e].nilai_retur}`,retur_sebelum:`${m[e].retur_sebelum}`,nilai_retur_sebelum:`${m[e].nilai_retur_sebelum}`}}).then(()=>{V("Berhasil","Data Berhasil Disimpan")});R()},d=()=>{ma.custom("/"+t.uuid,"DELETE").then(()=>{c()}).catch(e=>$(e))},x=async()=>{await ua(),await J()&&ma.custom("/"+t.uuid,"PUT",null,{data:{nomor_retur_pembelian_barang:y,bukti_transaksi:B,keterangan:j,faktur_pembelian_barang:t.faktur_pembelian_barang,tanggal:t.tanggal,kode_akun_perkiraan:t.kode_akun_perkiraan}}).then(()=>{V("Berhasil","Data Berhasil Disimpan")}).catch(e=>$(e))};return s.useEffect(()=>{N&&!p&&(R(),C(e=>!0))},[N]),a.jsxs("div",{className:"border-b-2 py-2",children:[a.jsx("div",{className:"cursor-pointer",onClick:()=>{E(e=>e=!e)},children:a.jsxs("div",{className:"flex items-center justify-between gap-x-2 px-4",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsx("p",{className:"text-sm pr-2 font-medium",children:xa(t.tanggal.split("T")[1])}),a.jsx("p",{className:"text-sm pr-2 font-medium px-4 border-l-2 border-black",children:"Retur Pembelian Barang"})]}),v?a.jsx(ha,{size:15}):a.jsx(ga,{size:15})]})}),v?a.jsx(a.Fragment,{children:a.jsx("div",{className:"ml-4 py-4 px-4",children:v?a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"text-left text-sm",children:[a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Nomor Retur Pembelian Barang"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(K,{addClass:"px-0",name:"nomor_retur_pembelian_barang",value:y,onchange:e=>_(e.target.value)}):t.nomor_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Bukti Transaksi"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(K,{addClass:"px-0",name:"bukti_transaksi",value:B,onchange:e=>L(e.target.value)}):t.bukti_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-5":""}`,children:"Kode Akun"}),a.jsx("td",{className:`px-5 ${l?"pb-5":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-5":""}`,children:[t.kode_akun_perkiraan_code," - ",t.kode_akun_perkiraan_name]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Total Retur"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-3":""}`,children:["Rp. ",g(k)]})]})]}),a.jsx("p",{className:`text-sm mt-3 ${l?"mt-5":""}`,children:"Keterangan"}),a.jsx("p",{className:"text-sm mb-3",children:l?a.jsx(K,{addClass:"mt-5",name:"keterangan",value:j,onchange:e=>z(e.target.value)}):t.keterangan}),a.jsxs("div",{className:"my-2 flex justify-between",children:[a.jsx("div",{children:l?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"mr-2 btn btn-sm bg-green-900 text-white",onClick:()=>x(),children:[a.jsx(X,{size:12}),"Simpan"]}),a.jsxs("button",{className:"mr-2 btn btn-sm bg-red-500 text-white",onClick:()=>d(),children:[a.jsx(Z,{size:12}),"Hapus"]})]}):a.jsx(a.Fragment,{})}),N?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm border-red-500 text-red-500",onClick:()=>w(e=>e=!e),children:"Tutup Daftar Retur"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm bg-white border-gray-400",onClick:()=>w(e=>e=!e),children:"Lihat Daftar Retur"})})]}),N?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Pelunasan Sudah Dibayar"}),a.jsx("th",{width:150,children:"Retur Sebelumnya"}),a.jsx("th",{width:150,children:"Retur"}),a.jsx("th",{width:150,children:"Nilai Retur"})]}),a.jsx("tbody",{children:m.map((e,f)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[f+1,"."]}),a.jsx("td",{children:e.kategori_harga_barang_kode_barang}),a.jsx("td",{children:e.daftar_barang_name}),a.jsx("td",{children:e.satuan_barang_name}),a.jsx("td",{children:e.daftar_gudang_name}),a.jsxs("td",{children:["Rp. ",g(e.sudah_dibayar_fix)]}),a.jsxs("td",{children:[g(e.retur_sebelum)," ",e.satuan_barang_name]}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(K,{name:"retur",type:"text",other:{defaultValue:0},onchange:u=>{W(u,e.jumlah_fix),P(u.target.value,e.uuid)},value:g(e.retur)})}):a.jsxs(a.Fragment,{children:[g(e.retur)," ",e.satuan_barang_name]})}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(K,{name:"retur",type:"text",other:{defaultValue:0},onchange:u=>{i(u.target.value,e.uuid)},value:g(e.nilai_retur)})}):a.jsxs(a.Fragment,{children:["Rp. ",g(e.nilai_retur)]})})]})}))})]})}),l?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn btn-sm bg-green-900 text-white",onClick:()=>{n()},children:"Simpan"})})}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})})}):a.jsx(a.Fragment,{})]})},Ya=({riwayatPengembalianDendaPembelianBarang:t,edited:l,_getDaftarRiwayatTransaksi:c=()=>{}})=>{const[y,_]=s.useState(t.nomor_transaksi!="EMPTY"?t.nomor_transaksi:""),[B,L]=s.useState(t.bukti_transaksi!="EMPTY"?t.bukti_transaksi:""),[j,z]=s.useState(t.keterangan!="EMPTY"?t.keterangan:"Tidak Ada"),[k,D]=s.useState(t.total),[p,C]=s.useState([]),[m,T]=s.useState(!1),[N,w]=s.useState(l),v=()=>{ja.custom(`/pesanan/${t.uuid}`).then(n=>{C(n.data)}).catch(n=>$(n))},E=async()=>{for(let n=0;n<p.length;n++)await ja.custom(`${p[n].rincian_pengembalian_denda_pembelian_barang?`/${p[n].rincian_pengembalian_denda_pembelian_barang}`:""}`,p[n].rincian_pengembalian_denda_pembelian_barang?"PUT":"POST",null,{data:{pengembalian_denda_pembelian_barang:t.uuid,rincian_pesanan_pembelian_barang:p[n].uuid,denda_yang_dikembalikan:`${p[n].denda_yang_dikembalikan}`}}).then(()=>{V("Berhasil","Data Berhasil Disimpan")});v()},R=()=>{oa.custom("/"+t.uuid,"DELETE").then(()=>{c()}).catch(n=>$(n))},i=(n,d)=>{let x=p,e=0;x=x.map(f=>(f.uuid==d&&(f.denda_yang_dikembalikan=n),e+=O(f.denda_yang_dikembalikan),f)),D(f=>e),C(f=>x)},P=async()=>{await ua(),await J()&&oa.custom("/"+t.uuid,"PUT",null,{data:{nomor_pengembalian_denda_pembelian_barang:y,bukti_transaksi:B,keterangan:j,faktur_pembelian_barang:t.faktur_pembelian_barang,tanggal:t.tanggal,kode_akun_perkiraan:t.kode_akun_perkiraan}}).then(()=>{V("Berhasil","Data Berhasil Disimpan")}).catch(n=>$(n))};return s.useEffect(()=>{m&&v()},[m]),a.jsxs("div",{className:"border-b-2 py-2",children:[a.jsx("div",{className:"cursor-pointer",onClick:()=>{w(n=>n=!n)},children:a.jsxs("div",{className:"flex items-center justify-between gap-x-2 px-4",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsx("p",{className:"text-sm pr-2 font-medium",children:xa(t.tanggal.split("T")[1])}),a.jsx("p",{className:"text-sm pr-2 font-medium px-3 border-l-2 border-black",children:"Pengembalian Denda Pembelian Barang"})]}),N?a.jsx(ha,{size:15}):a.jsx(ga,{size:15})]})}),N?a.jsx(a.Fragment,{children:a.jsx("div",{className:"ml-4 py-4 px-4",children:N?a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"text-left text-sm",children:[a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Nomor Pengembalian Denda Pembelian Barang"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(K,{addClass:"px-0",name:"nomor_pengembalian_denda_pembelian_barang",value:y,onchange:n=>_(n.target.value)}):t.nomor_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Bukti Transaksi"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(K,{addClass:"px-0",name:"bukti_transaksi",value:B,onchange:n=>L(n.target.value)}):t.bukti_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-5":""}`,children:"Kode Akun"}),a.jsx("td",{className:`px-5 ${l?"pb-5":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-5":""}`,children:[t.kode_akun_perkiraan_code," - ",t.kode_akun_perkiraan_name]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Total PengembalianDenda"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-3":""}`,children:["Rp. ",g(k)]})]})]}),a.jsx("p",{className:`text-sm mt-3 ${l?"mt-5":""}`,children:"Keterangan"}),a.jsx("p",{className:"text-sm mb-3",children:l?a.jsx(K,{addClass:"mt-5",name:"keterangan",value:j,onchange:n=>z(n.target.value)}):t.keterangan}),a.jsxs("div",{className:"my-2 flex justify-between",children:[a.jsx("div",{children:l?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"mr-2 btn btn-sm bg-green-900 text-white",onClick:()=>P(),children:[a.jsx(X,{size:12}),"Simpan"]}),a.jsxs("button",{className:"mr-2 btn btn-sm bg-red-500 text-white",onClick:()=>R(),children:[a.jsx(Z,{size:12}),"Hapus"]})]}):a.jsx(a.Fragment,{})}),m?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm border-red-500 text-red-500",onClick:()=>T(n=>n=!n),children:"Tutup Daftar PengembalianDenda"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm bg-white border-gray-400",onClick:()=>T(n=>n=!n),children:"Lihat Daftar PengembalianDenda"})})]}),m?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{width:200,children:"Denda Yang Dikembalikan"})]}),a.jsx("tbody",{children:p.map((n,d)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[d+1,"."]}),a.jsx("td",{children:n.kategori_harga_barang_kode_barang}),a.jsx("td",{children:n.daftar_barang_name}),a.jsx("td",{children:n.satuan_barang_name}),a.jsx("td",{children:n.daftar_gudang_name}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(K,{name:"denda_yang_dikembalikan",type:"text",other:{defaultValue:0},onchange:x=>{W(x),i(x.target.value,n.uuid)},value:g(n.denda_yang_dikembalikan)})}):a.jsxs(a.Fragment,{children:["Rp. ",g(n.denda_yang_dikembalikan)]})})]})}))})]})}),l?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn btn-sm bg-green-900 text-white",onClick:()=>{E()},children:"Simpan"})})}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})})}):a.jsx(a.Fragment,{})]})},Ma=({fakturPembelianBarang:t,setFakturCancel:l=()=>{},setTanggalTransaksiAkhir:c=()=>{}})=>{const[y,_]=s.useState(M()),[B,L]=s.useState({label:"Pelunasan",value:"Pelunasan"}),j=["Pelunasan","Retur","Pengembalian_Denda"],[z,k]=s.useState(),[D,p]=s.useState([]),[C,m]=s.useState([]),[T,N]=s.useState(!0),[w,v]=s.useState([]),E=()=>{N(n=>!1),l(n=>!0),v(n=>j.filter(d=>d!="Pengembalian_Denda").map(d=>({label:d.replace("_"," "),value:d}))),t&&ea.custom("/riwayat_transaksi/"+t.uuid).then(n=>{console.log(n.data),n.data.length>0&&(l(d=>!1),c(d=>n.data[0].tanggal),n.data.filter(d=>d.type=="retur_pembelian_barang").length>0&&v(d=>j.map(x=>({label:x.replace("_"," "),value:x})))),m(d=>Ga(n.data))})},R=async n=>{if(n.preventDefault(),await J(n.target)){let d=na;B.value=="Retur"&&(d=ma),B.value=="Pengembalian_Denda"&&(d=oa);const x={faktur_pembelian_barang:t.uuid,tanggal:y,bukti_transaksi:"EMPTY",kode_akun_perkiraan:z.value,keterangan:"EMPTY"};x[`nomor_${B.value.toLowerCase()}_pembelian_barang`]="EMPTY",d.custom("","POST",null,{data:x}).then(()=>{V("Berhasil","Data Berhasil Disimpan"),E(),_(M())}).catch(e=>$(e))}},i=()=>{_a.custom("/kas_bank","GET").then(n=>{p(d=>n.data),n.data.length>0&&k({label:`${n.data[0].code} - ${n.data[0].name}`,value:n.data[0].uuid})})},P=()=>{_a.custom("/hutang_usaha","GET").then(n=>{const d=[n.data];p(x=>d),d.length>0&&k({label:`${d[0].code} - ${d[0].name}`,value:d[0].uuid})})};return s.useEffect(()=>{N(n=>!0)},[C]),s.useEffect(()=>{if(p(n=>[]),k(n=>null),i(),B.value=="Retur"&&(P(),C.length>0)){const n=C.filter(d=>d.data.filter(x=>x.type=="pelunasan_pembelian_barang").length>0);if(n.length>0){const d=n[0].data.filter(x=>x.type=="pelunasan_pembelian_barang");d.length>0&&na.custom(`/cek_denda_pelunasan_pembelian/${d[0].uuid}`,"GET").then(x=>{x.data==0&&i()}).catch(x=>$(x))}}},[B]),s.useEffect(()=>{E(),i()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white rounded-md mt-4 py-6 px-6 shadow-2xl",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Riwayat Transaksi Pembelian Barang"}),a.jsxs("form",{className:"mb-5 border-[3px] rounded-md py-2 px-3",onSubmit:n=>R(n),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(H,{label:"Tanggal",type:"datetime-local",onchange:n=>{_(n.target.value)},others:{value:y,name:"tanggal"}}),a.jsx(q,{label:"Tipe Transaksi",addClass:"z-50",optionsDataList:w,onchange:n=>{L(n)},optionsLabel:"label",optionsValue:"value",selectName:"tipe_transaksi",selectValue:B}),a.jsx(q,{label:"Kode Akun",optionsDataList:D,optionsLabel:["code","name"],optionsValue:"uuid",addClass:"z-50",optionsLabelIsArray:!0,optionsDelimiter:"-",selectValue:z,onchange:n=>{k(n)},selectName:"kodeAkun"})]}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(sa,{})," Simpan"]})]}),a.jsx("div",{className:"flex flex-col max-h-[60vh] overflow-scroll no-scrollbar relative",children:T?a.jsx(a.Fragment,{children:C.map((n,d)=>a.jsxs("div",{className:"mb-5",children:[a.jsx("p",{className:"font-bold mb-3 sticky top-0 bg-gray-300 p-2 z-20",children:Ta("/",fa(n.parent,!1))}),a.jsx("div",{className:"flex flex-col",children:n.data.map((x,e)=>{var f,u,S;return a.jsxs(a.Fragment,{children:[x.type=="pelunasan_pembelian_barang"?a.jsx(a.Fragment,{children:a.jsx(Oa,{riwayatPelunasanPembelianBarang:x,edited:((f=JSON.parse(x.perintah_stok_opname_nomor_surat_perintah))==null?void 0:f.hasil_stok_opname_count)>0?!1:d==0&&e==0,_getDaftarRiwayatTransaksi:E})}):a.jsx(a.Fragment,{}),x.type=="retur_pembelian_barang"?a.jsx(a.Fragment,{children:a.jsx(Ia,{riwayatReturPembelianBarang:x,edited:((u=JSON.parse(x.perintah_stok_opname_nomor_surat_perintah))==null?void 0:u.hasil_stok_opname_count)>0?!1:d==0&&e==0,_getDaftarRiwayatTransaksi:E})}):a.jsx(a.Fragment,{}),x.type=="pengembalian_denda_pembelian_barang"?a.jsx(a.Fragment,{children:a.jsx(Ya,{riwayatPengembalianDendaPembelianBarang:x,edited:((S=JSON.parse(x.perintah_stok_opname_nomor_surat_perintah))==null?void 0:S.hasil_stok_opname_count)>0?!1:d==0&&e==0,_getDaftarRiwayatTransaksi:E})}):a.jsx(a.Fragment,{})]})})})]}))}):a.jsx(a.Fragment,{children:a.jsx("p",{className:"font-bold",children:"Riwayat Transaksi Belum Ada."})})})]})})},Va=({pesananPembelianBarang:t,setFakturStatus:l=()=>{},fakturStatus:c,ppnStatus:y,setTanggalTransaksiAkhir:_=()=>{}})=>{const[B,L]=s.useState(),[j,z]=s.useState(!0),[k,D]=s.useState([]),[p,C]=s.useState(M()),[m,T]=s.useState(),[N,w]=s.useState(),[v,E]=s.useState(),[R,i]=s.useState(),[P,n]=s.useState(),[d,x]=s.useState(""),e=()=>{Ba.custom("","GET").then(r=>{D(A=>r.data.entry),r.data.entry.length>0&&E(A=>({label:r.data.entry[0].name,value:r.data.entry[0].uuid}))})},f=async r=>{r.preventDefault(),await J(r.target)&&ea.custom("","POST",null,{data:{pesanan_pembelian_barang:t.uuid,tanggal:p,nomor_faktur_pembelian_barang:m,bukti_transaksi:N,tipe_pembayaran:v.value,syarat_pembayaran:R,keterangan:P,nomor_faktur_pajak_pembelian_barang:d||"EMPTY"}}).then(A=>{S()}).catch(A=>$(A))},u=()=>{ea.custom(`/${c}`,"DELETE").then(()=>{l(r=>null)}).catch(r=>$(r))},S=()=>{ea.custom(`/pesanan_pembelian_barang/${t.uuid}`,"GET").then(r=>{r.data?(L(A=>r.data),T(A=>r.data.nomor_faktur_pembelian_barang),w(A=>r.data.bukti_transaksi),C(A=>r.data.tanggal),E(A=>r.data.tipe_pembayaran_name),i(A=>r.data.syarat_pembayaran),n(A=>r.data.keterangan),l(A=>r.data.uuid),x(A=>r.data.nomor_faktur_pajak_pembelian_barang!="EMPTY"?r.data.nomor_faktur_pajak_pembelian_barang:"")):e()}).catch(r=>{l(A=>null)})};return s.useEffect(()=>{c!=null&&S()},[c]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white mt-4 rounded-md py-6 px-6 shadow-2xl",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Faktur Pembelian Barang"}),a.jsxs("form",{onSubmit:r=>f(r),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(H,{label:"Tanggal Faktur Pembelian Barang",type:"datetime-local",onchange:r=>{C(r.target.value)},disabled:c,addClassInput:c?"border-none px-1":"",others:{value:p,name:"tanggalFakturPembelianBarang",disabled:c}}),a.jsx(H,{label:"Nomor Faktur Pembelian Barang",type:"text",onchange:r=>{T(r.target.value)},disabled:c,addClassInput:c?"border-none px-1":"",others:{value:m,name:"nomorFakturPembelianBarang",disabled:c}}),a.jsx(H,{label:"Bukti Transaksi",type:"text",disabled:c,addClassInput:c?"border-none px-1":"",onchange:r=>{w(r.target.value)},others:{value:N,name:"buktiTransaksi",disabled:c}}),c?a.jsx(a.Fragment,{children:a.jsx(H,{label:"Tipe Pembayaran",type:"text",disabled:c,addClassInput:c?"border-none px-1":"",others:{value:v,name:"tipePembayaran",disabled:c}})}):a.jsx(a.Fragment,{children:a.jsx(q,{label:"Tipe Pembayaran",optionsDataList:k,optionsLabel:"name",optionsValue:"uuid",selectValue:v,onchange:r=>{E(r)},selectName:"tipePembayaran"})}),a.jsx(H,{label:"Syarat Pembayaran",type:"text",disabled:c,addClassInput:c?"border-none px-1":"",onchange:r=>{i(r.target.value)},others:{value:R,name:"syaratPembayaran",disabled:c}})]}),a.jsx("div",{className:"flex gap-x-2",children:a.jsx(H,{label:"Keterangan",type:"text",disabled:c,addClassInput:c?"border-none px-1":"",onchange:r=>{n(r.target.value)},others:{value:P,name:"keteranganFakturPembelianBarang",disabled:c}})}),y?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex gap-x-2",children:a.jsx(H,{label:"Nomor Faktur Pajak",type:"text",disabled:c,addClassInput:c?"border-none px-1":"",onchange:r=>{x(r.target.value)},others:{value:d,name:"nomorFakturPajakFakturPembelianBarang",disabled:c}})})}):a.jsx(a.Fragment,{}),c?a.jsx(a.Fragment,{children:j?a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-red-800 mt-4 text-white",type:"button",onClick:()=>u(),children:[a.jsx(Y,{})," Batalkan Faktur"]})}):a.jsx(a.Fragment,{})}):a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(sa,{})," Simpan"]})})]})]}),c?a.jsx(a.Fragment,{children:a.jsx(Ma,{fakturPembelianBarang:B,setFakturCancel:z,setTanggalTransaksiAkhir:_})}):a.jsx(a.Fragment,{})]})},Ja=({setAddPembelianBarang:t=()=>{}})=>{Ra();const[l,c]=s.useState(M()),[y,_]=s.useState(!1),[B,L]=s.useState(!0),[j,z]=s.useState(!1),[k,D]=s.useState(!1),[p,C]=s.useState([]),[m,T]=s.useState(!0),[N,w]=s.useState([]),[v,E]=s.useState([]),[R,i]=s.useState(""),[P,n]=s.useState(M()),[d,x]=s.useState(),[e,f]=s.useState(!1),[u,S]=s.useState(""),[r,A]=s.useState({page:1,size:2,count:118,lastPage:12}),ta=({selected:o})=>{let b=r;b.page=o+1,A(b),F()},la=o=>{let b=r;b.size=o,b.page=1,A(b),F()},[G,h]=s.useState(),F=(o="")=>{o==""&&S(o),$a.custom(`?search=${o}&page=${r.page}&size=${r.size}`,"GET").then(b=>{var U,aa;f(o.length<1),E((U=b==null?void 0:b.data)==null?void 0:U.entry),A((aa=b==null?void 0:b.data)==null?void 0:aa.pagination)}).catch(b=>{$(b)})},I=()=>{ia.custom(`/${G.uuid}`,"DELETE").then(o=>{h(null),pa()}).catch(o=>$(o))},ra=async o=>{o.preventDefault(),await J(o.target)&&ia.custom(m?`/${m.value}`:"",m?"PUT":"POST",null,{data:{nomor_pesanan_pembelian_barang:R,tanggal_pesanan_pembelian_barang:P,supplier:d.uuid}}).then(b=>{if(m){const U=p.filter(aa=>aa.uuid==m.value);h(U[0])}else h(b.data);D(U=>!0)}).catch(b=>{$(b),m&&(Q(),D(U=>!0),h(p.filter(U=>U.uuid==m.value)[0]))})},Q=()=>{x(b=>null),n(b=>M()),i(b=>null);const o=p.filter(b=>b.uuid==m.value);if(o.length>0){const b=v.filter(U=>U.uuid==o[0].supplier);b.length>0&&(x(U=>b[0]),n(o[0].tanggal_pesanan_pembelian_barang),i(o[0].nomor_pesanan_pembelian_barang))}};s.useEffect(()=>{m&&Q()},[m]);const pa=()=>{ia.custom("","GET").then(o=>{C(b=>o.data.entry),o.data.entry.length>0&&T(b=>({label:o.data.entry[0].nomor_pesanan_pembelian_barang,value:o.data.entry[0].uuid}))}).catch(o=>$(o))};return s.useEffect(()=>{j?pa():(i(o=>""),T(o=>!1),n(o=>M()),x(o=>null))},[j]),s.useEffect(()=>{F()},[]),a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-white rounded-md shadow-sm h-max",children:a.jsxs("div",{className:"py-5 px-6 h-max w-full z-10",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-2",children:"Pesanan Pembelian Barang"})}),a.jsxs("form",{onSubmit:o=>ra(o),children:[a.jsxs("div",{className:"flex items-end gap-x-2",children:[a.jsxs("div",{className:"flex items-end gap-x-2 w-full",children:[j&&!G?a.jsx(a.Fragment,{children:a.jsx(q,{label:"Nomor Pesanan Pembelian Barang",optionsDataList:p,optionsLabel:"nomor_pesanan_pembelian_barang",optionsValue:"uuid",selectValue:m,onchange:o=>{T(o)},selectName:"pesananPembelianBarangSelected"})}):a.jsx(a.Fragment,{children:a.jsx(H,{label:"Nomor Pesanan Pembelian Barang",type:"text",disabled:G&&k,addClassInput:G&&k?"border-none px-1":"",onchange:o=>{i(o.target.value)},others:{value:R,name:"nomorPesananPembelianBarang",disabled:G&&k}})}),G?a.jsx(a.Fragment,{children:N.length!=0||y?a.jsx(a.Fragment,{}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:`btn btn-sm ${k?"bg-yellow-400 hover:bg-yellow-400":""}`,onClick:()=>{D(o=>o=!o)},children:[k?a.jsx(Sa,{}):a.jsx(Y,{})," ",k?"Edit":"Batal Edit"," Nomor Pesanan"]}),a.jsxs("button",{type:"button",onClick:()=>I(),className:"btn btn-sm bg-red-700 text-white",children:[a.jsx(Z,{})," Hapus Nomor Pesanan"]})]})}):a.jsx(a.Fragment,{children:a.jsxs("button",{type:"button",className:`btn btn-sm ${j?"bg-red-900":"bg-blue-900"} text-white border-none`,onClick:()=>{z(o=>o=!o)},children:[j?a.jsx(Y,{}):a.jsx(ka,{}),j?"Batal Pesanan Pembelian":"Pilih Pesanan Pembelian"]})})]}),a.jsx(H,{label:"Tanggal Pesanan Pembelian Barang",type:"datetime-local",onchange:o=>{n(o.target.value)},disabled:G,addClassInput:G?"border-none px-1":"",others:{value:P,name:"tanggalPesananPembelianBarang",disabled:G}})]}),d?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"mt-5 relative px-1",children:[a.jsx("p",{className:"font-bold text-sm mb-3",children:"Supplier Terpilih"}),a.jsxs("p",{className:"text-xl font-bold",children:[d.code," - ",d.name]}),a.jsxs("div",{className:"mt-3 flex gap-x-10",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Alamat Rumah"}),a.jsx("p",{className:"text-sm",children:d.alamat_rumah})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Alamat Kantor"}),a.jsx("p",{className:"text-sm",children:d.alamat_kantor})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"NPWP"}),a.jsx("p",{className:"text-sm",children:d.npwp})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Nomor Telepon"}),a.jsx("p",{className:"text-sm",children:d.no_telp})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Nomor Handphone"}),a.jsx("p",{className:"text-sm",children:d.no_hp})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Kode Harga"}),a.jsxs("p",{className:"text-sm",children:["Harga ",d.kode_harga]})]})]}),G?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"absolute top-0 right-3 flex mt-3 py-1 px-2 gap-x-2 items-center font-bold text-xs rounded-md bg-red-800 text-white",onClick:()=>{x(null)},type:"button",children:a.jsx(Y,{})})})]})}):a.jsx(a.Fragment,{}),d?a.jsx(a.Fragment,{children:G&&k?a.jsx(a.Fragment,{children:a.jsxs("button",{type:"button",onClick:()=>{h(o=>null),x(o=>null),z(o=>!1),_(o=>!1)},className:"btn btn-sm bg-red-800 mt-4 text-white",children:[a.jsx(Y,{})," Reset Pesanan Pembelian"]})}):a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(sa,{})," Simpan"]})})}):a.jsx(a.Fragment,{})]}),d?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"mt-5",children:[a.jsxs("div",{className:"flex w-full items-center gap-x-2 mb-5",children:[a.jsx(K,{value:u,onchange:o=>S(o.target.value),other:{placeholder:"Cari Supplier"}}),e?a.jsx(ka,{onClick:()=>{F(u)},className:"cursor-pointer"}):a.jsx(Y,{onClick:()=>F(""),className:"cursor-pointer"})]}),a.jsxs("table",{className:"table table-zebra",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Kode Supplier"}),a.jsx("th",{children:"Nama Supplier"}),a.jsx("th",{children:"Aksi"})]})}),a.jsx("tbody",{children:v==null?void 0:v.map((o,b)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[b+1,"."]}),a.jsx("td",{width:400,children:o.code}),a.jsx("td",{width:400,children:o.name}),a.jsx("td",{children:a.jsxs("button",{className:"flex py-1 px-5 gap-x-2 items-center rounded-xl bg-green-800 text-white",onClick:()=>{x(U=>o)},type:"button",children:[a.jsx(X,{size:12.5}),a.jsx("p",{children:"Pilih"})]})})]},b)}))})]}),a.jsx(za,{paginateUpdatePage:ta,paginate:r,setSize:la,shadow:"",sizeList:[2,4,6]})]})})]})}),G&&k?a.jsxs(a.Fragment,{children:[a.jsx(Ua,{pesananPembelianBarang:G,supplier:d,tanggalPesananPembelianBarang:P,nomorPesananPembelianBarang:R,fakturStatus:y,setPPNStatus:L,tanggalTransaksiAkhir:l,rincianPesananPembelianBarang:N,setRincianPesananPembelianBarang:w}),a.jsx(Va,{pesananPembelianBarang:G,setFakturStatus:_,fakturStatus:y,ppnStatus:B,setTanggalTransaksiAkhir:c})]}):a.jsx(a.Fragment,{})]})},ce=()=>{const[t,l]=s.useState(!1),[c,y]=s.useState(!1);return s.useState(""),s.useState(!0),a.jsx(Da,{isLoading:t,children:a.jsxs("div",{children:[a.jsx(Ca,{title:"Pembelian Barang"}),a.jsx(Ja,{setAddPembelianBarang:y})]})})};export{ce as default};
