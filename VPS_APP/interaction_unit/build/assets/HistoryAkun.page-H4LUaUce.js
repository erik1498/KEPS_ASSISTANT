import{v as T,r as d,j as e,c as E,R,u as D,b as L,o as O,p as H,i as C,w as J,s as $}from"./index-QngEOzN_.js";import{P as B,a as I,A as N,i as K,W as U,F as _}from"./Wrap-BCfnb039.js";import{g as j,p as g}from"./number.helper-_FlTjox4.js";import{B as M}from"./BulanSelectedListCard-CEWU7RwY.js";import{J as V}from"./JurnalStokOpnameUraian-CQ70wmVD.js";import{P as z}from"./PendapatanRowUraian-Cq-Y8o8o.js";import{J as G}from"./JurnalPenyusutanRowUraian-DMCIDR83.js";import{P as W}from"./PageTitle-ByHsc4p5.js";import{P as Y,l as q}from"./PDFHeader-2lYxv13s.js";import{a as Q}from"./jurnalUmum.helper-CDoQQfXi.js";import"./index-BKNjMPK8.js";const X=a=>new Promise((n,l)=>{let t=0,i=0;try{t=j(a.map(s=>s.debet)),i=j(a.map(s=>s.kredit))}catch{t=0,i=0}let u=[],r="00",o=[],h=[];a.map(s=>{s.tanggal!=r&&(r=s.tanggal,u[`${parseInt(r)}`]={total:{kredit:0,debet:0},dataList:a.filter(p=>p.tanggal==r),tanggal:s.tanggal,bulan:s.bulan,tahun:s.tahun,hari:T[new Date(`${s.tahun}-${s.bulan}-${r}`).getDay()]},o=[],h=[]),o.push(s.debet),h.push(s.kredit),u[`${parseInt(r)}`].total={debet:j(o),kredit:j(h)}}),n({totalDebet:t,totalKredit:i,returnData:u})}),Z=({item:a})=>{const[n,l]=d.useState(null);return d.useEffect(()=>{a.detail_data=JSON.parse(JSON.parse(a.uraian).detail),l(t=>a)},[]),e.jsx(e.Fragment,{children:e.jsx(V,{data:n})})},ee=({item:a})=>{const[n,l]=d.useState(null);return d.useEffect(()=>{let{uraian:t,...i}=a;const u=JSON.parse(t),r=Object.keys(u);for(let o=0;o<r.length;o++){const h=r[o];i[h]=u[h]}l(o=>i)},[]),e.jsx(e.Fragment,{children:e.jsx(z,{data:n,showDetail:!0})})},v=({item:a,balanceStatus:n=!0,forPrint:l})=>e.jsxs("div",{className:`flex flex-col w-full bg-white text-[13px] ${l?"":"px-3 shadow-md"}`,children:[e.jsxs("div",{className:"grid grid-cols-12 sticky top-0 bg-white py-2 border-b-2",children:[e.jsxs("div",{className:"p-2 col-span-12 text-black flex items-end",children:[e.jsx("div",{className:"text-[28px] font-bold",children:e.jsx("p",{className:"text-[45px] -ml-1 text-white px-2 rounded-md bg-blue-900",children:a.tanggal})}),e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex items-end",children:[e.jsxs("div",{className:"text-gray-900 flex flex-col justify-end px-2",children:[e.jsxs("h1",{children:[a.bulan,".",a.tahun]}),e.jsx("h2",{className:"text-[13px] font-bold",children:a.hari})]}),n?e.jsxs("div",{className:"flex flex-col px-2 border-l-2 border-gray-600",children:[e.jsx("h1",{className:"font-bold",children:"Total"}),e.jsxs("div",{className:"flex gap-x-4",children:[e.jsx("div",{className:"text-right text-gray-900",children:e.jsx("h1",{className:" text-green-900 font-bold flex flex-row",children:g(a.total.debet)})}),e.jsx("div",{className:"text-right text-gray-900",children:e.jsx("h1",{className:" text-red-900 font-bold",children:g(a.total.kredit)})})]})]}):e.jsx(e.Fragment,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-12 col-span-12 items-end pt-1 font-bold",children:[e.jsx("div",{className:"col-span-1 text-gray-900 flex flex-col px-2",children:e.jsx("p",{children:"Waktu"})}),e.jsx("div",{className:"col-span-3 text-gray-900 flex flex-col px-2",children:e.jsx("p",{children:"Uraian"})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:e.jsx("h1",{children:"Debet"})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:e.jsx("h1",{children:"Kredit"})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:e.jsx("h1",{children:"Saldo Debet"})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:e.jsx("h1",{children:"Saldo Kredit"})})]})]}),a.dataList.map((t,i)=>e.jsx(e.Fragment,{children:t.debet=="0.00"&&t.kredit=="0.00"?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:[i>0?e.jsx("hr",{}):e.jsx(e.Fragment,{}),i<=a.dataList.length?e.jsxs("div",{className:"grid grid-cols-12 items-start py-1",children:[e.jsx("div",{className:"col-span-1 px-2 text-black",children:E(t.waktu)}),e.jsx("div",{className:"col-span-3 text-gray-900 flex flex-col px-2",children:B.includes(t.sumber)?e.jsx(Z,{item:t}):e.jsx(e.Fragment,{children:I.includes(t.sumber)?e.jsx(ee,{item:t}):e.jsx(e.Fragment,{children:N.includes(t.sumber)?e.jsx(G,{data:t,bg_color:l}):e.jsx("p",{children:t.uraian})})})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:parseFloat(t.debet).toFixed(2)!="0.00"?e.jsx("h1",{className:" text-green-900 font-bold",children:g(parseFloat(t.debet).toFixed(2))}):e.jsx(e.Fragment,{})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:parseFloat(t.kredit).toFixed(2)!="0.00"?e.jsx("h1",{className:" text-red-900 font-bold",children:g(parseFloat(t.kredit).toFixed(2))}):e.jsx(e.Fragment,{})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:e.jsx("h1",{className:" text-green-900 font-bold",children:g(parseFloat(t.saldoDebet).toFixed(2))})}),e.jsx("div",{className:"text-right px-2 col-span-2 text-gray-900",children:e.jsx("h1",{className:" text-red-900 font-bold",children:g(parseFloat(t.saldoKredit).toFixed(2))})})]}):e.jsx(e.Fragment,{})]})}))]}),ae=R.forwardRef((a,n)=>e.jsxs("div",{ref:n,children:[e.jsx(Y,{bulan:a.bulan,tahun:a.tahun,title:"History Akun"}),e.jsx("h1",{className:"text-4xl font-bold mt-5",children:a.kode_akun_perkiraan}),a.data.map((l,t)=>e.jsx(v,{item:l,balanceStatus:a.balanceStatus,forPrint:!0},t))]})),he=()=>{const a=D(),{data:n}=a,[l,t]=d.useState(new Date().getMonth()),[i,u]=d.useState(""),[r,o]=d.useState(!0),[h,s]=d.useState([]),[p,S]=d.useState(K()),k=d.useRef(),F=q.useReactToPrint({content:()=>k.current}),[A,y]=d.useState(!1),f=(c="")=>{c==""&&u(c),y(!0),J.custom(`/${p.value}/${l+1}/${n.tahun}?search=${c}`,"GET").then(async x=>{let P=x==null?void 0:x.data.filter(m=>!N.includes(m.sumber)),b=x==null?void 0:x.data.filter(m=>N.includes(m.sumber)).map(m=>(m.detail_data=JSON.stringify(JSON.parse(m.uraian).detail),m));b=Q(b);let w=await X(P.concat(...b));o(c.length<1),s(w.returnData),y(!1)}).catch(x=>{$(x)})};return d.useEffect(()=>{p.value!=""&&f()},[l,p]),e.jsx(e.Fragment,{children:e.jsx(U,{isLoading:A,children:e.jsxs("div",{children:[e.jsx(W,{title:"History Akun"}),e.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[e.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[e.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:i,onChange:c=>u(c.target.value)}),r?e.jsx(O,{className:"cursor-pointer",onClick:()=>f(i)}):e.jsx(L,{className:"cursor-pointer",onClick:()=>{f("")}})]}),e.jsx("div",{className:"w-[400px]",children:e.jsx(_,{optionsDataList:n.kodeAkun,optionsLabel:["code","name"],optionsValue:"uuid",optionsLabelIsArray:!0,optionsDelimiter:"-",selectValue:p,onchange:c=>S(c),selectName:"kodeAkun",addClass:"w-full"})})]}),e.jsxs("div",{className:"grid grid-cols-6",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx(M,{bulan:l,setBulan:t}),e.jsx("div",{className:"hidden",children:e.jsx(ae,{data:h,balanceStatus:r,ref:k,tahun:n.tahun,bulan:H(l),kode_akun_perkiraan:p.label})}),e.jsxs("button",{onClick:F,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[e.jsx(C,{})," Cetak History Akun"]})]}),e.jsx("div",{className:"col-span-5",children:e.jsx("div",{className:"h-[65vh] pl-2",children:e.jsx("div",{className:"flex flex-col h-full overflow-y-scroll no-scrollbar w-full rounded-md",children:h.map((c,x)=>e.jsx(v,{item:c,balanceStatus:r,forPrint:!1},x))})})})]})]})})})};export{he as default};
