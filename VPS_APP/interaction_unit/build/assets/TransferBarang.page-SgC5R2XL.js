import{r,j as a,e as D,p as O,m as G,au as L,t as k,a7 as U,d as z,Q as P,o as V,av as S,v as F,aw as I,as as A,R as W,w as H,W as J,x as M,y as Q,l as Y,z as q,n as X,b as Z,F as E,D as aa}from"./index-LsUVTe0U.js";import{P as ea}from"./Pagination-CnmIkkz2.js";import{F as R}from"./FormInputWithLabel-B0kiouSN.js";import{i as sa}from"./actionEvent.helper-DOiG12jO.js";import{P as ta,l as na}from"./PDFHeader-BfVRhq22.js";import"./react-paginate-U0y7n0sC.js";import"./index-BKNjMPK8.js";const B=({transferBarang:i,preview:e})=>{const[n,o]=r.useState([]),m=()=>{L.custom(`/by_transfer_barang/${i.uuid}`).then(s=>{o(c=>s.data)}).catch(s=>k(s))},p=(s,c)=>{let h=n;h=h.map(u=>(u.stok_awal_barang==c&&(u.jumlah=s),u)),o(u=>h)},g=s=>{n[s].stok_awal_barang_tujuan?L.custom(n[s].uuid?`/${n[s].uuid}`:"",n[s].uuid?"PUT":"POST",null,{data:{transfer_barang:i.uuid,stok_awal_barang:n[s].stok_awal_barang,jumlah:n[s].jumlah,stok_awal_barang_tujuan:n[s].stok_awal_barang_tujuan}}).then(()=>{s<n.length&&g(s+1)}).catch(c=>k(c)):g(s+1)};return r.useEffect(()=>{m()},[i]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"my-5 bg-white py-5 rounded-md",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Daftar Barang"}),a.jsx("div",{className:"overflow-x-auto max-h-[40vh] h-max no-scrollbar pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 z-50 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Barang"}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{width:150,children:"Jumlah"})]})}),a.jsx("tbody",{children:n==null?void 0:n.map((s,c)=>s.stok_awal_barang_tujuan&&a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[c+1,"."]}),a.jsx("td",{children:s.daftar_barang_nama_barang}),a.jsx("td",{children:s.kategori_harga_barang_kode_barang}),a.jsx("td",{children:s.satuan_barang}),a.jsx("td",{children:e?a.jsx(a.Fragment,{children:s.jumlah}):a.jsx(a.Fragment,{children:a.jsx(D,{name:"jumlah",type:"text",other:{defaultValue:s.jumlah},onchange:h=>{sa(h),p(h.target.value,s.stok_awal_barang)},value:O(s.jumlah)})})})]},c)}))})]})}),e?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-3 text-white",onClick:()=>{g(0)},children:[a.jsx(G,{})," Simpan"]})})]})})},la=({setAddTransferBarangEvent:i=()=>{},transferBarangEdit:e,getData:n=()=>{}})=>{const[o,m]=r.useState(e!=null&&e.tanggal?e.tanggal:U()),[p,g]=r.useState(e!=null&&e.kode_transfer_barang?e.kode_transfer_barang:""),[s,c]=r.useState(e!=null&&e.daftar_gudang_asal?e.daftar_gudang_asal:""),[h,u]=r.useState(e!=null&&e.daftar_gudang_akhir?e.daftar_gudang_akhir:""),[N,w]=r.useState([]),[_,y]=r.useState([]),[x,b]=r.useState(),T=async()=>{await V()&&S.custom(`${e!=null&&e.uuid?`/${e.uuid}`:""}`,e?"PUT":"POST",null,{data:{tanggal:o,kode_transfer_barang:p,daftar_gudang_asal:s.value,daftar_gudang_akhir:h.value}}).then(t=>{e?(b(f=>e),F("Berhasil","Data berhasil diupdate")):(b(f=>t.data),F("Berhasil","Data berhasil disimpan"))}).catch(t=>{k(t)})};r.useEffect(()=>{const t=N.filter(f=>f.uuid!=s.value);y(t),t.length>0&&u({label:t[0].name,value:t[0].uuid})},[s]);const j=()=>{I.custom("","GET").then(t=>{if(w(f=>t.data.entry),t.data.entry.length>0){if(e){A({editObject:e.daftar_gudang_asal,dataList:t.data.entry,setState:c,labelKey:"name",valueKey:"uuid"}),A({editObject:e.daftar_gudang_akhir,dataList:t.data.entry,setState:u,labelKey:"name",valueKey:"uuid"});return}c({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}})};return r.useEffect(()=>{j()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[e?"Edit":"Tambahkan"," Transfer Barang"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>{n(),i()},children:[a.jsx(z,{})," Batalkan Transfer Barang"]})]}),a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(R,{label:"Tanggal Transfer Barang",type:"datetime-local",onchange:t=>{m(t.target.value)},others:{value:o,disabled:x,tanggal:"tanggalTransferBarang"}}),a.jsx(R,{label:"Kode Transfer Barang",type:"text",onchange:t=>{g(t.target.value)},others:{value:p,disabled:x,tanggal:"kodeTransferBarang"}}),a.jsx(P,{label:"Gudang Asal",optionsDataList:_,optionsLabel:"name",optionsValue:"uuid",selectValue:s,disabled:x,onchange:t=>{c(t)},selectName:"gudangAsalTransferBarang"}),a.jsx(P,{label:"Gudang Akhir",optionsDataList:_,optionsLabel:"name",optionsValue:"uuid",selectValue:h,disabled:x,onchange:t=>{u(t)},selectName:"gudangAkhirTransferBarang"})]}),x?a.jsx(a.Fragment,{children:a.jsx(B,{transferBarang:x})}):a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",onClick:()=>{T()},children:[a.jsx(G,{})," Simpan"]})}),e&&!x?a.jsx(a.Fragment,{children:a.jsx(B,{transferBarang:e,preview:!0})}):a.jsx(a.Fragment,{})]})})},ra=W.forwardRef((i,e)=>{var n;return a.jsxs("div",{ref:e,children:[a.jsx(ta,{bulan:i.bulan,tahun:i.tahun,title:"Transfer Barang"}),a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Transfer Barang"})]})}),a.jsx("tbody",{children:(n=i==null?void 0:i.data)==null?void 0:n.map((o,m)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:m+1}),a.jsx("td",{children:o.name})]},m)}))})]})]})}),xa=()=>{const i=H(),{data:e}=i,[n,o]=r.useState([]),[m,p]=r.useState(!1),[g,s]=r.useState(!1),[c,h]=r.useState({name:""}),[u,N]=r.useState(!1),[w,_]=r.useState(""),y=r.useRef(),x=na.useReactToPrint({content:()=>y.current}),[b,T]=r.useState({page:1,size:10,count:118,lastPage:12}),j=(d="")=>{d==""&&_(d),p(!0),S.custom(`?search=${d}&page=${b.page}&size=${b.size}&tahun=${e.tahun}`,"GET").then(l=>{var v,C;N(d.length<1),o((v=l==null?void 0:l.data)==null?void 0:v.entry),T((C=l==null?void 0:l.data)==null?void 0:C.pagination),p(!1)}).catch(l=>{k(l)})},t=d=>{let l=n[d];h(l),s(!g)},f=async d=>{if(await aa("Hapus","Yakin ingin hapus data ini ?")){let l=n[d];S.custom(`/${l.uuid}`,"DELETE").then(()=>{F("Berhasil","Data berhasil dihapus"),j()}).catch(v=>{k(v)})}},$=({selected:d})=>{let l=b;l.page=d+1,T(l),j()},K=d=>{let l=b;l.size=d,l.page=1,T(l),j()};return r.useEffect(()=>{j()},[]),a.jsx(J,{isLoading:m,children:a.jsxs("div",{children:[a.jsx(M,{title:"Transfer Barang"}),g?a.jsx(la,{setAddTransferBarangEvent:()=>s(!1),getData:j,transferBarangEdit:c}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:w,onChange:d=>_(d.target.value)}),u?a.jsx(Q,{onClick:()=>{j(w)},className:"cursor-pointer"}):a.jsx(z,{onClick:()=>j(""),className:"cursor-pointer"})]}),a.jsxs("div",{className:"flex gap-x-2 items-center",children:[a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{h(null),s(!g)},children:[a.jsx(Y,{})," Tambah Transfer Barang"]}),a.jsx("div",{className:"hidden",children:a.jsx(ra,{data:n,ref:y,bulan:q(new Date().getMonth()),tahun:e.tahun})}),a.jsxs("button",{onClick:x,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[a.jsx(X,{})," Cetak Transfer Barang"]})]})]}),a.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Tanggal"}),a.jsx("th",{children:"Kode"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Gudang Akhir"}),a.jsx("th",{children:"Aksi"})]})}),a.jsx("tbody",{children:n==null?void 0:n.map((d,l)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[l+1,"."]}),a.jsx("td",{children:d.tanggal}),a.jsx("td",{children:d.kode_transfer_barang}),a.jsx("td",{children:d.daftar_gudang_asal_name}),a.jsx("td",{children:d.daftar_gudang_akhir_name}),a.jsxs("td",{className:"flex gap-x-2",children:[a.jsx(Z,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{t(l)}}),a.jsx(E,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{f(l)}})]})]},l)}))})]})}),a.jsx(ea,{paginateUpdatePage:$,paginate:b,setSize:K})]})]})})};export{xa as default};
