import{r as u,O as q,j as a,h as $,F as z,k as U,aG as R,s as x,ax as Q,aH as X,aI as T,b as Y,aJ as G,n as J,aK as Z,aL as E,aM as aa,R as ea,u as ta,o as na,e as sa,p as la,i as ua,a as ia,q as ra}from"./index-BFtBgOrg.js";import{P as ha}from"./PageTitle-Hc-YSVDI.js";import{h as P,g as K,f as V,W as oa}from"./Wrap-Dk-wg8kL.js";import{P as ca}from"./Pagination-CNke5GoU.js";import{F as A}from"./FormInputWithLabel-zEsdZ3IQ.js";import{F}from"./FormSelectWithLabel-BuQTQxHx.js";import{i as I}from"./actionEvent.helper-BujKUZ7B.js";import{p as W}from"./number.helper-efe0YCx6.js";import{F as M}from"./FormInput-DctP6iug.js";import{P as da,l as ba}from"./PDFHeader-BGA35-Z9.js";import"./react-paginate-C1eAq6Tf.js";import"./index-BKNjMPK8.js";const xa=({idDaftarBahanBaku:c,kategoriHargaBahanBakuList:t})=>{const[d,o]=u.useState(),[g,v]=u.useState(t.length>0?{label:t[0].kode_bahan_baku,value:t[0].uuid}:null),[j,_]=u.useState(0),[B,S]=u.useState(q()),[w,f]=u.useState([]),[N,y]=u.useState([]),D=async l=>{l.preventDefault(),await U(l.target)&&R.custom("","POST",null,{data:{daftar_bahan_baku:c,daftar_gudang:d.value,kategori_harga_bahan_baku:g.value,jumlah:`${j}`,tanggal:`${B}`}}).then(()=>{b()}).catch(m=>{x(m)})},p=()=>{Q.custom("","GET").then(l=>{f(l.data.entry),l.data.entry.length>0&&o({label:l.data.entry[0].name,value:l.data.entry[0].uuid})}).catch(l=>{x(l)})},b=()=>{R.custom(`/${c}`,"GET").then(l=>{y(l.data)}).catch(l=>{x(l)})},k=l=>{R.custom(`/${l.uuid}`,"DELETE").catch(m=>{x(m)}).finally(()=>b())};return u.useEffect(()=>{p(),b()},[]),a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"mt-16 mb-5 uppercase text-gray-600 font-bold",children:"Stok Awal Bahan Baku"}),a.jsx("form",{onSubmit:l=>D(l),className:"pb-6",children:a.jsxs("div",{className:"flex gap-x-2 items-end",children:[a.jsx(F,{label:"Gudang Bahan Baku",optionsDataList:w,optionsLabel:"name",optionsValue:"uuid",selectValue:d,onchange:l=>{o(l)},selectName:"gudangBahanBaku"}),a.jsx(F,{label:"Kode Bahan Baku",optionsDataList:t,optionsLabel:"kode_bahan_baku",optionsValue:"uuid",selectValue:g,onchange:l=>{v(l)},selectName:"kategoriHargaBahanBaku"}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx($,{})," Simpan"]})]})}),a.jsxs("table",{className:"table table-sm table-zebra",children:[a.jsxs("thead",{className:"py-4 text-black",children:[a.jsx("th",{children:"No"}),a.jsx("th",{children:"Daftar Gudang Name"}),a.jsx("th",{children:"Kode Bahan Baku"}),a.jsx("th",{children:"Satuan"}),a.jsx("th",{children:"Aksi"})]}),a.jsx("tbody",{children:N.map((l,m)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:m+1}),a.jsx("td",{children:l.daftar_gudang_name}),a.jsx("td",{children:l.kategori_harga_bahan_baku_kode_bahan_baku}),a.jsx("td",{children:l.satuan_bahan_baku_name}),a.jsx("td",{width:100,children:a.jsx("div",{className:"flex gap-x-2",children:a.jsx(z,{onClick:()=>k(l),className:"text-red-500 cursor-pointer",size:12})})})]})}))})]})]})},ga=({idDaftarBahanBaku:c})=>{const[t,d]=u.useState(!1),[o,g]=u.useState([]),[v,j]=u.useState([]),[_,B]=u.useState(),[S,w]=u.useState(),[f,N]=u.useState([]),y=()=>{B(e=>null),j(e=>[]),d(e=>!1),X.custom("","GET").then(e=>{j(e.data.entry),d(h=>!0),B({label:e.data.entry[0].name,value:e.data.entry[0].uuid})}).catch(e=>{x(e)})},D=async e=>{if(e.preventDefault(),await U(e.target)){let h={daftar_bahan_baku:c,satuan_bahan_baku:_.value,kode_bahan_baku:S};P.map((r,s)=>{h[`harga_${r.value}`]=f[s]}),T.custom("","POST",null,{data:h}).then(()=>{p()}).catch(r=>{x(r)})}},p=()=>{T.custom(`/${c}`,"GET").then(e=>{g(h=>e.data.entry)}).catch(e=>{x(e)})},b=e=>{let h={daftar_bahan_baku:e.daftar_bahan_baku,satuan_bahan_baku:e.satuan_bahan_baku,kode_bahan_baku:e.kode_bahan_baku};P.map((r,s)=>{h[`harga_${r.value}`]=`${e[`harga_${r.value}`]}`}),T.custom(`/${e.uuid}`,"PUT",null,{data:h}).catch(r=>{x(r)}).finally(()=>p())},k=e=>{let h={daftar_bahan_baku:e.daftar_bahan_baku,satuan_bahan_baku:e.satuan_bahan_baku,kode_bahan_baku:e.kode_bahan_baku};P.map((r,s)=>{h[`harga_${r.value}`]=`${e[`harga_${s+1}`]}`}),T.custom(`/${e.uuid}`,"DELETE").catch(r=>{x(r)}).finally(()=>p())},l=(e,h,r)=>{const s=o.findIndex(i=>i.uuid==r);if(s!=-1){let i=o;i.at(s)[`harga_${h}`]=W(e),g(L=>i)}},m=(e,h)=>{const r=o.findIndex(s=>s.uuid==h);if(r!=-1){let s=o;s.at(r).kode_bahan_baku=e,g(i=>s)}};return u.useEffect(()=>{y()},[o]),u.useEffect(()=>{p()},[]),a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"mt-16 mb-5 uppercase text-gray-600 font-bold",children:"Kategori Harga"}),t?a.jsxs("form",{onSubmit:e=>D(e),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(F,{label:"Satuan Bahan Baku",optionsDataList:v,optionsLabel:"name",optionsValue:"uuid",selectValue:_,onchange:e=>{B(e)},selectName:"satuanBahanBaku"}),a.jsx(A,{label:"Kode Bahan Baku",type:"text",onchange:e=>{w(e.target.value)},others:{value:S,name:"kodeBahanBaku"}})]}),a.jsx("div",{className:"mt-5 flex gap-x-2",children:P.map((e,h)=>a.jsx(a.Fragment,{children:a.jsx(A,{label:e.label,type:"text",onchange:r=>{I(r);const s=[...f];s[h]=r.target.value,N(i=>s)},others:{value:f[h],name:`hargaBahanBaku[${h}]`}})}))}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx($,{})," Simpan"]})]}):a.jsx(a.Fragment,{}),a.jsxs("table",{className:"mt-5 table table-sm table-zebra",children:[a.jsxs("thead",{className:"py-4 text-black",children:[a.jsx("th",{children:"No"}),a.jsx("th",{children:"Satuan Bahan Baku"}),a.jsx("th",{children:"Kode Bahan Baku"}),P.map(e=>a.jsx("th",{children:e.label})),a.jsx("th",{children:"Aksi"})]}),a.jsx("tbody",{children:o.map((e,h)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:h+1}),a.jsx("td",{children:e.satuan_bahan_baku_name}),a.jsx("td",{children:a.jsx(M,{name:"kode_bahan_baku"+h,type:"text",other:{defaultValue:e.kode_bahan_baku},onchange:r=>{m(r.target.value,e.uuid)}})}),P.map(r=>a.jsx("td",{width:150,children:a.jsx(M,{name:"harga_"+r.value,type:"text",other:{defaultValue:W(e[`harga_${r.value}`])},onchange:s=>{I(s),l(s.target.value,r.value,e.uuid)}})})),a.jsx("td",{width:100,children:a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx($,{onClick:()=>b(e),className:"text-green-800 cursor-pointer",size:12}),a.jsx(z,{onClick:()=>k(e),className:"text-red-500 cursor-pointer",size:12})]})})]})}))})]}),a.jsx(xa,{idDaftarBahanBaku:c,kategoriHargaBahanBakuList:o})]})},ma=({setAddDaftarBahanBakuEvent:c=()=>{},daftarBahanBakuEdit:t,getData:d=()=>{}})=>{const[o,g]=u.useState(!1),[v,j]=u.useState(t!=null&&t.uuid?t.uuid:null),[_,B]=u.useState([]),[S,w]=u.useState([]),[f,N]=u.useState([]),[y,D]=u.useState(t!=null&&t.name?t.name:""),[p,b]=u.useState(t!=null&&t.kategori_bahan_baku?t.kategori_bahan_baku:""),[k,l]=u.useState(t!=null&&t.jenis_bahan_baku?t.jenis_bahan_baku:""),[m,e]=u.useState(t!=null&&t.jenis_penjualan_bahan_baku?t.jenis_penjualan_bahan_baku:""),[h,r]=u.useState((t==null?void 0:t.ppn)==0?{label:K.filter(n=>n.value==t.ppn).at(0).label,value:K.filter(n=>n.value==t.ppn).at(0).value}:{label:K[0].label,value:K[0].value}),s=async n=>{n.preventDefault(),await U(n.target)&&G.custom(`${t!=null&&t.uuid?`/${t.uuid}`:""}`,t?"PUT":"POST",null,{data:{name:y,kategori_bahan_baku:p.value,jenis_bahan_baku:k.value,jenis_penjualan_bahan_baku:m.value,ppn:h.value,status:1}}).then(H=>{t?J("Berhasil","Data berhasil diupdate"):(j(O=>H.data.uuid),J("Berhasil","Data berhasil disimpan")),g(O=>!0)}).catch(H=>{x(H),j(t.uuid),g(O=>!0)})},i=()=>{Z.custom("","GET").then(n=>{if(B(n.data.entry),n.data.entry.length>0){if(t){V({editObject:t.kategori_bahan_baku,dataList:n.data.entry,setState:b,labelKey:"name",valueKey:"uuid"});return}b({label:n.data.entry[0].name,value:n.data.entry[0].uuid})}}).catch(n=>{x(n)})},L=()=>{E.custom("","GET").then(n=>{if(w(n.data.entry),n.data.entry.length>0){if(t){V({editObject:t.jenis_bahan_baku,dataList:n.data.entry,setState:l,labelKey:"name",valueKey:"uuid"});return}l({label:n.data.entry[0].name,value:n.data.entry[0].uuid})}}).catch(n=>{x(n)})},C=()=>{aa.custom("","GET").then(n=>{if(N(n.data.entry),n.data.entry.length>0){if(t){V({editObject:t.jenis_penjualan_bahan_baku,dataList:n.data.entry,setState:e,labelKey:"name",valueKey:"uuid"});return}e({label:n.data.entry[0].name,value:n.data.entry[0].uuid})}}).catch(n=>{x(n)})};return u.useEffect(()=>{i(),L(),C()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[t?"Edit":"Tambahkan"," Daftar Bahan Baku"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>c(),children:[a.jsx(Y,{})," Batalkan Daftar Bahan Baku"]})]}),a.jsxs("form",{onSubmit:n=>s(n),children:[a.jsx("div",{className:"flex gap-x-2",children:a.jsx(A,{label:"Nama Daftar Bahan Baku",type:"text",onchange:n=>{D(n.target.value)},others:{value:y,name:"namaDaftarBahanBaku",disabled:o}})}),a.jsxs("div",{className:"mt-5 flex gap-x-2",children:[a.jsx(F,{label:"Kategori Bahan Baku",optionsDataList:_,optionsLabel:"name",optionsValue:"uuid",disabled:o,selectValue:p,onchange:n=>{b(n)},selectName:"kategoriDaftarBahanBaku"}),a.jsx(F,{label:"Jenis Bahan Baku",optionsDataList:S,optionsLabel:"name",optionsValue:"uuid",disabled:o,selectValue:k,onchange:n=>{l(n)},selectName:"JenisDaftarBahanBaku"}),a.jsx(F,{label:"Jenis Penjualan Bahan Baku",optionsDataList:f,optionsLabel:"name",optionsValue:"uuid",disabled:o,selectValue:m,onchange:n=>{e(n)},selectName:"jenisPenjualanDaftarBahanBaku"})]}),a.jsx("div",{className:"mt-5 flex -gap-x-2",children:a.jsx(F,{label:"PPN",optionsDataList:K,optionsLabel:"label",optionsValue:"value",disabled:o,selectValue:h,onchange:n=>{r(n)},selectName:"ppnDaftarBahanBaku"})}),o?a.jsx(a.Fragment,{}):a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx($,{})," Simpan"]})]}),o?a.jsx(ga,{idDaftarBahanBaku:v}):a.jsx(a.Fragment,{})]})})},ja=ea.forwardRef((c,t)=>{var d;return a.jsxs("div",{ref:t,children:[a.jsx(da,{bulan:c.bulan,tahun:c.tahun,title:"Daftar Bahan Baku"}),a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Daftar Bahan Baku"}),a.jsx("th",{children:"Kode Daftar Bahan Baku"})]})}),a.jsx("tbody",{children:(d=c==null?void 0:c.data)==null?void 0:d.map((o,g)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:g+1}),a.jsx("td",{children:o.name}),a.jsx("td",{children:o.code})]},g)}))})]})]})}),Fa=()=>{const c=ta(),{data:t}=c,[d,o]=u.useState([]),[g,v]=u.useState(!1),[j,_]=u.useState(!1),[B,S]=u.useState({name:""}),[w,f]=u.useState(!1),[N,y]=u.useState(""),D=u.useRef(),p=ba.useReactToPrint({content:()=>D.current}),[b,k]=u.useState({page:1,size:10,count:118,lastPage:12}),l=(s="")=>{s==""&&y(s),v(!0),G.custom(`?search=${s}&page=${b.page}&size=${b.size}`,"GET").then(i=>{var L,C;f(s.length<1),o((L=i==null?void 0:i.data)==null?void 0:L.entry),k((C=i==null?void 0:i.data)==null?void 0:C.pagination),v(!1)}).catch(i=>{x(i)})},m=s=>{let i=d[s];S(i),_(!j)},e=async s=>{if(await ra("Hapus","Yakin ingin hapus data ini ?")){let i=d[s];G.custom(`/${i.uuid}`,"DELETE").then(()=>{J("Berhasil","Data berhasil dihapus"),l()}).catch(L=>{x(L)})}},h=({selected:s})=>{let i=b;i.page=s+1,k(i),l()},r=s=>{let i=b;i.size=s,i.page=1,k(i),l()};return u.useEffect(()=>{l()},[]),a.jsx(oa,{isLoading:g,children:a.jsxs("div",{children:[a.jsx(ha,{title:"Daftar Bahan Baku"}),j?a.jsx(ma,{setAddDaftarBahanBakuEvent:()=>_(!1),getData:l,daftarBahanBakuEdit:B}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:N,onChange:s=>y(s.target.value)}),w?a.jsx(na,{onClick:()=>{l(N)},className:"cursor-pointer"}):a.jsx(Y,{onClick:()=>l(""),className:"cursor-pointer"})]}),a.jsxs("div",{className:"flex gap-x-2 items-center",children:[a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{S(null),_(!j)},children:[a.jsx(sa,{})," Tambah Daftar Bahan Baku"]}),a.jsx("div",{className:"hidden",children:a.jsx(ja,{data:d,ref:D,bulan:la(new Date().getMonth()),tahun:t.tahun})}),a.jsxs("button",{onClick:p,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[a.jsx(ua,{})," Cetak Daftar Bahan Baku"]})]})]}),a.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Daftar Bahan Baku"}),a.jsx("th",{children:"Kategori Bahan Baku"}),a.jsx("th",{children:"Jenis Bahan Baku"}),a.jsx("th",{children:"Jenis Penjualan Bahan Baku"}),a.jsx("th",{children:"PPN"}),a.jsx("th",{children:"Aksi"})]})}),a.jsx("tbody",{children:d==null?void 0:d.map((s,i)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[i+1,"."]}),a.jsx("td",{children:s.name}),a.jsx("td",{children:s.kategori_bahan_baku_name}),a.jsx("td",{children:s.jenis_bahan_baku_name}),a.jsx("td",{children:s.jenis_penjualan_bahan_baku_name}),a.jsx("td",{children:s.ppn==1?"Ya":"Tidak"}),a.jsxs("td",{className:"flex gap-x-2",children:[a.jsx(ia,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{m(i)}}),a.jsx(z,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{e(i)}})]})]},i)}))})]})}),a.jsx(ca,{paginateUpdatePage:h,paginate:b,setSize:r})]})]})})};export{Fa as default};
