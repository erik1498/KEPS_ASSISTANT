import{j as a,p as v,r as l,i as M,a as B,e as U,h as aa,F as ea,k as sa,l as z,m as P,o as q,aZ as I,t as T,U as O,a_ as _,a7 as ta,d as Y,Q as V,a$ as R,w as la,W as na,x as ia,y as ra,D as G,v as W,C as ca}from"./index-pVJ0F13P.js";import{B as da}from"./BulanSelectedListCard-BEWZa7bG.js";import{D as oa}from"./DebetKreditStatusCard-OY-OpCFR.js";import{K as ua}from"./KasRowData-eGhtlXOc.js";import{F as H}from"./FormInputWithLabel-Bj7wavFM.js";import{i as J}from"./actionEvent.helper-CqtMElox.js";import{C as xa}from"./CheckListBox-SpFXVJ6j.js";const ha=({item:i,deleteItem:r=()=>{},editItem:y=()=>{},deleteByBuktiTransaksi:p=()=>{},balanceStatus:o=!0,forPrint:u=!1})=>a.jsxs("div",{className:`flex flex-col w-full bg-white text-[13px] px-3 ${u?"":"shadow-md"}`,children:[a.jsx("div",{className:"grid grid-cols-12 sticky top-0 bg-white py-2 border-b-2",children:a.jsxs("div",{className:"p-2 col-span-9 text-black flex items-end",children:[a.jsx("div",{className:"text-[28px] font-bold",children:o?a.jsx("p",{className:`text-[45px] -ml-1 text-white px-2 rounded-md ${i.total.debet==i.total.kredit?"bg-green-900":"bg-red-900"}`,children:parseFloat(i.tanggal)<10?`0${i.tanggal}`:i.tanggal}):a.jsx("p",{className:"text-[45px] -ml-1 text-white px-2 rounded-md bg-green-900",children:parseFloat(i.tanggal)<10?`0${i.tanggal}`:i.tanggal})}),a.jsx("div",{className:"flex flex-col",children:a.jsxs("div",{className:"flex items-end",children:[a.jsxs("div",{className:"text-gray-900 flex flex-col justify-end px-2",children:[a.jsxs("h1",{children:[i.bulan,".",i.tahun]}),a.jsx("h2",{className:"text-[13px] font-bold",children:i.hari})]}),a.jsxs("div",{className:"flex flex-col px-2 border-l-2 border-gray-600",children:[a.jsx("h1",{className:"font-bold",children:"Total"}),a.jsxs("div",{className:"flex gap-x-4",children:[a.jsx("div",{className:"text-right",children:a.jsx("h1",{className:" text-green-900 font-bold flex flex-row",children:v(i.total.debet)})}),a.jsx("div",{className:"text-right",children:a.jsx("h1",{className:" text-red-900 font-bold",children:v(i.total.kredit)})})]})]})]})})]})}),i.buktiTransaksi.map(g=>a.jsx(a.Fragment,{children:a.jsx(ua,{deleteByBuktiTransaksi:p,deleteItem:r,editItem:y,forPrint:u,item1:g,balanceStatus:o})}))]}),ma=({idTransaksiKas:i,nilaiTransaksi:r=0,getData:y=()=>{},type:p=1})=>{const[o,u]=l.useState(!1),[g,x]=l.useState({totalDebet:p==1?r:0,totalKredit:p==0?r:0}),[f,D]=l.useState([]),[k,j]=l.useState([]),[n,b]=l.useState([{waktu:`${new Date().getHours()<10?"0"+new Date().getHours():new Date().getHours()}:${new Date().getMinutes()<10?"0"+new Date().getMinutes():new Date().getMinutes()}:${new Date().getSeconds()<10?"0"+new Date().getSeconds():new Date().getSeconds()}`,kodeAkun:M(),uraian:"",nilai:"0"}]),A=t=>{let e=[...n],s=[...k];e[t].uuid&&s.push(e[t]),j(c=>s),b(c=>[]),e.splice(t,1),b(e)},C=async()=>{await q()&&(w(0),S(0))},S=async t=>{k[t]?(u(e=>!0),I.custom(`/${k[t].uuid}`,"DELETE").then(()=>{u(e=>!1),S(t+=1)}).catch(e=>{T(e)})):y()},w=async t=>{n[t]?(u(e=>!0),I.custom(n[t].uuid?`/${n[t].uuid}`:"",n[t].uuid?"PUT":"POST",null,{data:{kode_akun_perkiraan:n[t].kodeAkun.value,waktu:n[t].waktu,transaksi_kas:i,uraian:n[t].uraian,nilai:n[t].nilai}}).then(e=>{n[t].uuid||(n[t].uuid=e.data.uuid),u(s=>!1),w(t+=1)}).catch(e=>{T(e)})):y()},K=()=>{let t=[...n];t.push({waktu:`${new Date().getHours()<10?"0"+new Date().getHours():new Date().getHours()}:${new Date().getMinutes()<10?"0"+new Date().getMinutes():new Date().getMinutes()}:${new Date().getSeconds()<10?"0"+new Date().getSeconds():new Date().getSeconds()}`,kodeAkun:M(),uraian:"",nilai:"0"}),b(e=>t)},F=()=>{let t=0;n.map(e=>{t+=B(e.nilai)}),x(e=>({totalDebet:p==0?t:r,totalKredit:p==1?t:r}))},N=(t,e,s)=>{let c=[...n];b($=>[]),c[e][s]=t,b($=>c)};l.useEffect(()=>{F()},[n]);const L=t=>{O.custom("/no_kas","GET").then(e=>{D(s=>e.data)})},E=()=>{I.custom(`/${i}`,"GET").then(t=>{b(e=>t.data.map(s=>{const c=f.filter($=>$.uuid==s.kode_akun_perkiraan).at(0);return c?{uuid:s.uuid,nilai:v(s.nilai),waktu:s.waktu,uraian:s.uraian,kodeAkun:{label:`${c.code} - ${c.name}`,value:s.kode_akun_perkiraan}}:{uuid:s.uuid,nilai:v(s.nilai),waktu:s.waktu,uraian:s.uraian,kodeAkun:M()}}))}).catch(t=>{T(t)})};return l.useEffect(()=>{E()},[f]),l.useEffect(()=>{L()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"flex flex-col px-6 mt-6 w-full",children:[a.jsxs("div",{className:"grid grid-cols-7 w-max gap-x-2 items-center",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("label",{className:"form-control w-full bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text font-bold",children:"Debet"})})})}),a.jsx("div",{className:"col-span-3",children:a.jsx("label",{className:"form-control w-full bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text font-bold",children:"Kredit"})})})}),a.jsx("div",{className:"col-span-3",children:a.jsx("label",{className:"form-control w-full bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text font-bold",children:"Status"})})})}),a.jsx("div",{className:"col-span-1",children:a.jsx("label",{className:"form-control w-full bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text",children:v(g.totalDebet)})})})}),a.jsx("div",{className:"col-span-3",children:a.jsx("label",{className:"form-control w-full bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text",children:v(g.totalKredit)})})})}),a.jsx("div",{className:"col-span-3",children:a.jsx("label",{className:"form-control w-full bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:`label-text font-bold text-white px-3 py-2 rounded-md ${B(g.totalDebet)==B(g.totalKredit)?"bg-green-600":"bg-red-600"}`,children:B(g.totalDebet)==B(g.totalKredit)?"Seimbang":"Tidak Seimbang"})})})})]}),a.jsx("label",{className:"form-control w-full max-w-xs bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"flex items-center gap-x-2 label-text text-gray-800 font-bold mt-4",children:a.jsx("p",{children:"Rincian Transaksi Kas"})})})}),a.jsxs("div",{className:"grid w-full grid-cols-12 gap-x-2 border-b-2",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("label",{className:"form-control w-full max-w-xs bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text text-gray-600",children:"Waktu"})})})}),a.jsx("div",{className:"col-span-3",children:a.jsx("label",{className:"form-control w-full max-w-xs bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text text-gray-600",children:"Kode Akun"})})})}),a.jsx("div",{className:"col-span-6",children:a.jsx("label",{className:"form-control w-full max-w-xs bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text text-gray-600",children:"Uraian"})})})}),a.jsx("div",{className:"col-span-2",children:a.jsx("label",{className:"form-control w-full max-w-xs bg-white",children:a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text text-gray-600",children:"Nilai"})})})})]}),a.jsx("div",{className:"grid w-full items-end grid-cols-12 gap-x-2",children:n.map((t,e)=>a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-5 col-span-1",children:a.jsx(U,{name:`waktu_${e}`,type:"time",value:t.waktu,addClass:"required",onchange:s=>N(s.target.value,e,"waktu"),other:{autoComplete:!1,step:1}})}),a.jsx("div",{className:"mb-5 col-span-3",children:a.jsx(aa,{optionsDataList:f,optionsLabel:["code","name"],optionsValue:"uuid",optionsLabelIsArray:!0,optionsDelimiter:"-",selectValue:t.kodeAkun,onchange:s=>{N(s,e,"kodeAkun")},addClass:"required",selectName:`kodeAkun_${e}`})}),a.jsx("div",{className:"mb-5 col-span-6",children:a.jsx(U,{name:`uraian_${e}`,type:"text",value:t.uraian,addClass:"required",onchange:s=>N(s.target.value,e,"uraian"),other:{autoComplete:!1}})}),a.jsx("div",{className:"mb-5 col-span-2",children:a.jsxs("div",{className:"w-full indicator",children:[a.jsx("span",{className:"indicator-item indicator-bottom badge bg-red-800 text-white px-2 py-4 cursor-pointer",onClick:()=>A(e),children:a.jsx(ea,{})}),a.jsx(U,{name:`nilai_${e}`,type:"text",value:v(t.nilai),onchange:s=>{J(s),N(s.target.value,e,"nilai")},other:{autoComplete:!1}})]})})]}))}),a.jsxs("div",{className:"flex sticky bottom-0 bg-white py-3 w-full items-end gap-x-2",children:[sa("demo_permission")&&n.length<2?a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-blue-800 mt-4 text-white",onClick:()=>K(),children:[a.jsx(z,{})," Tambah Transaksi"]})}):a.jsx(a.Fragment,{children:a.jsx("p",{className:"text-red-500 font-bold text-xs",children:"* Hanya Mengijinkan 2 Inputan Dalam Mode Demo"})}),a.jsxs("button",{disabled:o,className:"btn btn-sm bg-green-800 mt-4 text-white",onClick:()=>C(),children:[a.jsx(P,{})," ",o?"Sedang Menyimpan":"Simpan"]})]})]})})},ga=({setAddTransaksiEvent:i,transaksiSelected:r,getData:y=()=>{}})=>{const[p,o]=l.useState(!1),[u,g]=l.useState({label:_[0].label,value:_[0].value}),[x,f]=l.useState(null),[D,k]=l.useState(null),[j,n]=l.useState(ta()),[b,A]=l.useState(""),[C,S]=l.useState(""),[w,K]=l.useState("0"),[F,N]=l.useState([]),L=e=>{O.custom("/kas","GET").then(s=>{if(N(s.data),s.data.length>0)if(e){const c=s.data.filter($=>$.uuid==e);c.length>0&&k({label:`${c[0].code} - ${c[0].name}`,value:c[0].uuid})}else k({label:`${s.data[0].code} - ${s.data[0].name}`,value:s.data[0].uuid})})},E=async e=>{e.preventDefault(),await q(e.target)&&(o(s=>!0),R.custom(`${r?"/"+r:""}`,r?"PUT":"POST",null,{data:{tanggal:j,bukti_transaksi:b,kode_akun_perkiraan:D.value,uraian:C,nilai:w,type:u.value}}).then(s=>{f(r||s.data.uuid),o(c=>!1)}).catch(s=>{T(s),o(c=>!1)}))},t=()=>{R.custom(`/${r}`).then(e=>{n(s=>e.data.tanggal),A(s=>e.data.bukti_transaksi),S(s=>e.data.uraian),K(s=>v(e.data.nilai)),g({label:_.filter(s=>s.value==e.data.type).at(0).label,value:e.data.type}),L(e.data.kode_akun_perkiraan)}).catch(e=>{T(e)})};return l.useEffect(()=>{r&&t()},[r]),l.useEffect(()=>{L()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white rounded-md shadow-2xl no-scrollbar relative",children:[a.jsxs("div",{className:"sticky top-0 pt-3 px-6 h-max bg-white w-full z-10",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[r!=null?"Edit ":"Tambah "," Transaksi"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>i(),children:[a.jsx(Y,{})," Batalkan Transaksi"]})]}),a.jsxs("form",{onSubmit:e=>E(e),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(H,{label:"Hari/Tanggal",type:"datetime-local",onchange:e=>{n(e.target.value)},disabled:x,others:{value:j,name:"hariTanggal"}}),a.jsx(H,{label:"Bukti Transaksi",type:"text",disabled:x,onchange:e=>{A(e.target.value)},others:{value:b,name:"buktiTransaksi"}})]}),a.jsxs("div",{className:"mt-5 flex gap-x-2",children:[a.jsx(V,{label:"Tipe Transaksi",optionsDataList:_,optionsLabel:"label",disabled:x,optionsValue:"value",selectValue:u,onchange:e=>{g(e)},selectName:"tipeTransaksi"}),a.jsx(V,{label:"Kode Akun",optionsDataList:F,optionsLabel:["code","name"],optionsValue:"uuid",optionsLabelIsArray:!0,optionsDelimiter:"-",disabled:x,selectValue:D,onchange:e=>{k(e)},selectName:"kodeAkun"}),a.jsx(H,{label:"Uraian",type:"text",disabled:x,onchange:e=>{S(e.target.value)},others:{value:C,name:"uraian"}}),a.jsx(H,{label:"Nilai",type:"text",onchange:e=>{J(e),K(e.target.value)},disabled:x,others:{value:w,name:"nilai"}})]}),x?a.jsx(a.Fragment,{}):a.jsxs("button",{disabled:p,className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(P,{})," ",p?"Sedang Menyimpan":"Simpan"]})]})]}),x?a.jsx(a.Fragment,{children:a.jsx(ma,{getData:y,kodeAkunList:F,idTransaksiKas:x,nilaiTransaksi:w,type:u.value})}):a.jsx(a.Fragment,{})]})})},va=()=>{const i=la(),{data:r,setData:y}=i,[p,o]=l.useState(!1),[u,g]=l.useState(!0),[x,f]=l.useState(_.map(d=>d.value)),[D,k]=l.useState(""),[j,n]=l.useState(new Date().getMonth()),[b,A]=l.useState([]),[C,S]=l.useState([]),[w,K]=l.useState(),[F,N]=l.useState(0),[L,E]=l.useState(0),[t,e]=l.useState(!1),s=(d="")=>{o(!0),d==""&&k(d),R.custom(`/${j+1}/${r.tahun}?search=${d}`,"GET").then(async h=>{A(m=>h.data),o(!1)}).catch(h=>{T(h)})},c=async d=>{await G("Hapus","Yakin ingin hapus data ini ?")&&I.custom(`/${d}`,"DELETE").then(h=>{W("Berhasil","Transaksi berhasil dihapus"),s()}).catch(h=>{T(h),s()})},$=async d=>{await G("Hapus","Yakin ingin hapus data di bukti transaksi ini ?")&&(o(!0),R.custom(`/${d.data[0][0].uuid}`,"DELETE").then(()=>{W("Berhasil","Transaksi berhasil dihapus"),s()}).catch(h=>{T(h),s()}))},Q=async d=>{o(!0),K(d.data[0][0].uuid),e(!0),o(!1)},Z=async()=>{const d=b.filter(m=>x.filter(X=>X==m.type).length>0);let h=await ca(d.map(m=>(m.bulan=j+1,m.tahun=r.tahun,m.waktu=m.waktu?m.waktu:m.tanggal.split("T")[1].replace(".000",""),m.tanggal=m.tanggal.length>2?new Date(m.tanggal).getDate():m.tanggal,m)));S(h.returnData),N(h.totalDebet),E(h.totalKredit)};return l.useEffect(()=>{Z()},[x,b]),l.useEffect(()=>{s()},[j]),l.useEffect(()=>{t||s()},[t]),a.jsx(na,{isLoading:p,children:a.jsx("div",{children:t?a.jsx(ga,{setAddTransaksiEvent:()=>e(!t),transaksiSelected:w,getData:s}):a.jsxs(a.Fragment,{children:[a.jsx(ia,{title:"Transaksi Kas"}),a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:D,onChange:d=>k(d.target.value)}),u?a.jsx(ra,{className:"cursor-pointer",onClick:()=>s(D)}):a.jsx(Y,{className:"cursor-pointer",onClick:()=>{s("")}})]}),a.jsx("div",{children:a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{K(null),e(!0)},children:[a.jsx(z,{})," Tambah Transaksi"]})})]}),a.jsxs("div",{className:"grid grid-cols-6",children:[a.jsxs("div",{className:"col-span-1",children:[a.jsx(da,{bulan:j,setBulan:n}),u?a.jsx(oa,{debet:F,kredit:L}):a.jsx(a.Fragment,{})]}),a.jsx("div",{className:"col-span-5",children:a.jsxs("div",{className:"h-[65vh] pl-2",children:[a.jsx(xa,{checkListBox:x,setCheckListBox:f,checkListBoxList:_,label:"Tipe Transaksi"}),a.jsx("div",{className:"flex flex-col h-full overflow-y-scroll no-scrollbar w-full rounded-md",children:C.map((d,h)=>a.jsx(ha,{deleteByBuktiTransaksi:$,deleteItem:c,editItem:Q,item:d,balanceStatus:u},h))})]})})]})]})})})};export{va as default};
