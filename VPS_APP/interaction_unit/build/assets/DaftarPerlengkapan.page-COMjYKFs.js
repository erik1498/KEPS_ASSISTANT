import{r as l,a8 as Z,p as g,j as e,d as G,Q as P,m as E,ao as ee,at as K,t as x,au as ae,V as te,aP as se,o as ne,aQ as $,v as I,R as le,w as oe,W as ie,x as ue,y as re,l as ce,z as he,n as xe,c as ge,b as pe,F as me,D as be}from"./index-w4WRH1zx.js";import{P as je}from"./Pagination-hXZ8aV_7.js";import{F as r}from"./FormInputWithLabel-KhAr-6m5.js";import{i as C}from"./actionEvent.helper-DeauyOY9.js";import{P as De,l as ke}from"./PDFHeader-jGZBZNfE.js";import"./react-paginate-DlRX8p9z.js";import"./index-BKNjMPK8.js";const ve=({setAddDaftarPerlengkapanEvent:i=()=>{},daftarPerlengkapanEdit:a,getData:o=()=>{}})=>{const[b,p]=l.useState([]),[y,j]=l.useState([]),[D,F]=l.useState([]),[S,f]=l.useState([]),[N,_]=l.useState(a!=null&&a.name?a.name:""),[k,d]=l.useState(a!=null&&a.nomor_invoice?a.nomor_invoice:""),[w,c]=l.useState(a!=null&&a.bukti_transaksi?a.bukti_transaksi:""),[m,u]=l.useState(a!=null&&a.tanggal_beli?a.tanggal_beli:Z()),[T,v]=l.useState(a!=null&&a.supplier?a.supplier:""),[L,R]=l.useState(a!=null&&a.kuantitas?g(a.kuantitas):""),[n,s]=l.useState(a!=null&&a.satuan_barang?a.satuan_barang:""),[h,B]=l.useState(a!=null&&a.harga_satuan?g(a.harga_satuan):""),[z,W]=l.useState(a!=null&&a.dpp?g(a.dpp):""),[O,Q]=l.useState(a!=null&&a.ppn?g(a.ppn):""),[U,A]=l.useState(a!=null&&a.kode_akun_perkiraan?a.kode_akun_perkiraan:""),[H,V]=l.useState(a!=null&&a.kategori_perlengkapan?a.kategori_perlengkapan:""),M=()=>{ee.custom("","GET").then(t=>{if(p(t.data.entry),t.data.entry.length>0){if(a){K({editObject:a.supplier,dataList:t.data.entry,setState:v,labelKey:"name",valueKey:"uuid"});return}v({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}}).catch(t=>{x(t)})},Y=()=>{ae.custom("","GET").then(t=>{if(j(t.data.entry),t.data.entry.length>0){if(a){K({editObject:a.satuan_barang,dataList:t.data.entry,setState:s,labelKey:"name",valueKey:"uuid"});return}s({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}}).catch(t=>{x(t)})},q=()=>{te.custom("/aset_perlengkapan","GET").then(t=>{if(F(t.data),t.data.length>0){if(a){K({editObject:a.kode_akun_perkiraan,dataList:t.data,setState:A,labelKey:"name",valueKey:"uuid"});return}A({label:`${t.data[0].code} - ${t.data[0].name}`,value:t.data[0].uuid})}}).catch(t=>{x(t)})},J=()=>{se.custom("","GET").then(t=>{if(f(t.data.entry),t.data.entry.length>0){if(a){K({editObject:a.kategori_perlengkapan,dataList:t.data.entry,setState:V,labelKey:"name",valueKey:"uuid"});return}V({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}}).catch(t=>{x(t)})},X=async()=>{await ne()&&$.custom(`${a!=null&&a.uuid?`/${a.uuid}`:""}`,a?"PUT":"POST",null,{data:{name:N,nomor_invoice:k,bukti_transaksi:w,tanggal_beli:m,kategori_perlengkapan:H.value,supplier:T.value,kuantitas:L,kode_akun_perkiraan:U.value,satuan_barang:n.value,harga_satuan:h,dpp:z,ppn:O}}).then(()=>{a?I("Berhasil","Data berhasil diupdate"):I("Berhasil","Data berhasil disimpan"),i(),o()}).catch(t=>{x(t)})};return l.useEffect(()=>{M(),Y(),q(),J()},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[e.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[e.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[a?"Edit":"Tambahkan"," Daftar Perlengkapan"]}),e.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>i(),children:[e.jsx(G,{})," Batalkan Daftar Perlengkapan"]})]}),e.jsxs("div",{className:"flex gap-x-2",children:[e.jsx(r,{label:"Nama Perlengkapan",type:"text",onchange:t=>{_(t.target.value)},others:{value:N,name:"namaDaftarPerlengkapan"}}),e.jsx(r,{label:"Nomor Invoice",type:"text",onchange:t=>{d(t.target.value)},others:{value:k,name:"nomorInvoiceDaftarPerlengkapan"}}),e.jsx(r,{label:"Bukti Transaksi",type:"text",onchange:t=>{c(t.target.value)},others:{value:w,name:"buktiTransaksiDaftarPerlengkapan"}}),e.jsx(r,{label:"Tanggal Beli",type:"datetime-local",onchange:t=>{u(t.target.value)},others:{value:m,name:"tanggalBeliDaftarPerlengkapan"}}),e.jsx(P,{label:"Kode Akun",optionsDataList:D,optionsLabel:["code","name"],optionsLabelIsArray:!0,optionsValue:"uuid",optionsDelimiter:"-",selectValue:U,onchange:t=>{A(t)},selectName:"kodeAkunPerkiraanDaftarPerlengkapan"}),e.jsx(P,{label:"Kategori Perlengkapan",optionsDataList:S,optionsLabel:"name",optionsValue:"uuid",selectValue:H,onchange:t=>{V(t)},selectName:"kategoriPerlengkapanDaftarPerlengkapan"})]}),e.jsxs("div",{className:"mt-5 flex gap-x-2",children:[e.jsx(P,{label:"Supplier",optionsDataList:b,optionsLabel:"name",optionsValue:"uuid",selectValue:T,onchange:t=>{v(t)},selectName:"supplierDaftarPerlengkapan"}),e.jsx(r,{label:"Kuantitas",type:"text",onchange:t=>{C(t),R(t.target.value)},others:{value:L,name:"kuantitasDaftarPerlengkapan"}}),e.jsx(P,{label:"Satuan Barang",optionsDataList:y,optionsLabel:"name",optionsValue:"uuid",selectValue:n,onchange:t=>{s(t)},selectName:"satuanBarangDaftarPerlengkapan"}),e.jsx(r,{label:"Harga Satuan",type:"text",onchange:t=>{C(t),B(t.target.value)},others:{value:h,name:"hargaSatuanDaftarPerlengkapan"}})]}),e.jsxs("div",{className:"mt-5 flex gap-x-2",children:[e.jsx(r,{label:"DPP",type:"text",onchange:t=>{C(t),W(t.target.value)},others:{value:z,name:"DPPDaftarPerlengkapan"}}),e.jsx(r,{label:"PPN",type:"text",onchange:t=>{C(t),Q(t.target.value)},others:{value:O,name:"PPNDaftarPerlengkapan"}})]}),e.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",onClick:()=>{X()},children:[e.jsx(E,{})," Simpan"]})]})})},ye=le.forwardRef((i,a)=>{var o;return e.jsxs("div",{ref:a,children:[e.jsx(De,{bulan:i.bulan,tahun:i.tahun,title:"Daftar Perlengkapan"}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[e.jsx("th",{width:12,children:"No"}),e.jsx("th",{children:"Nama Daftar Perlengkapan"})]})}),e.jsx("tbody",{children:(o=i==null?void 0:i.data)==null?void 0:o.map((b,p)=>e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{children:p+1}),e.jsx("td",{children:b.name})]},p)}))})]})]})}),Be=()=>{const i=oe(),{data:a}=i,[o,b]=l.useState([]),[p,y]=l.useState(!1),[j,D]=l.useState(!1),[F,S]=l.useState({name:""}),[f,N]=l.useState(!1),[_,k]=l.useState(""),d=l.useRef(),w=ke.useReactToPrint({content:()=>d.current}),[c,m]=l.useState({page:1,size:10,count:118,lastPage:12}),u=(n="")=>{n==""&&k(n),y(!0),$.custom(`?search=${n}&page=${c.page}&size=${c.size}`,"GET").then(s=>{var h,B;N(n.length<1),b((h=s==null?void 0:s.data)==null?void 0:h.entry),m((B=s==null?void 0:s.data)==null?void 0:B.pagination),y(!1)}).catch(s=>{x(s)})},T=n=>{let s=o[n];S(s),D(!j)},v=async n=>{if(await be("Hapus","Yakin ingin hapus data ini ?")){let s=o[n];$.custom(`/${s.uuid}`,"DELETE").then(()=>{I("Berhasil","Data berhasil dihapus"),u()}).catch(h=>{x(h)})}},L=({selected:n})=>{let s=c;s.page=n+1,m(s),u()},R=n=>{let s=c;s.size=n,s.page=1,m(s),u()};return l.useEffect(()=>{u()},[]),e.jsx(ie,{isLoading:p,children:e.jsxs("div",{children:[e.jsx(ue,{title:"Daftar Perlengkapan"}),j?e.jsx(ve,{setAddDaftarPerlengkapanEvent:()=>D(!1),getData:u,daftarPerlengkapanEdit:F}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[e.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[e.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:_,onChange:n=>k(n.target.value)}),f?e.jsx(re,{onClick:()=>{u(_)},className:"cursor-pointer"}):e.jsx(G,{onClick:()=>u(""),className:"cursor-pointer"})]}),e.jsxs("div",{className:"flex gap-x-2 items-center",children:[e.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{S(null),D(!j)},children:[e.jsx(ce,{})," Tambah Daftar Perlengkapan"]}),e.jsx("div",{className:"hidden",children:e.jsx(ye,{data:o,ref:d,bulan:he(new Date().getMonth()),tahun:a.tahun})}),e.jsxs("button",{onClick:w,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[e.jsx(xe,{})," Cetak Daftar Perlengkapan"]})]})]}),e.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[e.jsx("th",{width:12,children:"No"}),e.jsx("th",{children:"Nama Daftar Perlengkapan"}),e.jsx("th",{children:"Nomor Invoice"}),e.jsx("th",{children:"Tanggal Beli"}),e.jsx("th",{children:"Kategori Perlengkapan"}),e.jsx("th",{children:"Total Beli"}),e.jsx("th",{children:"DPP"}),e.jsx("th",{children:"PPN"}),e.jsx("th",{children:"Aksi"})]})}),e.jsx("tbody",{children:o==null?void 0:o.map((n,s)=>e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsxs("td",{children:[s+1,"."]}),e.jsx("td",{children:n.name}),e.jsx("td",{children:n.nomor_invoice}),e.jsx("td",{children:`${n.tanggal_beli.split("T")[0]} ${ge(n.tanggal_beli.split("T")[1])}`}),e.jsx("td",{children:n.kategori_perlengkapan_name}),e.jsx("td",{children:g(n.harga_satuan*n.kuantitas)}),e.jsx("td",{children:g(n.dpp)}),e.jsx("td",{children:g(n.ppn)}),e.jsxs("td",{className:"flex gap-x-2",children:[e.jsx(pe,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{T(s)}}),e.jsx(me,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{v(s)}})]})]},s)}))})]})}),e.jsx(je,{paginateUpdatePage:L,paginate:c,setSize:R})]})]})})};export{Be as default};
