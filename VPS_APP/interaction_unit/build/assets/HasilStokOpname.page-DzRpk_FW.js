import{w as H,r as l,a7 as L,j as a,d as O,Q as R,e as B,p as $,m as z,bV as P,t as f,bU as T,as as K,R as U,W as A,x as G,y as I,f as V,z as W,b as E,F as D,D as J,v as Q}from"./index-DkLWHN4U.js";import{P as Y}from"./Pagination-BRVZ5jKo.js";import{F as q}from"./FormInputWithLabel-CsT-VGf4.js";import{i as M}from"./actionEvent.helper-R7pYClSI.js";import{P as X,l as Z}from"./PDFHeader-DqJvDgdi.js";import"./react-paginate-ByHbu1vo.js";import"./index-BKNjMPK8.js";const aa=({setAddHasilStokOpnameEvent:i=()=>{},hasilStokOpnameEdit:n,getData:c=()=>{}})=>{const m=H(),{data:x}=m,[p,S]=l.useState(n!=null&&n.hasil_stok_opname_tanggal?n.hasil_stok_opname_tanggal:L()),[d,j]=l.useState(n!=null&&n.uuid?n.uuid:""),[y,N]=l.useState([]),[r,b]=l.useState([]),_=async t=>{P.custom(`${r[t].uuid!=""?`/${r[t].uuid}`:""}`,r[t].uuid!=""?"PUT":"POST",null,{data:{tanggal:p,perintah_stok_opname:d.value,stok_awal_barang:r[t].stok_awal_barang,kuantitas:`${r[t].kuantitas}`}}).then(()=>{t+1<r.length?_(t+1):(c(),i())}).catch(o=>{f(o)})},v=()=>{T.custom(`?tahun=${x.tahun}`,"GET").then(t=>{if(N(t.data.entry),t.data.entry.length>0){if(n){K({editObject:n.uuid,dataList:t.data.entry,setState:j,labelKey:"nomor_surat_perintah",valueKey:"uuid"});return}j({label:t.data.entry[0].nomor_surat_perintah,value:t.data.entry[0].uuid})}}).catch(t=>f(t))},u=()=>{P.custom(`/daftar_barang/${d.value}`,"GET").then(t=>{b(t.data)}).catch(t=>f(t))},k=(t,o)=>{let h=r;h=h.map(g=>(g.stok_awal_barang==o&&(g.kuantitas=t),g)),b(g=>h)};return l.useEffect(()=>{d&&u()},[d]),l.useEffect(()=>{v()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[n?"Edit":"Tambahkan"," Hasil Stok Opname"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>i(),children:[a.jsx(O,{})," Batalkan Hasil Stok Opname"]})]}),a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(q,{label:"Tanggal",type:"datetime-local",onchange:t=>{S(t.target.value)},others:{value:p,name:"tanggal"}}),a.jsx(R,{label:"Perintah Stok Opname",optionsDataList:y,optionsLabel:"nomor_surat_perintah",optionsValue:"uuid",disabled:!0,selectValue:d,onchange:t=>{j(t)},selectName:"perintahStokOpname"})]}),a.jsx("div",{className:"overflow-x-auto rounded-md h-max max-h-[90vh] no-scrollbar mt-5 pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Kuantitas"})]})}),a.jsx("tbody",{children:r==null?void 0:r.map((t,o)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[o+1,"."]}),a.jsx("td",{children:t.kategori_harga_barang_kode_barang}),a.jsx("td",{children:t.daftar_barang_name}),a.jsx("td",{children:t.satuan_barang_name}),a.jsx("td",{children:a.jsx(B,{name:"kuantitas_"+o,type:"text",other:{defaultValue:t.kuantitas},onchange:h=>{M(h),k(h.target.value,t.stok_awal_barang)},value:$(t.kuantitas)})})]},o)}))})]})}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",onClick:()=>{_(0)},children:[a.jsx(z,{})," Simpan"]})]})})};U.forwardRef((i,n)=>{var c;return a.jsxs("div",{ref:n,children:[a.jsx(X,{bulan:i.bulan,tahun:i.tahun,title:"Hasil Stok Opname"}),a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Hasil Stok Opname"})]})}),a.jsx("tbody",{children:(c=i==null?void 0:i.data)==null?void 0:c.map((m,x)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:x+1}),a.jsx("td",{children:m.name})]},x)}))})]})]})});const ca=()=>{const i=H(),{data:n}=i,[c,m]=l.useState([]),[x,p]=l.useState(!1),[S,d]=l.useState(!1),[j,y]=l.useState({name:""}),[N,r]=l.useState(!1),[b,_]=l.useState(""),v=l.useRef();Z.useReactToPrint({content:()=>v.current});const[u,k]=l.useState({page:1,size:10,count:118,lastPage:12}),t=(s="")=>{s==""&&_(s),p(!0),T.custom(`?search=${s}&page=${u.page}&size=${u.size}&tahun=${n.tahun}`,"GET").then(e=>{var w,F;r(s.length<1),m((w=e==null?void 0:e.data)==null?void 0:w.entry),k((F=e==null?void 0:e.data)==null?void 0:F.pagination),p(!1)}).catch(e=>{f(e)})},o=s=>{let e=c[s];y(e),d(!S)},h=async s=>{if(await J("Hapus","Yakin ingin hapus data ini ?")){let e=c[s];P.custom(`/${e.uuid}`,"DELETE").then(()=>{Q("Berhasil","Data berhasil dihapus"),t()}).catch(w=>{f(w)})}},g=({selected:s})=>{let e=u;e.page=s+1,k(e),t()},C=s=>{let e=u;e.size=s,e.page=1,k(e),t()};return l.useEffect(()=>{t()},[]),a.jsx(A,{isLoading:x,children:a.jsxs("div",{children:[a.jsx(G,{title:"Hasil Stok Opname"}),S?a.jsx(aa,{setAddHasilStokOpnameEvent:()=>d(!1),getData:t,hasilStokOpnameEdit:j}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:b,onChange:s=>_(s.target.value)}),N?a.jsx(I,{onClick:()=>{t(b)},className:"cursor-pointer"}):a.jsx(O,{onClick:()=>t(""),className:"cursor-pointer"})]})}),a.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Tanggal"}),a.jsx("th",{children:"Bulan Transaksi"}),a.jsx("th",{children:"Nomor Perintah Stok Opname"}),a.jsx("th",{children:"Pegawai Penanggung Jawab"}),a.jsx("th",{children:"Pegawai Pelaksana"}),a.jsx("th",{children:"Kategori Barang"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Aksi"})]})}),a.jsx("tbody",{children:c==null?void 0:c.map((s,e)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[e+1,"."]}),a.jsx("td",{children:V(s.hasil_stok_opname_tanggal,!0)}),a.jsx("td",{children:W(s.bulan_transaksi-1)}),a.jsx("td",{children:s.nomor_surat_perintah}),a.jsx("td",{children:s.pegawai_penanggung_jawab_name}),a.jsx("td",{children:s.pegawai_pelaksana_name}),a.jsx("td",{children:s.kategori_barang_name}),a.jsx("td",{children:s.daftar_gudang_name}),a.jsxs("td",{className:"flex gap-x-2",children:[a.jsx(E,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{o(e)}}),s.hasil_stok_opname_count>0?a.jsx(a.Fragment,{children:a.jsx(D,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{h(e)}})}):a.jsx(a.Fragment,{})]})]},e)}))})]})}),a.jsx(Y,{paginateUpdatePage:g,paginate:u,setSize:C})]})]})})};export{ca as default};
