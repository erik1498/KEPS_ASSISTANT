import{r as l,j as a,b as S,y as B,bu as C,f as R,bg as m,s as T}from"./index-CfdqnSWR.js";import{W as w}from"./Wrap-3qI6yka0.js";import{P as E}from"./PageTitle-CmNDlYSt.js";import{p}from"./number.helper-efe0YCx6.js";import{F as P}from"./FormSelectWithLabel-Bho4ATIP.js";import{F as u}from"./FormCheckBox-D4fU6Fnq.js";import"./FormInput-Cl28VpMz.js";const A=()=>{const[j,L]=l.useState(!1),[r,g]=l.useState({check:!1}),[d,x]=l.useState([]),[b,N]=l.useState([]),[n,o]=l.useState([]),[t,h]=l.useState({label:null,value:null}),f=()=>{h(s=>null),m.custom("","GET").then(s=>{N(s.data.entry),s.data.entry.length>0&&h(e=>({label:s.data.entry[0].nomor_faktur_penjualan_barang,value:s.data.entry[0].uuid}))}).catch(s=>T(s))},_=()=>{m.custom(`/rincian_pesanan_penjualan_barang_by_faktur/${t==null?void 0:t.value}`,"GET").then(s=>{o(e=>{var c;return(c=s==null?void 0:s.data)==null?void 0:c.map(i=>(i.check=r==null?void 0:r.check,i))})})},k=()=>{x(s=>[]),m.custom(`/rincian_Stok_barang_by_faktur/${t==null?void 0:t.value}`,"POST",null,{data:{rincian_pesanan_penjualan_barang_list:n.filter(s=>s.check==!0).map(s=>s.uuid)}}).then(s=>{x(e=>s.data)})},v=s=>{const e=n==null?void 0:n.findIndex(c=>c.uuid==s.uuid);o(c=>c=c.map((i,F)=>(F==e&&(i.check=!i.check),i)))},y=()=>{g(s=>s=!s)};return l.useEffect(()=>{o(s=>s=s.map(e=>(e.check=!r,e)))},[r]),l.useEffect(()=>{f()},[]),a.jsx(w,{isLoading:j,children:a.jsxs("div",{children:[a.jsx(E,{title:"Laporan Stok Barang"}),a.jsxs("div",{className:"grid grid-cols-12",children:[a.jsx("div",{className:"col-span-12",children:a.jsxs("div",{className:"bg-white py-6 px-6 rounded-t-md",children:[a.jsx("div",{className:"flex items-end gap-x-2",children:a.jsx(P,{label:"Faktur Penjualan Barang",optionsDataList:b,optionsLabel:"nomor_faktur_penjualan_barang",optionsValue:"uuid",disabled:(n==null?void 0:n.length)>0,selectValue:t,onchange:s=>{h(s)},selectName:"fakturPenjualanBarang"})}),(n==null?void 0:n.length)>0?a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn mt-3 btn-sm bg-red-800 text-white",onClick:()=>{o(s=>[]),x(s=>[])},children:[a.jsx(S,{})," Reset Faktur"]})}):a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn mt-3 btn-sm bg-green-800 text-white",onClick:()=>_(),children:[a.jsx(B,{})," Pilih Faktur"]})})]})}),a.jsx("div",{className:"col-span-12 h-[80vh] overflow-y-scroll no-scrollbar",children:a.jsxs("div",{className:"bg-white rounded-b-md px-6 py-3",children:[a.jsxs("div",{className:"flex justify-between pb-5",children:[a.jsx("h1",{className:"font-bold text-md pb-3",children:"Pilih Barang Pesanan"}),a.jsxs("button",{className:"btn btn-sm bg-blue-800 text-white",onClick:()=>k(),children:[a.jsx(C,{})," Lihat Riwayat Stok"]})]}),a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 py-3 border-b-2",children:[a.jsx("div",{className:"col-span-1 flex justify-center",children:a.jsx("p",{className:"text-xs font-bold",children:a.jsx(u,{item:r,checkedKey:"check",updateCheckBox:()=>y()})})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-xs font-bold",children:"Nama / Kode Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-xs font-bold",children:"Satuan Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-xs font-bold",children:"Gudang"})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-xs font-bold",children:"Jumlah Barang"})})]}),n.map(s=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 py-2 items-center",children:[a.jsx("div",{className:"col-span-1 flex justify-center",children:a.jsx(u,{item:s,checkedKey:"check",updateCheckBox:()=>{v(s)}})}),a.jsxs("div",{className:"col-span-3",children:[a.jsx("p",{className:"text-xs",children:s.daftar_barang_name}),a.jsx("p",{className:"text-xs",children:s.kategori_harga_barang_kode_barang})]}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-xs",children:s.satuan_barang_name})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-xs",children:s.daftar_gudang_name})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-xs",children:p(s.jumlah)})})]}),(d==null?void 0:d.filter(e=>e.rincian_pesanan_penjualan_barang==s.uuid).length)>0?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 gap-x-2 border-y-2 py-1 border-gray-200 items-center",children:[a.jsx("div",{className:"col-span-1 flex justify-center"}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-xs font-bold",children:"Tanggal Stok"})}),a.jsx("div",{className:"col-span-6",children:a.jsx("p",{className:"text-xs font-bold",children:"Nomor Surat Jalan"})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-xs font-bold",children:"Dikirim"})})]})}):a.jsx(a.Fragment,{}),d==null?void 0:d.filter(e=>e.rincian_pesanan_penjualan_barang==s.uuid).map(e=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"grid grid-cols-12 bg-gray-100 gap-x-2 py-2 items-center",children:[a.jsx("div",{className:"col-span-1 flex justify-center"}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-xs",children:R(e.tanggal)})}),a.jsx("div",{className:"col-span-6",children:a.jsx("p",{className:"text-xs",children:e.nomor_surat_jalan})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-xs",children:p(e.jumlah)})})]})}))]}))]})})]})]})})};export{A as default};
