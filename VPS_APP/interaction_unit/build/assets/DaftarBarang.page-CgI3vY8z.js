import{r,O as M,j as a,h as $,F as z,k as U,aD as R,s as x,a5 as Q,a2 as X,aE as T,b as q,aF as A,n as G,a8 as Z,a1 as E,a9 as aa,R as ea,u as ta,o as na,e as sa,p as la,i as ra,a as ia,q as oa}from"./index-uJy3UgYS.js";import{P as ca}from"./PageTitle-BH7LYrc2.js";import{k as P,g as K,f as V,W as ua}from"./Wrap-BJna6Lck.js";import{P as ga}from"./Pagination-gIkiVvxn.js";import{F as J}from"./FormInputWithLabel-CaGWAovJ.js";import{F}from"./FormSelectWithLabel-CcV5HKb0.js";import{i as I}from"./actionEvent.helper-BujKUZ7B.js";import{p as W}from"./number.helper-efe0YCx6.js";import{F as Y}from"./FormInput-CZf5rTrN.js";import{P as ha,l as da}from"./PDFHeader-BwLr_SbW.js";import"./react-paginate-BxIB-5-4.js";import"./index-BKNjMPK8.js";const xa=({idDaftarBarang:g,kategoriHargaBarangList:t})=>{const[h,u]=r.useState(),[m,k]=r.useState(t.length>0?{label:t[0].kode_barang,value:t[0].uuid}:null),[b,_]=r.useState(0),[y,N]=r.useState(M()),[w,v]=r.useState([]),[B,S]=r.useState([]),D=async l=>{l.preventDefault(),await U(l.target)&&R.custom("","POST",null,{data:{daftar_barang:g,daftar_gudang:h.value,kategori_harga_barang:m.value,jumlah:`${b}`,tanggal:`${y}`}}).then(()=>{d()}).catch(j=>{x(j)})},p=()=>{Q.custom("","GET").then(l=>{v(l.data.entry),l.data.entry.length>0&&u({label:l.data.entry[0].name,value:l.data.entry[0].uuid})}).catch(l=>{x(l)})},d=()=>{R.custom(`/${g}`,"GET").then(l=>{S(l.data)}).catch(l=>{x(l)})},f=l=>{R.custom(`/${l.uuid}`,"DELETE").catch(j=>{x(j)}).finally(()=>d())};return r.useEffect(()=>{p(),d()},[]),a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"mt-16 mb-5 uppercase text-gray-600 font-bold",children:"Stok Awal Barang"}),a.jsx("form",{onSubmit:l=>D(l),className:"pb-6",children:a.jsxs("div",{className:"flex gap-x-2 items-end",children:[a.jsx(F,{label:"Gudang Barang",optionsDataList:w,optionsLabel:"name",optionsValue:"uuid",selectValue:h,onchange:l=>{u(l)},selectName:"gudangBarang"}),a.jsx(F,{label:"Kode Barang",optionsDataList:t,optionsLabel:"kode_barang",optionsValue:"uuid",selectValue:m,onchange:l=>{k(l)},selectName:"kategoriHargaBarang"}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx($,{})," Simpan"]})]})}),a.jsxs("table",{className:"table table-sm table-zebra",children:[a.jsxs("thead",{className:"py-4 text-black",children:[a.jsx("th",{children:"No"}),a.jsx("th",{children:"Daftar Gudang Name"}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Satuan"}),a.jsx("th",{children:"Aksi"})]}),a.jsx("tbody",{children:B.map((l,j)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:j+1}),a.jsx("td",{children:l.daftar_gudang_name}),a.jsx("td",{children:l.kategori_harga_barang_kode_barang}),a.jsx("td",{children:l.satuan_barang_name}),a.jsx("td",{width:100,children:a.jsx("div",{className:"flex gap-x-2",children:a.jsx(z,{onClick:()=>f(l),className:"text-red-500 cursor-pointer",size:12})})})]})}))})]})]})},ma=({idDaftarbarang:g})=>{const[t,h]=r.useState(!1),[u,m]=r.useState([]),[k,b]=r.useState([]),[_,y]=r.useState(),[N,w]=r.useState(),[v,B]=r.useState([]),S=()=>{y(e=>null),b(e=>[]),h(e=>!1),X.custom("","GET").then(e=>{b(e.data.entry),h(c=>!0),y({label:e.data.entry[0].name,value:e.data.entry[0].uuid})}).catch(e=>{x(e)})},D=async e=>{if(e.preventDefault(),await U(e.target)){let c={daftar_barang:g,satuan_barang:_.value,kode_barang:N};P.map((o,s)=>{c[`harga_${o.value}`]=v[s]}),T.custom("","POST",null,{data:c}).then(()=>{p()}).catch(o=>{x(o)})}},p=()=>{T.custom(`/${g}`,"GET").then(e=>{m(c=>e.data.entry)}).catch(e=>{x(e)})},d=e=>{let c={daftar_barang:e.daftar_barang,satuan_barang:e.satuan_barang,kode_barang:e.kode_barang};P.map((o,s)=>{c[`harga_${o.value}`]=`${e[`harga_${o.value}`]}`}),T.custom(`/${e.uuid}`,"PUT",null,{data:c}).catch(o=>{x(o)}).finally(()=>p())},f=e=>{let c={daftar_barang:e.daftar_barang,satuan_barang:e.satuan_barang,kode_barang:e.kode_barang};P.map((o,s)=>{c[`harga_${o.value}`]=`${e[`harga_${s+1}`]}`}),T.custom(`/${e.uuid}`,"DELETE").catch(o=>{x(o)}).finally(()=>p())},l=(e,c,o)=>{const s=u.findIndex(i=>i.uuid==o);if(s!=-1){let i=u;i.at(s)[`harga_${c}`]=W(e),m(L=>i)}},j=(e,c)=>{const o=u.findIndex(s=>s.uuid==c);if(o!=-1){let s=u;s.at(o).kode_barang=e,m(i=>s)}};return r.useEffect(()=>{S()},[u]),r.useEffect(()=>{p()},[]),a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"mt-16 mb-5 uppercase text-gray-600 font-bold",children:"Kategori Harga"}),t?a.jsxs("form",{onSubmit:e=>D(e),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(F,{label:"Satuan Barang",optionsDataList:k,optionsLabel:"name",optionsValue:"uuid",selectValue:_,onchange:e=>{y(e)},selectName:"satuanBarang"}),a.jsx(J,{label:"Kode Barang",type:"text",onchange:e=>{w(e.target.value)},others:{value:N,name:"kodeBarang"}})]}),a.jsx("div",{className:"mt-5 flex gap-x-2",children:P.map((e,c)=>a.jsx(a.Fragment,{children:a.jsx(J,{label:e.label,type:"text",onchange:o=>{I(o);const s=[...v];s[c]=o.target.value,B(i=>s)},others:{value:v[c],name:`hargaBarang[${c}]`}})}))}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx($,{})," Simpan"]})]}):a.jsx(a.Fragment,{}),a.jsxs("table",{className:"mt-5 table table-sm table-zebra",children:[a.jsxs("thead",{className:"py-4 text-black",children:[a.jsx("th",{children:"No"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Kode Barang"}),P.map(e=>a.jsx("th",{children:e.label})),a.jsx("th",{children:"Aksi"})]}),a.jsx("tbody",{children:u.map((e,c)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:c+1}),a.jsx("td",{children:e.satuan_barang_name}),a.jsx("td",{children:a.jsx(Y,{name:"kode_barang"+c,type:"text",other:{defaultValue:e.kode_barang},onchange:o=>{j(o.target.value,e.uuid)}})}),P.map(o=>a.jsx("td",{width:150,children:a.jsx(Y,{name:"harga_"+o.value,type:"text",other:{defaultValue:W(e[`harga_${o.value}`])},onchange:s=>{I(s),l(s.target.value,o.value,e.uuid)}})})),a.jsx("td",{width:100,children:a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx($,{onClick:()=>d(e),className:"text-green-800 cursor-pointer",size:12}),a.jsx(z,{onClick:()=>f(e),className:"text-red-500 cursor-pointer",size:12})]})})]})}))})]}),a.jsx(xa,{idDaftarBarang:g,kategoriHargaBarangList:u})]})},ja=({setAddDaftarBarangEvent:g=()=>{},daftarBarangEdit:t,getData:h=()=>{}})=>{const[u,m]=r.useState(!1),[k,b]=r.useState(t!=null&&t.uuid?t.uuid:null),[_,y]=r.useState([]),[N,w]=r.useState([]),[v,B]=r.useState([]),[S,D]=r.useState(t!=null&&t.name?t.name:""),[p,d]=r.useState(t!=null&&t.kategori_barang?t.kategori_barang:""),[f,l]=r.useState(t!=null&&t.jenis_barang?t.jenis_barang:""),[j,e]=r.useState(t!=null&&t.jenis_penjualan_barang?t.jenis_penjualan_barang:""),[c,o]=r.useState((t==null?void 0:t.ppn)==0?{label:K.filter(n=>n.value==t.ppn).at(0).label,value:K.filter(n=>n.value==t.ppn).at(0).value}:{label:K[0].label,value:K[0].value}),s=async n=>{n.preventDefault(),await U(n.target)&&A.custom(`${t!=null&&t.uuid?`/${t.uuid}`:""}`,t?"PUT":"POST",null,{data:{name:S,kategori_barang:p.value,jenis_barang:f.value,jenis_penjualan_barang:j.value,ppn:c.value,status:1}}).then(H=>{t?G("Berhasil","Data berhasil diupdate"):(b(O=>H.data.uuid),G("Berhasil","Data berhasil disimpan")),m(O=>!0)}).catch(H=>{x(H),b(t.uuid),m(O=>!0)})},i=()=>{Z.custom("","GET").then(n=>{if(y(n.data.entry),n.data.entry.length>0){if(t){V({editObject:t.kategori_barang,dataList:n.data.entry,setState:d,labelKey:"name",valueKey:"uuid"});return}d({label:n.data.entry[0].name,value:n.data.entry[0].uuid})}}).catch(n=>{x(n)})},L=()=>{E.custom("","GET").then(n=>{if(w(n.data.entry),n.data.entry.length>0){if(t){V({editObject:t.jenis_barang,dataList:n.data.entry,setState:l,labelKey:"name",valueKey:"uuid"});return}l({label:n.data.entry[0].name,value:n.data.entry[0].uuid})}}).catch(n=>{x(n)})},C=()=>{aa.custom("","GET").then(n=>{if(B(n.data.entry),n.data.entry.length>0){if(t){V({editObject:t.jenis_penjualan_barang,dataList:n.data.entry,setState:e,labelKey:"name",valueKey:"uuid"});return}e({label:n.data.entry[0].name,value:n.data.entry[0].uuid})}}).catch(n=>{x(n)})};return r.useEffect(()=>{i(),L(),C()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[t?"Edit":"Tambahkan"," Daftar Barang"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>g(),children:[a.jsx(q,{})," Batalkan Daftar Barang"]})]}),a.jsxs("form",{onSubmit:n=>s(n),children:[a.jsx("div",{className:"flex gap-x-2",children:a.jsx(J,{label:"Nama Daftar Barang",type:"text",onchange:n=>{D(n.target.value)},others:{value:S,name:"namaDaftarBarang",disabled:u}})}),a.jsxs("div",{className:"mt-5 flex gap-x-2",children:[a.jsx(F,{label:"Kategori Barang",optionsDataList:_,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:p,onchange:n=>{d(n)},selectName:"kategoriDaftarBarang"}),a.jsx(F,{label:"Jenis Barang",optionsDataList:N,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:f,onchange:n=>{l(n)},selectName:"JenisDaftarBarang"}),a.jsx(F,{label:"Jenis Penjualan Barang",optionsDataList:v,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:j,onchange:n=>{e(n)},selectName:"jenisPenjualanDaftarBarang"})]}),a.jsx("div",{className:"mt-5 flex -gap-x-2",children:a.jsx(F,{label:"PPN",optionsDataList:K,optionsLabel:"label",optionsValue:"value",disabled:u,selectValue:c,onchange:n=>{o(n)},selectName:"ppnDaftarBarang"})}),u?a.jsx(a.Fragment,{}):a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx($,{})," Simpan"]})]}),u?a.jsx(ma,{idDaftarbarang:k}):a.jsx(a.Fragment,{})]})})},ba=ea.forwardRef((g,t)=>{var h;return a.jsxs("div",{ref:t,children:[a.jsx(ha,{bulan:g.bulan,tahun:g.tahun,title:"Daftar Barang"}),a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Daftar Barang"}),a.jsx("th",{children:"Kode Daftar Barang"})]})}),a.jsx("tbody",{children:(h=g==null?void 0:g.data)==null?void 0:h.map((u,m)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:m+1}),a.jsx("td",{children:u.name}),a.jsx("td",{children:u.code})]},m)}))})]})]})}),Fa=()=>{const g=ta(),{data:t}=g,[h,u]=r.useState([]),[m,k]=r.useState(!1),[b,_]=r.useState(!1),[y,N]=r.useState({name:""}),[w,v]=r.useState(!1),[B,S]=r.useState(""),D=r.useRef(),p=da.useReactToPrint({content:()=>D.current}),[d,f]=r.useState({page:1,size:10,count:118,lastPage:12}),l=(s="")=>{s==""&&S(s),k(!0),A.custom(`?search=${s}&page=${d.page}&size=${d.size}`,"GET").then(i=>{var L,C;v(s.length<1),u((L=i==null?void 0:i.data)==null?void 0:L.entry),f((C=i==null?void 0:i.data)==null?void 0:C.pagination),k(!1)}).catch(i=>{x(i)})},j=s=>{let i=h[s];N(i),_(!b)},e=async s=>{if(await oa("Hapus","Yakin ingin hapus data ini ?")){let i=h[s];A.custom(`/${i.uuid}`,"DELETE").then(()=>{G("Berhasil","Data berhasil dihapus"),l()}).catch(L=>{x(L)})}},c=({selected:s})=>{let i=d;i.page=s+1,f(i),l()},o=s=>{let i=d;i.size=s,i.page=1,f(i),l()};return r.useEffect(()=>{l()},[]),a.jsx(ua,{isLoading:m,children:a.jsxs("div",{children:[a.jsx(ca,{title:"Daftar Barang"}),b?a.jsx(ja,{setAddDaftarBarangEvent:()=>_(!1),getData:l,daftarBarangEdit:y}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:B,onChange:s=>S(s.target.value)}),w?a.jsx(na,{onClick:()=>{l(B)},className:"cursor-pointer"}):a.jsx(q,{onClick:()=>l(""),className:"cursor-pointer"})]}),a.jsxs("div",{className:"flex gap-x-2 items-center",children:[a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{N(null),_(!b)},children:[a.jsx(sa,{})," Tambah Daftar Barang"]}),a.jsx("div",{className:"hidden",children:a.jsx(ba,{data:h,ref:D,bulan:la(new Date().getMonth()),tahun:t.tahun})}),a.jsxs("button",{onClick:p,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[a.jsx(ra,{})," Cetak Daftar Barang"]})]})]}),a.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Daftar Barang"}),a.jsx("th",{children:"Kategori Barang"}),a.jsx("th",{children:"Jenis Barang"}),a.jsx("th",{children:"Jenis Penjualan Barang"}),a.jsx("th",{children:"PPN"}),a.jsx("th",{children:"Aksi"})]})}),a.jsx("tbody",{children:h==null?void 0:h.map((s,i)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[i+1,"."]}),a.jsx("td",{children:s.name}),a.jsx("td",{children:s.kategori_barang_name}),a.jsx("td",{children:s.jenis_barang_name}),a.jsx("td",{children:s.jenis_penjualan_barang_name}),a.jsx("td",{children:s.ppn==1?"Ya":"Tidak"}),a.jsxs("td",{className:"flex gap-x-2",children:[a.jsx(ia,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{j(i)}}),a.jsx(z,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{e(i)}})]})]},i)}))})]})}),a.jsx(ga,{paginateUpdatePage:c,paginate:d,setSize:o})]})]})})};export{Fa as default};
