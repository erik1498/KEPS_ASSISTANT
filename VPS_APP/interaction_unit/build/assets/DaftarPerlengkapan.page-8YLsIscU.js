import{r as l,O as A,j as e,b as V,h as q,a0 as M,s as m,a2 as Y,ay as J,k as Q,az as I,n as $,R as X,u as Z,o as E,e as ee,p as ae,i as te,c as se,a as ne,F as le,q as oe}from"./index-QngEOzN_.js";import{P as re}from"./PageTitle-ByHsc4p5.js";import{e as R,W as ie}from"./Wrap-BCfnb039.js";import{P as ce}from"./Pagination-D3WNYDRv.js";import{F as h}from"./FormInputWithLabel-Bx4cKmcq.js";import{i as F}from"./actionEvent.helper-CSfRBgS8.js";import{F as z}from"./FormSelectWithLabel-BCV4i4Bv.js";import{p as g}from"./number.helper-_FlTjox4.js";import{P as ue,l as he}from"./PDFHeader-2lYxv13s.js";import"./FormInput-D113t21y.js";import"./index-BKNjMPK8.js";const ge=({setAddDaftarPerlengkapanEvent:r=()=>{},daftarPerlengkapanEdit:a,getData:o=()=>{}})=>{const[b,x]=l.useState([]),[N,j]=l.useState([]),[D,B]=l.useState([]),[v,L]=l.useState(a!=null&&a.name?a.name:""),[d,_]=l.useState(a!=null&&a.nomor_invoice?a.nomor_invoice:""),[y,w]=l.useState(a!=null&&a.tanggal_beli?a.tanggal_beli:A()),[f,i]=l.useState(a!=null&&a.supplier?a.supplier:""),[p,c]=l.useState(a!=null&&a.kuantitas?g(a.kuantitas):""),[k,S]=l.useState(a!=null&&a.satuan_barang?a.satuan_barang:""),[P,C]=l.useState(a!=null&&a.harga_satuan?g(a.harga_satuan):""),[s,n]=l.useState(a!=null&&a.dpp?g(a.dpp):""),[u,T]=l.useState(a!=null&&a.ppn?g(a.ppn):""),[O,K]=l.useState(a!=null&&a.kategori_perlengkapan?a.kategori_perlengkapan:""),H=()=>{M.custom("","GET").then(t=>{if(x(t.data.entry),t.data.entry.length>0){if(a){R({editObject:a.supplier,dataList:t.data.entry,setState:i,labelKey:"name",valueKey:"uuid"});return}i({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}}).catch(t=>{m(t)})},U=()=>{Y.custom("","GET").then(t=>{if(j(t.data.entry),t.data.entry.length>0){if(a){R({editObject:a.satuan_barang,dataList:t.data.entry,setState:S,labelKey:"name",valueKey:"uuid"});return}S({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}}).catch(t=>{m(t)})},G=()=>{J.custom("","GET").then(t=>{if(B(t.data.entry),t.data.entry.length>0){if(a){R({editObject:a.kategori_perlengkapan,dataList:t.data.entry,setState:K,labelKey:"name",valueKey:"uuid"});return}K({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}}).catch(t=>{m(t)})},W=async()=>{await Q()&&I.custom(`${a!=null&&a.uuid?`/${a.uuid}`:""}`,a?"PUT":"POST",null,{data:{name:v,nomor_invoice:d,tanggal_beli:y,kategori_perlengkapan:O.value,supplier:f.value,kuantitas:p,satuan_barang:k.value,harga_satuan:P,dpp:s,ppn:u}}).then(()=>{a?$("Berhasil","Data berhasil diupdate"):$("Berhasil","Data berhasil disimpan"),r(),o()}).catch(t=>{m(t)})};return l.useEffect(()=>{H(),U(),G()},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[e.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[e.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[a?"Edit":"Tambahkan"," Daftar Perlengkapan"]}),e.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>r(),children:[e.jsx(V,{})," Batalkan Daftar Perlengkapan"]})]}),e.jsxs("div",{className:"flex gap-x-2",children:[e.jsx(h,{label:"Nama Perlengkapan",type:"text",onchange:t=>{L(t.target.value)},others:{value:v,name:"namaDaftarPerlengkapan"}}),e.jsx(h,{label:"Nomor Invoice",type:"text",onchange:t=>{_(t.target.value)},others:{value:d,name:"nomorInvoiceDaftarPerlengkapan"}}),e.jsx(h,{label:"Tanggal Beli",type:"datetime-local",onchange:t=>{w(t.target.value)},others:{value:y,name:"tanggalBeliDaftarPerlengkapan"}}),e.jsx(z,{label:"Kategori Perlengkapan",optionsDataList:D,optionsLabel:"name",optionsValue:"uuid",selectValue:O,onchange:t=>{K(t)},selectName:"kategoriPerlengkapanDaftarPerlengkapan"})]}),e.jsxs("div",{className:"mt-5 flex gap-x-2",children:[e.jsx(z,{label:"Supplier",optionsDataList:b,optionsLabel:"name",optionsValue:"uuid",selectValue:f,onchange:t=>{i(t)},selectName:"supplierDaftarPerlengkapan"}),e.jsx(h,{label:"Kuantitas",type:"text",onchange:t=>{F(t),c(t.target.value)},others:{value:p,name:"kuantitasDaftarPerlengkapan"}}),e.jsx(z,{label:"Satuan Barang",optionsDataList:N,optionsLabel:"name",optionsValue:"uuid",selectValue:k,onchange:t=>{S(t)},selectName:"satuanBarangDaftarPerlengkapan"}),e.jsx(h,{label:"Harga Satuan",type:"text",onchange:t=>{F(t),C(t.target.value)},others:{value:P,name:"hargaSatuanDaftarPerlengkapan"}})]}),e.jsxs("div",{className:"mt-5 flex gap-x-2",children:[e.jsx(h,{label:"DPP",type:"text",onchange:t=>{F(t),n(t.target.value)},others:{value:s,name:"DPPDaftarPerlengkapan"}}),e.jsx(h,{label:"PPN",type:"text",onchange:t=>{F(t),T(t.target.value)},others:{value:u,name:"PPNDaftarPerlengkapan"}})]}),e.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",onClick:()=>{W()},children:[e.jsx(q,{})," Simpan"]})]})})},xe=X.forwardRef((r,a)=>{var o;return e.jsxs("div",{ref:a,children:[e.jsx(ue,{bulan:r.bulan,tahun:r.tahun,title:"Daftar Perlengkapan"}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[e.jsx("th",{width:12,children:"No"}),e.jsx("th",{children:"Nama Daftar Perlengkapan"})]})}),e.jsx("tbody",{children:(o=r==null?void 0:r.data)==null?void 0:o.map((b,x)=>e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{children:x+1}),e.jsx("td",{children:b.name})]},x)}))})]})]})}),we=()=>{const r=Z(),{data:a}=r,[o,b]=l.useState([]),[x,N]=l.useState(!1),[j,D]=l.useState(!1),[B,v]=l.useState({name:""}),[L,d]=l.useState(!1),[_,y]=l.useState(""),w=l.useRef(),f=he.useReactToPrint({content:()=>w.current}),[i,p]=l.useState({page:1,size:10,count:118,lastPage:12}),c=(s="")=>{s==""&&y(s),N(!0),I.custom(`?search=${s}&page=${i.page}&size=${i.size}`,"GET").then(n=>{var u,T;d(s.length<1),b((u=n==null?void 0:n.data)==null?void 0:u.entry),p((T=n==null?void 0:n.data)==null?void 0:T.pagination),N(!1)}).catch(n=>{m(n)})},k=s=>{let n=o[s];v(n),D(!j)},S=async s=>{if(await oe("Hapus","Yakin ingin hapus data ini ?")){let n=o[s];I.custom(`/${n.uuid}`,"DELETE").then(()=>{$("Berhasil","Data berhasil dihapus"),c()}).catch(u=>{m(u)})}},P=({selected:s})=>{let n=i;n.page=s+1,p(n),c()},C=s=>{let n=i;n.size=s,n.page=1,p(n),c()};return l.useEffect(()=>{c()},[]),e.jsx(ie,{isLoading:x,children:e.jsxs("div",{children:[e.jsx(re,{title:"Daftar Perlengkapan"}),j?e.jsx(ge,{setAddDaftarPerlengkapanEvent:()=>D(!1),getData:c,daftarPerlengkapanEdit:B}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[e.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[e.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:_,onChange:s=>y(s.target.value)}),L?e.jsx(E,{onClick:()=>{c(_)},className:"cursor-pointer"}):e.jsx(V,{onClick:()=>c(""),className:"cursor-pointer"})]}),e.jsxs("div",{className:"flex gap-x-2 items-center",children:[e.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{v(null),D(!j)},children:[e.jsx(ee,{})," Tambah Daftar Perlengkapan"]}),e.jsx("div",{className:"hidden",children:e.jsx(xe,{data:o,ref:w,bulan:ae(new Date().getMonth()),tahun:a.tahun})}),e.jsxs("button",{onClick:f,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[e.jsx(te,{})," Cetak Daftar Perlengkapan"]})]})]}),e.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[e.jsx("th",{width:12,children:"No"}),e.jsx("th",{children:"Nama Daftar Perlengkapan"}),e.jsx("th",{children:"Nomor Invoice"}),e.jsx("th",{children:"Tanggal Beli"}),e.jsx("th",{children:"Kategori Perlengkapan"}),e.jsx("th",{children:"Total Beli"}),e.jsx("th",{children:"DPP"}),e.jsx("th",{children:"PPN"}),e.jsx("th",{children:"Aksi"})]})}),e.jsx("tbody",{children:o==null?void 0:o.map((s,n)=>e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsxs("td",{children:[n+1,"."]}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.nomor_invoice}),e.jsx("td",{children:`${s.tanggal_beli.split("T")[0]} ${se(s.tanggal_beli.split("T")[1])}`}),e.jsx("td",{children:s.kategori_perlengkapan_name}),e.jsx("td",{children:g(s.harga_satuan*s.kuantitas)}),e.jsx("td",{children:g(s.dpp)}),e.jsx("td",{children:g(s.ppn)}),e.jsxs("td",{className:"flex gap-x-2",children:[e.jsx(ne,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{k(n)}}),e.jsx(le,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{S(n)}})]})]},n)}))})]})}),e.jsx(ce,{paginateUpdatePage:P,paginate:i,setSize:C})]})]})})};export{we as default};
