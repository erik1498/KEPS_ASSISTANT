import{r as l,a7 as J,p as g,j as e,d as H,Q as K,m as X,an as Z,as as B,t as x,at as E,U as ee,aO as ae,o as te,aP as I,v as V,R as se,w as ne,W as le,x as oe,y as ie,l as re,z as ce,n as ue,c as he,b as xe,F as ge,D as pe}from"./index-Dz0IAc1t.js";import{P as me}from"./Pagination-BmvIQq8E.js";import{F as h}from"./FormInputWithLabel-3H0YkeHW.js";import{i as C}from"./actionEvent.helper-C3J6IymX.js";import{l as be}from"./index-CLFgxKRx.js";import{P as je}from"./PDFHeader-DubrWhyn.js";import"./react-paginate-DtnFUk4C.js";import"./index-BKNjMPK8.js";const De=({setAddDaftarPerlengkapanEvent:r=()=>{},daftarPerlengkapanEdit:a,getData:o=()=>{}})=>{const[b,p]=l.useState([]),[S,j]=l.useState([]),[D,F]=l.useState([]),[k,f]=l.useState([]),[d,N]=l.useState(a!=null&&a.name?a.name:""),[v,_]=l.useState(a!=null&&a.nomor_invoice?a.nomor_invoice:""),[w,c]=l.useState(a!=null&&a.tanggal_beli?a.tanggal_beli:J()),[m,i]=l.useState(a!=null&&a.supplier?a.supplier:""),[L,R]=l.useState(a!=null&&a.kuantitas?g(a.kuantitas):""),[P,y]=l.useState(a!=null&&a.satuan_barang?a.satuan_barang:""),[s,n]=l.useState(a!=null&&a.harga_satuan?g(a.harga_satuan):""),[u,T]=l.useState(a!=null&&a.dpp?g(a.dpp):""),[z,G]=l.useState(a!=null&&a.ppn?g(a.ppn):""),[O,A]=l.useState(a!=null&&a.kode_akun_perkiraan?a.kode_akun_perkiraan:""),[U,$]=l.useState(a!=null&&a.kategori_perlengkapan?a.kategori_perlengkapan:""),W=()=>{Z.custom("","GET").then(t=>{if(p(t.data.entry),t.data.entry.length>0){if(a){B({editObject:a.supplier,dataList:t.data.entry,setState:i,labelKey:"name",valueKey:"uuid"});return}i({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}}).catch(t=>{x(t)})},M=()=>{E.custom("","GET").then(t=>{if(j(t.data.entry),t.data.entry.length>0){if(a){B({editObject:a.satuan_barang,dataList:t.data.entry,setState:y,labelKey:"name",valueKey:"uuid"});return}y({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}}).catch(t=>{x(t)})},Q=()=>{ee.custom("/kas_bank","GET").then(t=>{if(F(t.data),t.data.length>0){if(a){B({editObject:a.kode_akun_perkiraan,dataList:t.data,setState:A,labelKey:"name",valueKey:"uuid"});return}A({label:`${t.data[0].code} - ${t.data[0].name}`,value:t.data[0].uuid})}}).catch(t=>{x(t)})},Y=()=>{ae.custom("","GET").then(t=>{if(f(t.data.entry),t.data.entry.length>0){if(a){B({editObject:a.kategori_perlengkapan,dataList:t.data.entry,setState:$,labelKey:"name",valueKey:"uuid"});return}$({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}}).catch(t=>{x(t)})},q=async()=>{await te()&&I.custom(`${a!=null&&a.uuid?`/${a.uuid}`:""}`,a?"PUT":"POST",null,{data:{name:d,nomor_invoice:v,tanggal_beli:w,kategori_perlengkapan:U.value,supplier:m.value,kuantitas:L,kode_akun_perkiraan:O.value,satuan_barang:P.value,harga_satuan:s,dpp:u,ppn:z}}).then(()=>{a?V("Berhasil","Data berhasil diupdate"):V("Berhasil","Data berhasil disimpan"),r(),o()}).catch(t=>{x(t)})};return l.useEffect(()=>{W(),M(),Q(),Y()},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[e.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[e.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[a?"Edit":"Tambahkan"," Daftar Perlengkapan"]}),e.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>r(),children:[e.jsx(H,{})," Batalkan Daftar Perlengkapan"]})]}),e.jsxs("div",{className:"flex gap-x-2",children:[e.jsx(h,{label:"Nama Perlengkapan",type:"text",onchange:t=>{N(t.target.value)},others:{value:d,name:"namaDaftarPerlengkapan"}}),e.jsx(h,{label:"Nomor Invoice",type:"text",onchange:t=>{_(t.target.value)},others:{value:v,name:"nomorInvoiceDaftarPerlengkapan"}}),e.jsx(h,{label:"Tanggal Beli",type:"datetime-local",onchange:t=>{c(t.target.value)},others:{value:w,name:"tanggalBeliDaftarPerlengkapan"}}),e.jsx(K,{label:"Kode Akun",optionsDataList:D,optionsLabel:["code","name"],optionsLabelIsArray:!0,optionsValue:"uuid",optionsDelimiter:"-",selectValue:O,onchange:t=>{A(t)},selectName:"kodeAkunPerkiraanDaftarPerlengkapan"}),e.jsx(K,{label:"Kategori Perlengkapan",optionsDataList:k,optionsLabel:"name",optionsValue:"uuid",selectValue:U,onchange:t=>{$(t)},selectName:"kategoriPerlengkapanDaftarPerlengkapan"})]}),e.jsxs("div",{className:"mt-5 flex gap-x-2",children:[e.jsx(K,{label:"Supplier",optionsDataList:b,optionsLabel:"name",optionsValue:"uuid",selectValue:m,onchange:t=>{i(t)},selectName:"supplierDaftarPerlengkapan"}),e.jsx(h,{label:"Kuantitas",type:"text",onchange:t=>{C(t),R(t.target.value)},others:{value:L,name:"kuantitasDaftarPerlengkapan"}}),e.jsx(K,{label:"Satuan Barang",optionsDataList:S,optionsLabel:"name",optionsValue:"uuid",selectValue:P,onchange:t=>{y(t)},selectName:"satuanBarangDaftarPerlengkapan"}),e.jsx(h,{label:"Harga Satuan",type:"text",onchange:t=>{C(t),n(t.target.value)},others:{value:s,name:"hargaSatuanDaftarPerlengkapan"}})]}),e.jsxs("div",{className:"mt-5 flex gap-x-2",children:[e.jsx(h,{label:"DPP",type:"text",onchange:t=>{C(t),T(t.target.value)},others:{value:u,name:"DPPDaftarPerlengkapan"}}),e.jsx(h,{label:"PPN",type:"text",onchange:t=>{C(t),G(t.target.value)},others:{value:z,name:"PPNDaftarPerlengkapan"}})]}),e.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",onClick:()=>{q()},children:[e.jsx(X,{})," Simpan"]})]})})},ve=se.forwardRef((r,a)=>{var o;return e.jsxs("div",{ref:a,children:[e.jsx(je,{bulan:r.bulan,tahun:r.tahun,title:"Daftar Perlengkapan"}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[e.jsx("th",{width:12,children:"No"}),e.jsx("th",{children:"Nama Daftar Perlengkapan"})]})}),e.jsx("tbody",{children:(o=r==null?void 0:r.data)==null?void 0:o.map((b,p)=>e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{children:p+1}),e.jsx("td",{children:b.name})]},p)}))})]})]})}),Pe=()=>{const r=ne(),{data:a}=r,[o,b]=l.useState([]),[p,S]=l.useState(!1),[j,D]=l.useState(!1),[F,k]=l.useState({name:""}),[f,d]=l.useState(!1),[N,v]=l.useState(""),_=l.useRef(),w=be.useReactToPrint({content:()=>_.current}),[c,m]=l.useState({page:1,size:10,count:118,lastPage:12}),i=(s="")=>{s==""&&v(s),S(!0),I.custom(`?search=${s}&page=${c.page}&size=${c.size}`,"GET").then(n=>{var u,T;d(s.length<1),b((u=n==null?void 0:n.data)==null?void 0:u.entry),m((T=n==null?void 0:n.data)==null?void 0:T.pagination),S(!1)}).catch(n=>{x(n)})},L=s=>{let n=o[s];k(n),D(!j)},R=async s=>{if(await pe("Hapus","Yakin ingin hapus data ini ?")){let n=o[s];I.custom(`/${n.uuid}`,"DELETE").then(()=>{V("Berhasil","Data berhasil dihapus"),i()}).catch(u=>{x(u)})}},P=({selected:s})=>{let n=c;n.page=s+1,m(n),i()},y=s=>{let n=c;n.size=s,n.page=1,m(n),i()};return l.useEffect(()=>{i()},[]),e.jsx(le,{isLoading:p,children:e.jsxs("div",{children:[e.jsx(oe,{title:"Daftar Perlengkapan"}),j?e.jsx(De,{setAddDaftarPerlengkapanEvent:()=>D(!1),getData:i,daftarPerlengkapanEdit:F}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[e.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[e.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:N,onChange:s=>v(s.target.value)}),f?e.jsx(ie,{onClick:()=>{i(N)},className:"cursor-pointer"}):e.jsx(H,{onClick:()=>i(""),className:"cursor-pointer"})]}),e.jsxs("div",{className:"flex gap-x-2 items-center",children:[e.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{k(null),D(!j)},children:[e.jsx(re,{})," Tambah Daftar Perlengkapan"]}),e.jsx("div",{className:"hidden",children:e.jsx(ve,{data:o,ref:_,bulan:ce(new Date().getMonth()),tahun:a.tahun})}),e.jsxs("button",{onClick:w,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[e.jsx(ue,{})," Cetak Daftar Perlengkapan"]})]})]}),e.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[e.jsx("th",{width:12,children:"No"}),e.jsx("th",{children:"Nama Daftar Perlengkapan"}),e.jsx("th",{children:"Nomor Invoice"}),e.jsx("th",{children:"Tanggal Beli"}),e.jsx("th",{children:"Kategori Perlengkapan"}),e.jsx("th",{children:"Total Beli"}),e.jsx("th",{children:"DPP"}),e.jsx("th",{children:"PPN"}),e.jsx("th",{children:"Aksi"})]})}),e.jsx("tbody",{children:o==null?void 0:o.map((s,n)=>e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsxs("td",{children:[n+1,"."]}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.nomor_invoice}),e.jsx("td",{children:`${s.tanggal_beli.split("T")[0]} ${he(s.tanggal_beli.split("T")[1])}`}),e.jsx("td",{children:s.kategori_perlengkapan_name}),e.jsx("td",{children:g(s.harga_satuan*s.kuantitas)}),e.jsx("td",{children:g(s.dpp)}),e.jsx("td",{children:g(s.ppn)}),e.jsxs("td",{className:"flex gap-x-2",children:[e.jsx(xe,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{L(n)}}),e.jsx(ge,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{R(n)}})]})]},n)}))})]})}),e.jsx(me,{paginateUpdatePage:P,paginate:c,setSize:y})]})]})})};export{Pe as default};
