import{r,j as a,h as $,F as G,k as O,aF as V,s as j,V as M,aa as Q,aG as T,b as Y,aH as A,n as z,ab as X,ac as Z,ad as E,R as aa,u as ea,o as ta,e as sa,p as na,i as la,a as ia,q as ra}from"./index-DHco5UoW.js";import{P as ca}from"./PageTitle-DhSJ_t28.js";import{k as C,f as P,e as R,W as oa}from"./Wrap-UDT2yOyM.js";import{P as ua}from"./Pagination-BRJ4tswB.js";import{F as U}from"./FormInputWithLabel-Be1eo8uL.js";import{F as L}from"./FormSelectWithLabel-C9nmHSNn.js";import{i as B}from"./actionEvent.helper-CSfRBgS8.js";import{p as I}from"./number.helper-_FlTjox4.js";import{F as W}from"./FormInput-DQocwEvt.js";import{P as ha,l as da}from"./PDFHeader-CVMgwoPg.js";import"./index-BKNjMPK8.js";const ja=({idDaftarJasa:h,kategoriHargaJasaList:t})=>{const[d,u]=r.useState(),[m,k]=r.useState(t.length>0?{label:t[0].kode_jasa,value:t[0].uuid}:null),[b,_]=r.useState(0),[v,y]=r.useState([]),[D,J]=r.useState([]),N=async l=>{l.preventDefault(),await O(l.target)&&V.custom("","POST",null,{data:{daftar_jasa:h,cabang:d.value,kategori_harga_jasa:m.value,jumlah:`${b}`}}).then(()=>{f()}).catch(x=>{j(x)})},S=()=>{M.custom("","GET").then(l=>{y(l.data.entry),l.data.entry.length>0&&u({label:l.data.entry[0].name,value:l.data.entry[0].uuid})}).catch(l=>{j(l)})},f=()=>{V.custom(`/${h}`,"GET").then(l=>{J(l.data)}).catch(l=>{j(l)})},p=l=>{V.custom(`/${l.uuid}`,"DELETE").catch(x=>{j(x)}).finally(()=>f())};return r.useEffect(()=>{S(),f()},[]),a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"mt-16 mb-5 uppercase text-gray-600 font-bold",children:"Stok Awal Jasa"}),a.jsx("form",{onSubmit:l=>N(l),className:"pb-6",children:a.jsxs("div",{className:"flex gap-x-2 items-end",children:[a.jsx(L,{label:"Cabang Jasa",optionsDataList:v,optionsLabel:"name",optionsValue:"uuid",selectValue:d,onchange:l=>{u(l)},selectName:"cabangJasa"}),a.jsx(L,{label:"Kode Jasa",optionsDataList:t,optionsLabel:"kode_jasa",optionsValue:"uuid",selectValue:m,onchange:l=>{k(l)},selectName:"kategoriHargaJasa"}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx($,{})," Simpan"]})]})}),a.jsxs("table",{className:"table table-sm table-zebra",children:[a.jsxs("thead",{className:"py-4 text-black",children:[a.jsx("th",{children:"No"}),a.jsx("th",{children:"Daftar Cabang Name"}),a.jsx("th",{children:"Kode Jasa"}),a.jsx("th",{children:"Satuan"}),a.jsx("th",{children:"Aksi"})]}),a.jsx("tbody",{children:D.map((l,x)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:x+1}),a.jsx("td",{children:l.cabang_name}),a.jsx("td",{children:l.kategori_harga_jasa_kode_jasa}),a.jsx("td",{children:l.satuan_jasa_name}),a.jsx("td",{width:100,children:a.jsx("div",{className:"flex gap-x-2",children:a.jsx(G,{onClick:()=>p(l),className:"text-red-500 cursor-pointer",size:12})})})]})}))})]})]})},xa=({idDaftarJasa:h})=>{const[t,d]=r.useState(!1),[u,m]=r.useState([]),[k,b]=r.useState([]),[_,v]=r.useState(),[y,D]=r.useState(),[J,N]=r.useState([]),S=()=>{v(e=>null),b(e=>[]),d(e=>!1),Q.custom("","GET").then(e=>{b(e.data.entry),d(o=>!0),v({label:e.data.entry[0].name,value:e.data.entry[0].uuid})}).catch(e=>{j(e)})},f=async e=>{if(e.preventDefault(),await O(e.target)){let o={daftar_jasa:h,satuan_jasa:_.value,kode_jasa:y};C.map((i,n)=>{o[`harga_${i.value}`]=J[n]}),T.custom("","POST",null,{data:o}).then(()=>{p()}).catch(i=>{j(i)})}},p=()=>{T.custom(`/${h}`,"GET").then(e=>{m(o=>e.data.entry)}).catch(e=>{j(e)})},l=e=>{let o={daftar_jasa:e.daftar_jasa,satuan_jasa:e.satuan_jasa,kode_jasa:e.kode_jasa};C.filter(i=>i.value!="beli").map((i,n)=>{o[`harga_${i.value}`]=`${e[`harga_${i.value}`]}`}),T.custom(`/${e.uuid}`,"PUT",null,{data:o}).catch(i=>{j(i)}).finally(()=>p())},x=e=>{let o={daftar_jasa:e.daftar_jasa,satuan_jasa:e.satuan_jasa,kode_jasa:e.kode_jasa};C.map((i,n)=>{o[`harga_${i.value}`]=`${e[`harga_${n+1}`]}`}),T.custom(`/${e.uuid}`,"DELETE").catch(i=>{j(i)}).finally(()=>p())},g=(e,o,i)=>{const n=u.findIndex(c=>c.uuid==i);if(n!=-1){let c=u;c.at(n)[`harga_${o}`]=I(e),m(w=>c)}},F=(e,o)=>{const i=u.findIndex(n=>n.uuid==o);if(i!=-1){let n=u;n.at(i).kode_jasa=e,m(c=>n)}};return r.useEffect(()=>{S()},[u]),r.useEffect(()=>{p()},[]),a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"mt-16 mb-5 uppercase text-gray-600 font-bold",children:"Kategori Harga"}),t?a.jsxs("form",{onSubmit:e=>f(e),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(L,{label:"Satuan Jasa",optionsDataList:k,optionsLabel:"name",optionsValue:"uuid",selectValue:_,onchange:e=>{v(e)},selectName:"satuanJasa"}),a.jsx(U,{label:"Kode Jasa",type:"text",onchange:e=>{D(e.target.value)},others:{value:y,name:"kodeJasa"}})]}),a.jsx("div",{className:"mt-5 flex gap-x-2",children:C.filter(e=>e.value!="beli").map((e,o)=>a.jsx(a.Fragment,{children:a.jsx(U,{label:e.label,type:"text",onchange:i=>{B(i);const n=[...J];n[o]=i.target.value,N(c=>n)},others:{value:J[o],name:`hargaJasa[${o}]`}})}))}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx($,{})," Simpan"]})]}):a.jsx(a.Fragment,{}),a.jsxs("table",{className:"mt-5 table table-sm table-zebra",children:[a.jsxs("thead",{className:"py-4 text-black",children:[a.jsx("th",{children:"No"}),a.jsx("th",{children:"Satuan Jasa"}),a.jsx("th",{children:"Kode Jasa"}),C.filter(e=>e.value!="beli").map(e=>a.jsx("th",{children:e.label})),a.jsx("th",{children:"Aksi"})]}),a.jsx("tbody",{children:u.map((e,o)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:o+1}),a.jsx("td",{children:e.satuan_jasa_name}),a.jsx("td",{children:a.jsx(W,{name:"kode_jasa"+o,type:"text",other:{defaultValue:e.kode_jasa},onchange:i=>{F(i.target.value,e.uuid)}})}),C.filter(i=>i.value!="beli").map(i=>a.jsx("td",{width:150,children:a.jsx(W,{name:"harga_"+i.value,type:"text",other:{defaultValue:I(e[`harga_${i.value}`])},onchange:n=>{B(n),g(n.target.value,i.value,e.uuid)}})})),a.jsx("td",{width:100,children:a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx($,{onClick:()=>l(e),className:"text-green-800 cursor-pointer",size:12}),a.jsx(G,{onClick:()=>x(e),className:"text-red-500 cursor-pointer",size:12})]})})]})}))})]}),a.jsx(ja,{idDaftarJasa:h,kategoriHargaJasaList:u})]})},ma=({setAddDaftarJasaEvent:h=()=>{},daftarJasaEdit:t,getData:d=()=>{}})=>{const[u,m]=r.useState(!1),[k,b]=r.useState(t!=null&&t.uuid?t.uuid:null),[_,v]=r.useState([]),[y,D]=r.useState([]),[J,N]=r.useState([]),[S,f]=r.useState(t!=null&&t.name?t.name:""),[p,l]=r.useState(t!=null&&t.kategori_jasa?t.kategori_jasa:""),[x,g]=r.useState(t!=null&&t.jenis_jasa?t.jenis_jasa:""),[F,e]=r.useState(t!=null&&t.jenis_penjualan_jasa?t.jenis_penjualan_jasa:""),[o,i]=r.useState(t!=null&&t.ppn?{label:P.filter(s=>s.value==t.ppn).at(0).label,value:P.filter(s=>s.value==t.ppn).at(0).value}:{label:P[0].label,value:P[0].value}),n=async s=>{s.preventDefault(),await O(s.target)&&A.custom(`${t!=null&&t.uuid?`/${t.uuid}`:""}`,t?"PUT":"POST",null,{data:{name:S,kategori_jasa:p.value,jenis_jasa:x.value,jenis_penjualan_jasa:F.value,ppn:o.value,status:1}}).then(H=>{t?z("Berhasil","Data berhasil diupdate"):(b(q=>H.data.uuid),z("Berhasil","Data berhasil disimpan")),m(q=>!0)}).catch(H=>{j(H)})},c=()=>{X.custom("","GET").then(s=>{if(v(s.data.entry),s.data.entry.length>0){if(t){R({editObject:t.kategori_jasa,dataList:s.data.entry,setState:l,labelKey:"name",valueKey:"uuid"});return}l({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>{j(s)})},w=()=>{Z.custom("","GET").then(s=>{if(D(s.data.entry),s.data.entry.length>0){if(t){R({editObject:t.jenis_jasa,dataList:s.data.entry,setState:g,labelKey:"name",valueKey:"uuid"});return}g({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>{j(s)})},K=()=>{E.custom("","GET").then(s=>{if(N(s.data.entry),s.data.entry.length>0){if(t){R({editObject:t.jenis_penjualan_jasa,dataList:s.data.entry,setState:e,labelKey:"name",valueKey:"uuid"});return}e({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>{j(s)})};return r.useEffect(()=>{c(),w(),K()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[t?"Edit":"Tambahkan"," Daftar Jasa"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>h(),children:[a.jsx(Y,{})," Batalkan Daftar Jasa"]})]}),a.jsxs("form",{onSubmit:s=>n(s),children:[a.jsx("div",{className:"flex gap-x-2",children:a.jsx(U,{label:"Nama Daftar Jasa",type:"text",onchange:s=>{f(s.target.value)},others:{value:S,name:"namaDaftarJasa",disabled:u}})}),a.jsxs("div",{className:"mt-5 flex gap-x-2",children:[a.jsx(L,{label:"Kategori Jasa",optionsDataList:_,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:p,onchange:s=>{l(s)},selectName:"kategoriDaftarJasa"}),a.jsx(L,{label:"Jenis Jasa",optionsDataList:y,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:x,onchange:s=>{g(s)},selectName:"JenisDaftarJasa"}),a.jsx(L,{label:"Jenis Penjualan Jasa",optionsDataList:J,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:F,onchange:s=>{e(s)},selectName:"jenisPenjualanDaftarJasa"})]}),a.jsx("div",{className:"mt-5 flex -gap-x-2",children:a.jsx(L,{label:"PPN",optionsDataList:P,optionsLabel:"label",optionsValue:"value",disabled:u,selectValue:o,onchange:s=>{i(s)},selectName:"ppnDaftarJasa"})}),u?a.jsx(a.Fragment,{}):a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx($,{})," Simpan"]})]}),u?a.jsx(xa,{idDaftarJasa:k}):a.jsx(a.Fragment,{})]})})},ga=aa.forwardRef((h,t)=>{var d;return a.jsxs("div",{ref:t,children:[a.jsx(ha,{bulan:h.bulan,tahun:h.tahun,title:"Daftar Jasa"}),a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Daftar Jasa"}),a.jsx("th",{children:"Kode Daftar Jasa"})]})}),a.jsx("tbody",{children:(d=h==null?void 0:h.data)==null?void 0:d.map((u,m)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:m+1}),a.jsx("td",{children:u.name}),a.jsx("td",{children:u.code})]},m)}))})]})]})}),wa=()=>{const h=ea(),{data:t}=h,[d,u]=r.useState([]),[m,k]=r.useState(!1),[b,_]=r.useState(!1),[v,y]=r.useState({name:""}),[D,J]=r.useState(!1),[N,S]=r.useState(""),f=r.useRef(),p=da.useReactToPrint({content:()=>f.current}),[l,x]=r.useState({page:1,size:10,count:118,lastPage:12}),g=(n="")=>{n==""&&S(n),k(!0),A.custom(`?search=${n}&page=${l.page}&size=${l.size}`,"GET").then(c=>{var w,K;J(n.length<1),u((w=c==null?void 0:c.data)==null?void 0:w.entry),x((K=c==null?void 0:c.data)==null?void 0:K.pagination),k(!1)}).catch(c=>{j(c)})},F=n=>{let c=d[n];y(c),_(!b)},e=async n=>{if(await ra("Hapus","Yakin ingin hapus data ini ?")){let c=d[n];A.custom(`/${c.uuid}`,"DELETE").then(()=>{z("Berhasil","Data berhasil dihapus"),g()}).catch(w=>{j(w)})}},o=({selected:n})=>{let c=l;c.page=n+1,x(c),g()},i=n=>{let c=l;c.size=n,c.page=1,x(c),g()};return r.useEffect(()=>{g()},[]),a.jsx(oa,{isLoading:m,children:a.jsxs("div",{children:[a.jsx(ca,{title:"Daftar Jasa"}),b?a.jsx(ma,{setAddDaftarJasaEvent:()=>_(!1),getData:g,daftarJasaEdit:v}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:N,onChange:n=>S(n.target.value)}),D?a.jsx(ta,{onClick:()=>{g(N)},className:"cursor-pointer"}):a.jsx(Y,{onClick:()=>g(""),className:"cursor-pointer"})]}),a.jsxs("div",{className:"flex gap-x-2 items-center",children:[a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{y(null),_(!b)},children:[a.jsx(sa,{})," Tambah Daftar Jasa"]}),a.jsx("div",{className:"hidden",children:a.jsx(ga,{data:d,ref:f,bulan:na(new Date().getMonth()),tahun:t.tahun})}),a.jsxs("button",{onClick:p,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[a.jsx(la,{})," Cetak Daftar Jasa"]})]})]}),a.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Daftar Jasa"}),a.jsx("th",{children:"Kategori Jasa"}),a.jsx("th",{children:"Jenis Jasa"}),a.jsx("th",{children:"Jenis Penjualan Jasa"}),a.jsx("th",{children:"PPN"}),a.jsx("th",{children:"Aksi"})]})}),a.jsx("tbody",{children:d==null?void 0:d.map((n,c)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[c+1,"."]}),a.jsx("td",{children:n.name}),a.jsx("td",{children:n.kategori_jasa_name}),a.jsx("td",{children:n.jenis_jasa_name}),a.jsx("td",{children:n.jenis_penjualan_jasa_name}),a.jsx("td",{children:n.ppn==1?"Ya":"Tidak"}),a.jsxs("td",{className:"flex gap-x-2",children:[a.jsx(ia,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{F(c)}}),a.jsx(G,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{e(c)}})]})]},c)}))})]})}),a.jsx(ua,{paginateUpdatePage:o,paginate:l,setSize:i})]})]})})};export{wa as default};
