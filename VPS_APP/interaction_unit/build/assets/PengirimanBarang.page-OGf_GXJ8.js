import{R as q,j as a,f as V,p as J,r as c,a7 as M,d as I,Q as K,m as U,e as Z,n as B,b$ as E,t as k,o as aa,c0 as p,a3 as ea,as as O,bJ as sa,w as la,W as ta,x as na,y as ca,l as da,$ as ra,ae as G,b as ua,F as oa,bX as ha,D as ia,v as ja}from"./index-B7jF3MNC.js";import{P as xa,l as H}from"./PDFHeader-CYtOtnd-.js";import{F as z}from"./FormInputWithLabel-CU9I-2zY.js";import{i as ma}from"./actionEvent.helper-CmDoZHzA.js";import"./react-paginate-qh_xIz_u.js";import"./index-BKNjMPK8.js";const ba=q.forwardRef((l,e)=>{var b,v,y,N,j,h,_,x,S,w,m,f;return a.jsxs("div",{ref:e,children:[a.jsx(xa,{bulan:l==null?void 0:l.bulan,tahun:l==null?void 0:l.tahun,title:"Surat Jalan",useTime:!1}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",children:"KEPADA :"}),a.jsx("p",{children:(b=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:b.customer_name}),a.jsx("p",{children:(v=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:v.customer_code}),a.jsxs("p",{className:"my-4",children:["Alamat:",a.jsx("br",{}),(y=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:y.customer_alamat_kantor]}),a.jsxs("p",{className:"mb-4",children:["HP: ",a.jsx("br",{}),(N=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:N.customer_no_hp]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-bold",children:"TANGGAL :"}),a.jsx("p",{children:V((j=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:j.tanggal)})]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO FAKTUR PENJUALAN BARANG :"}),a.jsx("p",{children:(_=(h=l==null?void 0:l.fakturPenjualanBarang)==null?void 0:h.at(0))==null?void 0:_.nomor_faktur_penjualan_barang})]}),a.jsx("div",{className:"text-right",children:a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO PESANAN PENJUALAN BARANG :"}),a.jsx("p",{children:(x=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:x.nomor_pesanan_penjualan_barang})]})})]}),a.jsx("div",{className:"flex justify-between",children:a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO SURAT JALAN :"}),a.jsx("p",{children:(S=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:S.nomor_surat_jalan})]})}),a.jsx("p",{className:"pt-5",children:"Dikirimkan barang-barang sebagai berikut :"}),a.jsxs("div",{className:"mt-4 grid grid-cols-12 text-sm gap-x-2 py-2 font-bold border-t-2",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("p",{children:"No."})}),a.jsx("div",{className:"col-span-4",children:a.jsx("p",{children:"Kode / Nama Barang"})}),a.jsx("div",{className:"col-span-1",children:a.jsx("p",{children:"Satuan"})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{children:"Pembelian"})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{children:"Telah Dikirim"})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{children:"Jumlah"})})]}),(w=l==null?void 0:l.pengirimanBarangList)==null?void 0:w.map((n,d)=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"py-3 border-y-2",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 py-3 items-center font-bold",children:[a.jsx("div",{className:"col-span-1",children:a.jsxs("p",{className:"text-sm",children:[d+1,"."]})}),a.jsxs("div",{className:"col-span-4",children:[a.jsx("p",{className:"text-sm",children:n==null?void 0:n.kategori_harga_barang_kode_barang}),a.jsx("p",{className:"text-xs font-normal",children:n==null?void 0:n.daftar_gudang_name}),a.jsx("p",{className:"text-sm",children:n==null?void 0:n.daftar_barang_name})]}),a.jsx("div",{className:"col-span-1",children:a.jsx("p",{className:"text-sm",children:n==null?void 0:n.satuan_barang_name})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-sm",children:J(n==null?void 0:n.jumlah)})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-sm",children:J(n==null?void 0:n.jumlah_sudah_dikirim)})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-sm",children:J(n==null?void 0:n.pengiriman)})})]}),a.jsx("p",{className:"font-normal text-xs pb-16",children:"Keterangan"})]})})),a.jsxs("div",{className:"grid grid-cols-12 py-5 gap-5 items-start font-bold",children:[l.gudangList.map(n=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"col-span-4 border-b-2 border-black",children:[a.jsxs("p",{className:"mb-20",children:["Pihak ",n]}),a.jsx("p",{children:" "})]})})),a.jsxs("div",{className:"col-span-4 border-b-2 border-black",children:[a.jsx("p",{className:"mb-20",children:"Penanggung Jawab"}),a.jsx("p",{className:"font-normal",children:(m=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:m.pegawai_penanggung_jawab_name})]}),a.jsxs("div",{className:"col-span-4 border-b-2 border-black",children:[a.jsx("p",{className:"mb-20",children:"Pelaksana"}),a.jsx("p",{className:"font-normal",children:(f=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:f.pegawai_pelaksana_name})]}),a.jsxs("div",{className:"col-span-4 border-b-2 border-black",children:[a.jsx("p",{className:"mb-20",children:"Diterima Oleh"}),a.jsx("p",{children:" "})]})]})]})}),Na=({setAddPengirimanBarangEvent:l=()=>{},pengirimanBarangEdit:e,getData:b=()=>{}})=>{const[v,y]=c.useState([]),[N,j]=c.useState(e!=null&&e.tanggal?e.tanggal:M()),[h,_]=c.useState(e!=null&&e.faktur_penjualan_barang?e.faktur_penjualan_barang:""),[x,S]=c.useState(e!=null&&e.nomor_surat_jalan?e.nomor_surat_jalan:""),[w,m]=c.useState(e!=null&&e.pegawai_penanggung_jawab?e.pegawai_penanggung_jawab:""),[f,n]=c.useState(e!=null&&e.pegawai_pelaksana?e.pegawai_pelaksana:""),[d,L]=c.useState(null),[g,A]=c.useState([]),[T,R]=c.useState([]),[t,r]=c.useState([]),u=async s=>{E.custom(`${t[s].uuid!=""?`/${t[s].uuid}`:""}`,t[s].uuid!=""?"PUT":"POST",null,{data:{pengiriman_barang:d,rincian_pesanan_penjualan_barang:t[s].rincian_pesanan_penjualan_barang,jumlah:`${t[s].jumlah}`,pengiriman:`${t[s].pengiriman}`}}).then(()=>{s+1<t.length?u(s+1):(b(),l())}).catch(o=>{k(o)})},P=c.useRef(),C=H.useReactToPrint({content:()=>P.current}),W=async s=>{s.preventDefault(),await aa(s.target)&&p.custom(e?`/${e.uuid}`:"",e?"PUT":"POST",null,{data:{tanggal:N,faktur_penjualan_barang:h.value,nomor_surat_jalan:x,pegawai_pelaksana:f.value,pegawai_penanggung_jawab:w.value}}).then(o=>{L(e?i=>e.uuid:i=>o.data.uuid)}).catch(o=>{k(o)})},D=()=>{ea.custom("","GET").then(s=>{if(R(s.data.entry),s.data.entry.length>0){if(e){O({editObject:e.pegawai_penanggung_jawab,dataList:s.data.entry,setState:m,labelKey:"name",valueKey:"uuid"}),O({editObject:e.pegawai_pelaksana,dataList:s.data.entry,setState:n,labelKey:"name",valueKey:"uuid"});return}m({label:s.data.entry[0].name,value:s.data.entry[0].uuid}),n({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>k(s))},Q=()=>{sa.custom("","GET").then(s=>{if(A(s.data.entry),s.data.entry.length>0){if(e){O({editObject:e.faktur_penjualan_barang,dataList:s.data.entry,setState:_,labelKey:"nomor_faktur_penjualan_barang",valueKey:"uuid"});return}_({label:s.data.entry[0].nomor_faktur_penjualan_barang,value:s.data.entry[0].uuid})}}).catch(s=>k(s))},X=()=>{p.custom(`/daftar_pesanan/${d}`,"GET").then(s=>{var i;r(s.data);let o=v;(i=s==null?void 0:s.data)==null||i.map(F=>{o.includes(F.daftar_gudang_name)||o.push(F.daftar_gudang_name)}),y(F=>o)}).catch(s=>k(s))},Y=(s,o)=>{const i=t,F=t.findIndex($=>$.rincian_pesanan_penjualan_barang==o);F>-1&&(i[F].pengiriman=s),r($=>i)};return c.useEffect(()=>{d&&X()},[d]),c.useEffect(()=>{Q(),D(),e!=null&&e.preview&&L(e==null?void 0:e.uuid)},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[e?`${e!=null&&e.preview?"Lihat":"Edit"}`:"Tambahkan"," Pengiriman Barang"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>l(),children:[a.jsx(I,{})," ",e!=null&&e.preview?"Tutup":"Batalkan Pengiriman Barang"]})]}),a.jsxs("form",{onSubmit:s=>W(s),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(z,{label:"Tanggal",type:"datetime-local",onchange:s=>{j(s.target.value)},addClassInput:d||e?"border-none !px-1":"",disabled:d||e,others:{value:N,name:"tanggal"}}),a.jsx(K,{label:"Faktur Penjualan Barang",optionsDataList:g,optionsLabel:"nomor_faktur_penjualan_barang",optionsValue:"uuid",selectValue:h,addClass:d||e?"border-none !px-1":"",disabled:d||e,onchange:s=>{_(s)},selectName:"fakturPenjualanBarang"}),a.jsx(z,{label:"Nomor Surat Jalan",type:"text",addClassInput:d||e!=null&&e.preview?"border-none !px-1":"",onchange:s=>{S(s.target.value)},disabled:d||(e==null?void 0:e.preview),others:{value:x,name:"nomorSuratJalan"}}),a.jsx(K,{label:"Pegawai Penanggung Jawab",optionsDataList:T,optionsLabel:"name",optionsValue:"uuid",selectValue:w,addClass:d||e!=null&&e.preview?"border-none !px-1":"",disabled:d||(e==null?void 0:e.preview),onchange:s=>{m(s)},selectName:"pegawaiPenanggungJawab"}),a.jsx(K,{label:"Pegawai Pelaksana",addClass:d||e!=null&&e.preview?"border-none !px-1":"",optionsDataList:T,optionsLabel:"name",optionsValue:"uuid",selectValue:f,disabled:d||(e==null?void 0:e.preview),onchange:s=>{n(s)},selectName:"pegawaiPelaksana"})]}),d?a.jsx(a.Fragment,{}):a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(U,{})," Simpan"]})]}),d?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto rounded-md h-max max-h-[90vh] no-scrollbar mt-5 pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Kode / Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Pembelian"}),a.jsx("th",{children:"Telah Dikirim"}),a.jsx("th",{children:"Jumlah"})]})}),a.jsx("tbody",{children:t==null?void 0:t.map((s,o)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[o+1,"."]}),a.jsxs("td",{children:[a.jsx("b",{children:s.kategori_harga_barang_kode_barang}),a.jsx("br",{}),s.daftar_gudang_name,a.jsx("br",{}),a.jsx("br",{}),s.daftar_barang_name]}),a.jsx("td",{children:s.satuan_barang_name}),a.jsx("td",{children:s.jumlah_sudah_dikirim}),a.jsx("td",{children:s.jumlah}),a.jsx("td",{children:e!=null&&e.preview?a.jsx(a.Fragment,{children:s.pengiriman}):a.jsx(a.Fragment,{children:a.jsx(Z,{name:"pengiriman_"+o,type:"text",other:{defaultValue:s.pengiriman},onchange:i=>{ma(i,s.jumlah),Y(i.target.value,s.rincian_pesanan_penjualan_barang)}})})})]},o)}))})]})}),e!=null&&e.preview?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden",children:a.jsx(ba,{ref:P,pengirimanBarangList:t,gudangList:v,pengirimanBarangEdit:e,fakturPenjualanBarang:g.filter(s=>s.uuid==h.value)})}),a.jsxs("button",{className:"btn btn-sm bg-red-800 mt-4 text-white",type:"button",onClick:C,children:[a.jsx(B,{})," Cetak Surat Jalan"]})]}):a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",type:"button",onClick:()=>{u(0)},children:[a.jsx(U,{})," Simpan"]})]}):a.jsx(a.Fragment,{})]})})},ka=()=>{la();const[l,e]=c.useState([]),[b,v]=c.useState([]),[y,N]=c.useState(!1),[j,h]=c.useState(!1),[_,x]=c.useState({name:""}),[S,w]=c.useState(!1),[m,f]=c.useState(""),n=c.useRef();H.useReactToPrint({content:()=>n.current});const[d,L]=c.useState({page:1,size:10,count:118,lastPage:12}),g=(t="")=>{t==""&&f(t),N(!0),p.custom(`?search=${t}`,"GET").then(r=>{var P,C;let u=ha(r.data.entry,"nomor_faktur_penjualan_barang");w(t.length<1),v(u),e((P=r==null?void 0:r.data)==null?void 0:P.entry),L((C=r==null?void 0:r.data)==null?void 0:C.pagination),N(!1)}).catch(r=>{k(r)})},A=t=>{t.preview=!1,x(t),h(!j)},T=t=>{t.preview=!0,x(t),h(!j)},R=async t=>{await ia("Hapus","Yakin ingin hapus data ini ?")&&p.custom(`/${t.uuid}`,"DELETE").then(()=>{ja("Berhasil","Data berhasil dihapus"),g()}).catch(r=>{k(r)})};return c.useEffect(()=>{g()},[]),a.jsx(ta,{isLoading:y,children:a.jsxs("div",{children:[a.jsx(na,{title:"Pengiriman Barang"}),j?a.jsx(Na,{setAddPengirimanBarangEvent:()=>h(!1),getData:g,pengirimanBarangEdit:_}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:m,onChange:t=>f(t.target.value)}),S?a.jsx(ca,{onClick:()=>{g(m)},className:"cursor-pointer"}):a.jsx(I,{onClick:()=>g(""),className:"cursor-pointer"})]}),a.jsx("div",{className:"flex gap-x-2 items-center",children:a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{x(null),h(!j)},children:[a.jsx(da,{})," Tambah Pengiriman Barang"]})})]}),a.jsx("div",{className:"overflow-x-auto px-3 bg-white shadow-xl rounded-md",children:b==null?void 0:b.map((t,r)=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-3 border-b-2 border-gray-400",children:[a.jsx("p",{className:"text-xs",children:"Nomor Faktur Penjualan"}),a.jsx("p",{className:"font-bold",children:t.parent})]}),t.data.map((u,P)=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"px-6 py-4 flex gap-x-4 items-center",children:[a.jsx(ra,{className:"text-blue-800",size:11}),a.jsxs("div",{className:"grid grid-cols-9 w-full",children:[a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Tanggal"}),a.jsx("p",{className:"text-sm font-bold",children:V(u.tanggal)})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Nomor Surat Jalan"}),a.jsx("p",{className:"text-sm font-bold",children:u==null?void 0:u.nomor_surat_jalan})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Penanggung Jawab"}),a.jsx("p",{className:"text-sm font-bold",children:u.pegawai_penanggung_jawab_name})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Pelaksana"}),a.jsx("p",{className:"text-sm font-bold",children:u.pegawai_pelaksana_name})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsx("p",{className:"text-xs",children:"Aksi"}),P==0?a.jsx(a.Fragment,{children:a.jsx("div",{children:a.jsxs("div",{className:"flex items-center",children:[a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-green-400",onClick:()=>{T(u)},children:[a.jsx(G,{size:10}),"Lihat"]}),a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-yellow-400",onClick:()=>{A(u)},children:[a.jsx(ua,{size:10}),"Edit"]}),a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-red-600",onClick:()=>{R(u)},children:[a.jsx(oa,{size:10}),"Hapus"]})]})})}):a.jsx(a.Fragment,{children:a.jsx("div",{children:a.jsx("div",{className:"flex items-center",children:a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-green-400",onClick:()=>{T(u)},children:[a.jsx(G,{size:10}),"Lihat"]})})})})]})]})]})}))]}))})]})]})})};export{ka as default};
