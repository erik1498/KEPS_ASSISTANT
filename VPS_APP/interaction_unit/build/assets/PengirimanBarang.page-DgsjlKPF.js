import{R as Q,j as a,f as V,r as n,O as X,b as I,h as G,i as Z,bw as B,s as k,k as E,bx as A,K as aa,bg as ea,u as sa,o as la,e as ta,G as na,U as $,a as ca,F as da,q as ra,n as ua}from"./index-BHalgDnS.js";import{P as oa,l as H}from"./PDFHeader-DjOAMhOk.js";import{f as K,W as ha}from"./Wrap-v0GlUqt9.js";import{P as ia}from"./PageTitle-B404o4Ml.js";import{F as z}from"./FormInputWithLabel-BP5eQqei.js";import{F as O}from"./FormSelectWithLabel-BeoqgiqW.js";import{F as xa}from"./FormInput-rJTe_TRK.js";import{i as ja}from"./actionEvent.helper-BujKUZ7B.js";import{p as C}from"./number.helper-efe0YCx6.js";import"./react-paginate-D-6Jcw9z.js";import{d as ma}from"./jurnalUmum.helper-CxKZ06YE.js";import"./index-BKNjMPK8.js";const ba=Q.forwardRef((l,e)=>{var b,v,y,N,x,h,_,j,S,w,m,f;return a.jsxs("div",{ref:e,children:[a.jsx(oa,{bulan:l==null?void 0:l.bulan,tahun:l==null?void 0:l.tahun,title:"Surat Jalan",useTime:!1}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",children:"KEPADA :"}),a.jsx("p",{children:(b=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:b.customer_name}),a.jsx("p",{children:(v=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:v.customer_code}),a.jsxs("p",{className:"my-4",children:["Alamat:",a.jsx("br",{}),(y=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:y.customer_alamat_kantor]}),a.jsxs("p",{className:"mb-4",children:["HP: ",a.jsx("br",{}),(N=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:N.customer_no_hp]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-bold",children:"TANGGAL :"}),a.jsx("p",{children:V((x=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:x.tanggal)})]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO FAKTUR PENJUALAN BARANG :"}),a.jsx("p",{children:(_=(h=l==null?void 0:l.fakturPenjualanBarang)==null?void 0:h.at(0))==null?void 0:_.nomor_faktur_penjualan_barang})]}),a.jsx("div",{className:"text-right",children:a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO PESANAN PENJUALAN BARANG :"}),a.jsx("p",{children:(j=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:j.nomor_pesanan_penjualan_barang})]})})]}),a.jsx("div",{className:"flex justify-between",children:a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO SURAT JALAN :"}),a.jsx("p",{children:(S=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:S.nomor_surat_jalan})]})}),a.jsx("p",{className:"pt-5",children:"Dikirimkan barang-barang sebagai berikut :"}),a.jsxs("div",{className:"mt-4 grid grid-cols-12 text-sm gap-x-2 py-2 font-bold border-t-2",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("p",{children:"No."})}),a.jsx("div",{className:"col-span-4",children:a.jsx("p",{children:"Kode / Nama Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{children:"Satuan"})}),a.jsx("div",{className:"col-span-1",children:a.jsx("p",{children:"Jumlah Barang"})}),a.jsx("div",{className:"col-span-1",children:a.jsx("p",{children:"Belum Dikirim"})}),a.jsx("div",{className:"col-span-1",children:a.jsx("p",{children:"Telah Dikirim"})}),a.jsx("div",{className:"col-span-1",children:a.jsx("p",{children:"Jumlah"})})]}),(w=l==null?void 0:l.pengirimanBarangList)==null?void 0:w.map((d,c)=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"py-3 border-y-2",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 py-3 items-center font-bold",children:[a.jsx("div",{className:"col-span-1",children:a.jsxs("p",{className:"text-sm",children:[c+1,"."]})}),a.jsxs("div",{className:"col-span-4",children:[a.jsx("p",{className:"text-sm",children:d.kategori_harga_barang_kode_barang}),a.jsx("p",{className:"text-xs font-normal",children:d.daftar_gudang_name}),a.jsx("p",{className:"text-sm",children:d.daftar_barang_name})]}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:d.satuan_barang_name})}),a.jsx("div",{className:"col-span-1",children:a.jsx("p",{className:"text-sm",children:C(d.jumlah)})}),a.jsx("div",{className:"col-span-1",children:a.jsx("p",{className:"text-sm",children:C(d.jumlah-d.jumlah_sudah_dikirim)})}),a.jsx("div",{className:"col-span-1",children:a.jsx("p",{className:"text-sm",children:C(d.jumlah_sudah_dikirim)})}),a.jsx("div",{className:"col-span-1",children:a.jsx("p",{className:"text-sm",children:C(d.pengiriman)})})]}),a.jsx("p",{className:"font-normal text-xs pb-16",children:"Keterangan"})]})})),a.jsxs("div",{className:"grid grid-cols-12 py-5 gap-5 items-start font-bold",children:[l.gudangList.map(d=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"col-span-4 border-b-2 border-black",children:[a.jsxs("p",{className:"mb-20",children:["Pihak ",d]}),a.jsx("p",{children:" "})]})})),a.jsxs("div",{className:"col-span-4 border-b-2 border-black",children:[a.jsx("p",{className:"mb-20",children:"Penanggung Jawab"}),a.jsx("p",{className:"font-normal",children:(m=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:m.pegawai_penanggung_jawab_name})]}),a.jsxs("div",{className:"col-span-4 border-b-2 border-black",children:[a.jsx("p",{className:"mb-20",children:"Pelaksana"}),a.jsx("p",{className:"font-normal",children:(f=l==null?void 0:l.pengirimanBarangEdit)==null?void 0:f.pegawai_pelaksana_name})]}),a.jsxs("div",{className:"col-span-4 border-b-2 border-black",children:[a.jsx("p",{className:"mb-20",children:"Diterima Oleh"}),a.jsx("p",{children:" "})]})]})]})}),Na=({setAddPengirimanBarangEvent:l=()=>{},pengirimanBarangEdit:e,getData:b=()=>{}})=>{const[v,y]=n.useState([]),[N,x]=n.useState(e!=null&&e.tanggal?e.tanggal:X()),[h,_]=n.useState(e!=null&&e.faktur_penjualan_barang?e.faktur_penjualan_barang:""),[j,S]=n.useState(e!=null&&e.nomor_surat_jalan?e.nomor_surat_jalan:""),[w,m]=n.useState(e!=null&&e.pegawai_penanggung_jawab?e.pegawai_penanggung_jawab:""),[f,d]=n.useState(e!=null&&e.pegawai_pelaksana?e.pegawai_pelaksana:""),[c,p]=n.useState(null),[g,R]=n.useState([]),[L,J]=n.useState([]),[t,r]=n.useState([]),u=async s=>{B.custom(`${t[s].uuid!=""?`/${t[s].uuid}`:""}`,t[s].uuid!=""?"PUT":"POST",null,{data:{pengiriman_barang:c,rincian_pesanan_penjualan_barang:t[s].rincian_pesanan_penjualan_barang,jumlah:`${t[s].jumlah}`,pengiriman:`${t[s].pengiriman}`}}).then(()=>{s+1<t.length?u(s+1):(b(),l())}).catch(o=>{k(o)})},P=n.useRef(),T=H.useReactToPrint({content:()=>P.current}),W=async s=>{s.preventDefault(),await E(s.target)&&A.custom(e?`/${e.uuid}`:"",e?"PUT":"POST",null,{data:{tanggal:N,faktur_penjualan_barang:h.value,nomor_surat_jalan:j,pegawai_pelaksana:f.value,pegawai_penanggung_jawab:w.value}}).then(o=>{p(e?i=>e.uuid:i=>o.data.uuid)}).catch(o=>{k(o)})},D=()=>{aa.custom("","GET").then(s=>{if(J(s.data.entry),s.data.entry.length>0){if(e){K({editObject:e.pegawai_penanggung_jawab,dataList:s.data.entry,setState:m,labelKey:"name",valueKey:"uuid"}),K({editObject:e.pegawai_pelaksana,dataList:s.data.entry,setState:d,labelKey:"name",valueKey:"uuid"});return}m({label:s.data.entry[0].name,value:s.data.entry[0].uuid}),d({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>k(s))},q=()=>{ea.custom("","GET").then(s=>{if(R(s.data.entry),s.data.entry.length>0){if(e){K({editObject:e.faktur_penjualan_barang,dataList:s.data.entry,setState:_,labelKey:"nomor_faktur_penjualan_barang",valueKey:"uuid"});return}_({label:s.data.entry[0].nomor_faktur_penjualan_barang,value:s.data.entry[0].uuid})}}).catch(s=>k(s))},Y=()=>{A.custom(`/daftar_pesanan/${c}`,"GET").then(s=>{var i;r(s.data);let o=v;(i=s==null?void 0:s.data)==null||i.map(F=>{o.includes(F.daftar_gudang_name)||o.push(F.daftar_gudang_name)}),y(F=>o)}).catch(s=>k(s))},M=(s,o)=>{const i=t,F=t.findIndex(U=>U.rincian_pesanan_penjualan_barang==o);F>-1&&(i[F].pengiriman=s),r(U=>i)};return n.useEffect(()=>{c&&Y()},[c]),n.useEffect(()=>{q(),D(),e!=null&&e.preview&&p(e==null?void 0:e.uuid)},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[e?`${e!=null&&e.preview?"Lihat":"Edit"}`:"Tambahkan"," Pengiriman Barang"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>l(),children:[a.jsx(I,{})," ",e!=null&&e.preview?"Tutup":"Batalkan Pengiriman Barang"]})]}),a.jsxs("form",{onSubmit:s=>W(s),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(z,{label:"Tanggal",type:"datetime-local",onchange:s=>{x(s.target.value)},addClassInput:c||e?"border-none !px-1":"",disabled:c||e,others:{value:N,name:"tanggal"}}),a.jsx(O,{label:"Faktur Penjualan Barang",optionsDataList:g,optionsLabel:"nomor_faktur_penjualan_barang",optionsValue:"uuid",selectValue:h,addClass:c||e?"border-none !px-1":"",disabled:c||e,onchange:s=>{_(s)},selectName:"fakturPenjualanBarang"}),a.jsx(z,{label:"Nomor Surat Jalan",type:"text",addClassInput:c||e!=null&&e.preview?"border-none !px-1":"",onchange:s=>{S(s.target.value)},disabled:c||(e==null?void 0:e.preview),others:{value:j,name:"nomorSuratJalan"}}),a.jsx(O,{label:"Pegawai Penanggung Jawab",optionsDataList:L,optionsLabel:"name",optionsValue:"uuid",selectValue:w,addClass:c||e!=null&&e.preview?"border-none !px-1":"",disabled:c||(e==null?void 0:e.preview),onchange:s=>{m(s)},selectName:"pegawaiPenanggungJawab"}),a.jsx(O,{label:"Pegawai Pelaksana",addClass:c||e!=null&&e.preview?"border-none !px-1":"",optionsDataList:L,optionsLabel:"name",optionsValue:"uuid",selectValue:f,disabled:c||(e==null?void 0:e.preview),onchange:s=>{d(s)},selectName:"pegawaiPelaksana"})]}),c?a.jsx(a.Fragment,{}):a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(G,{})," Simpan"]})]}),c?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto rounded-md h-max max-h-[90vh] no-scrollbar mt-5 pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Kode / Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Jumlah Barang"}),a.jsx("th",{children:"Belum Dikirim"}),a.jsx("th",{children:"Telah Dikirim"}),a.jsx("th",{children:"Jumlah"})]})}),a.jsx("tbody",{children:t==null?void 0:t.map((s,o)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[o+1,"."]}),a.jsxs("td",{children:[a.jsx("b",{children:s.kategori_harga_barang_kode_barang}),a.jsx("br",{}),s.daftar_gudang_name,a.jsx("br",{}),a.jsx("br",{}),s.daftar_barang_name]}),a.jsx("td",{children:s.satuan_barang_name}),a.jsx("td",{children:s.jumlah}),a.jsx("td",{children:s.jumlah-s.jumlah_sudah_dikirim}),a.jsx("td",{children:s.jumlah_sudah_dikirim}),a.jsx("td",{children:e!=null&&e.preview?a.jsx(a.Fragment,{children:s.pengiriman}):a.jsx(a.Fragment,{children:a.jsx(xa,{name:"pengiriman_"+o,type:"text",other:{defaultValue:s.pengiriman},onchange:i=>{ja(i,s.jumlah),M(i.target.value,s.rincian_pesanan_penjualan_barang)}})})})]},o)}))})]})}),e!=null&&e.preview?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden",children:a.jsx(ba,{ref:P,pengirimanBarangList:t,gudangList:v,pengirimanBarangEdit:e,fakturPenjualanBarang:g.filter(s=>s.uuid==h.value)})}),a.jsxs("button",{className:"btn btn-sm bg-red-800 mt-4 text-white",type:"button",onClick:T,children:[a.jsx(Z,{})," Cetak Surat Jalan"]})]}):a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",type:"button",onClick:()=>{u(0)},children:[a.jsx(G,{})," Simpan"]})]}):a.jsx(a.Fragment,{})]})})},Ta=()=>{sa();const[l,e]=n.useState([]),[b,v]=n.useState([]),[y,N]=n.useState(!1),[x,h]=n.useState(!1),[_,j]=n.useState({name:""}),[S,w]=n.useState(!1),[m,f]=n.useState(""),d=n.useRef();H.useReactToPrint({content:()=>d.current});const[c,p]=n.useState({page:1,size:10,count:118,lastPage:12}),g=(t="")=>{t==""&&f(t),N(!0),A.custom(`?search=${t}`,"GET").then(r=>{var P,T;let u=ma(r.data.entry,"nomor_faktur_penjualan_barang");w(t.length<1),v(u),e((P=r==null?void 0:r.data)==null?void 0:P.entry),p((T=r==null?void 0:r.data)==null?void 0:T.pagination),N(!1)}).catch(r=>{k(r)})},R=t=>{t.preview=!1,j(t),h(!x)},L=t=>{t.preview=!0,j(t),h(!x)},J=async t=>{await ra("Hapus","Yakin ingin hapus data ini ?")&&A.custom(`/${t.uuid}`,"DELETE").then(()=>{ua("Berhasil","Data berhasil dihapus"),g()}).catch(r=>{k(r)})};return n.useEffect(()=>{g()},[]),a.jsx(ha,{isLoading:y,children:a.jsxs("div",{children:[a.jsx(ia,{title:"Pengiriman Barang"}),x?a.jsx(Na,{setAddPengirimanBarangEvent:()=>h(!1),getData:g,pengirimanBarangEdit:_}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:m,onChange:t=>f(t.target.value)}),S?a.jsx(la,{onClick:()=>{g(m)},className:"cursor-pointer"}):a.jsx(I,{onClick:()=>g(""),className:"cursor-pointer"})]}),a.jsx("div",{className:"flex gap-x-2 items-center",children:a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{j(null),h(!x)},children:[a.jsx(ta,{})," Tambah Pengiriman Barang"]})})]}),a.jsx("div",{className:"overflow-x-auto px-3 bg-white shadow-xl rounded-md",children:b==null?void 0:b.map((t,r)=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-3 border-b-2 border-gray-400",children:[a.jsx("p",{className:"text-xs",children:"Nomor Faktur Penjualan"}),a.jsx("p",{className:"font-bold",children:t.parent})]}),t.data.map((u,P)=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"px-6 py-4 flex gap-x-4 items-center",children:[a.jsx(na,{className:"text-blue-800",size:11}),a.jsxs("div",{className:"grid grid-cols-9 w-full",children:[a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Tanggal"}),a.jsx("p",{className:"text-sm font-bold",children:V(u.tanggal)})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Nomor Surat Jalan"}),a.jsx("p",{className:"text-sm font-bold",children:u==null?void 0:u.nomor_surat_jalan})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Penanggung Jawab"}),a.jsx("p",{className:"text-sm font-bold",children:u.pegawai_penanggung_jawab_name})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs",children:"Pelaksana"}),a.jsx("p",{className:"text-sm font-bold",children:u.pegawai_pelaksana_name})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsx("p",{className:"text-xs",children:"Aksi"}),P==0?a.jsx(a.Fragment,{children:a.jsx("div",{children:a.jsxs("div",{className:"flex items-center",children:[a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-green-400",onClick:()=>{L(u)},children:[a.jsx($,{size:10}),"Lihat"]}),a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-yellow-400",onClick:()=>{R(u)},children:[a.jsx(ca,{size:10}),"Edit"]}),a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-red-600",onClick:()=>{J(u)},children:[a.jsx(da,{size:10}),"Hapus"]})]})})}):a.jsx(a.Fragment,{children:a.jsx("div",{children:a.jsx("div",{className:"flex items-center",children:a.jsxs("button",{className:"btn btn-xs bg-transparent shadow-none border-0 text-green-400",onClick:()=>{L(u)},children:[a.jsx($,{size:10}),"Lihat"]})})})})]})]})]})}))]}))})]})]})})};export{Ta as default};
