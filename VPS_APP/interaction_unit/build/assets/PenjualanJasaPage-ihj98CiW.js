import{r as s,j as a,h as la,aF as Pa,s as v,k as q,aV as da,b as I,y as ea,F as sa,aH as va,aW as ca,c as ua,aX as xa,aY as ha,aZ as aa,a_ as _a,n as Z,a$ as ja,b0 as ba,b1 as oa,b2 as ka,b3 as ma,O as W,b4 as Fa,f as Ta,b5 as ta,A as Na,Y as ya,Z as Sa,u as $a,a as Ca,o as fa,$ as Ra,b6 as ra}from"./index-DHco5UoW.js";import{P as Ja}from"./PageTitle-DhSJ_t28.js";import{r as ia,W as Da}from"./Wrap-UDT2yOyM.js";import{F as U}from"./FormInputWithLabel-Be1eo8uL.js";import{F as X}from"./FormSelectWithLabel-C9nmHSNn.js";import{i as Q}from"./actionEvent.helper-CSfRBgS8.js";import{p,a as Y}from"./number.helper-_FlTjox4.js";import{T as Ea}from"./ToggleBox-BtcP2g5-.js";import{P as wa}from"./Pagination-BRJ4tswB.js";import{F as G}from"./FormInput-DQocwEvt.js";import{g as La}from"./jurnalUmum.helper-CYiiM-mT.js";const Aa=({pesananPenjualanJasa:n,_getDataRincianDaftarPasananPenjualan:l,kategoriHargaJasaList:o,customer:N})=>{const[w,F]=s.useState(!1),[z,T]=s.useState([]),[_,P]=s.useState(),[y,f]=s.useState(),[J,u]=s.useState(),[S,j]=s.useState(0),[C,i]=s.useState(0),[g,b]=s.useState(0),[$,A]=s.useState(0),[x,m]=s.useState(0),[t,D]=s.useState(0),B=()=>{u(c=>null),Pa.custom(`/cabang/${y.value}/${n.uuid}`,"GET").then(c=>{T(c.data),c.data.length>0&&u(r=>({label:c.data[0].cabang_name,value:c.data[0].uuid}))}).catch(c=>v(c))},d=async c=>{c.preventDefault(),await q(c.target)&&da.custom("","POST",null,{data:{pesanan_penjualan_jasa:n.uuid,kategori_harga_jasa:y.value,stok_awal_jasa:J.value,kode_harga_customer:N.kode_harga,jumlah:`${S}`,harga:`${_[`harga_${N.kode_harga}`]}`,harga_setelah_diskon:`${t}`,ppn:`${_.ppn==1?_[`harga_${N.kode_harga}`]*ia/100:0}`,ppn_setelah_diskon:`${x}`,diskon_angka:`${C}`,diskon_persentase:`${g}`,total_harga:`${$}`}}).then(r=>{l()}).catch(r=>v(r))},O=c=>{try{const r=Y(c.target.value)*_[`harga_${N.kode_harga}`]/100;b(c.target.value),i(e=>e=p(r))}catch{i(e=>0)}},L=()=>{try{const c=Y(C)*100/_[`harga_${N.kode_harga}`];b(r=>r=c),H()}catch{b(r=>0)}};s.useEffect(()=>{_&&L()},[C]);const H=()=>{const c=Y(S),r=_[`harga_${N.kode_harga}`]-Y(C);D(R=>r);const e=_.ppn==1?r*ia/100:0;m(R=>e);const E=c*r+e*c;A(R=>E)};return s.useEffect(()=>{_&&H()},[S]),s.useEffect(()=>{if(y){B();const c=o.filter(r=>r.uuid==y.value);c.length>0&&(j(r=>0),F(r=>0),i(r=>0),b(r=>0),P(c[0]))}},[y]),s.useEffect(()=>{f({label:o[0].kode_jasa,value:o[0].uuid})},[]),a.jsx(a.Fragment,{children:a.jsxs("form",{className:"gap-x-2 py-3",onSubmit:c=>d(c),children:[a.jsxs("div",{className:"flex items-end gap-x-2",children:[a.jsx(X,{label:"Kode Jasa",optionsDataList:o,optionsLabel:"kode_jasa",optionsValue:"uuid",selectValue:y,onchange:c=>{f(c)},selectName:"kategoriHargaJasa"}),a.jsx(X,{label:"Cabang Asal",optionsDataList:z,optionsLabel:"cabang_name",optionsValue:"uuid",selectValue:J,onchange:c=>{u(c)},selectName:"CabangJasa"})]}),_?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"gap-x-2 bg-gray-300 my-4 rounded-md px-2 py-3",children:[a.jsx("p",{className:"text-xl font-extrabold",children:_.daftar_jasa_name}),a.jsx("p",{className:"text-sm mt-5",children:"Harga Jasa"}),a.jsxs("p",{className:"font-bold mt-1 text-xl",children:["Rp. ",p(_[`harga_${N.kode_harga}`])]}),_.ppn==1?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"flex gap-x-2 items-end mb-5",children:[a.jsx("p",{className:"text-sm",children:"PPN"}),a.jsxs("p",{className:"font-bold",children:["Rp. ",p(_[`harga_${N.kode_harga}`]*ia/100)]})]})}):a.jsx(a.Fragment,{}),a.jsx("p",{className:"font-bold bg-blue-800 px-2 text-white rounded-md w-max mt-2",children:_.satuan_jasa_name})]}),J?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex gap-x-2",children:a.jsx(U,{addClassInput:"w-max",label:"Jumlah",type:"text",onchange:c=>{Q(c),j(c.target.value)},others:{value:S,name:"jumlah"}})}),a.jsx("div",{className:"mt-5",children:a.jsx(Ea,{label:"Gunakan Diskon ?",setToggleBox:F,toggleBox:w,toggleBoxList:[{label:"Tidak",value:0},{label:"Ya",value:1}]})}),w?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mt-5 flex gap-x-2",children:[a.jsx(U,{label:"Diskon Angka",type:"text",onchange:c=>{Q(c),i(c.target.value)},others:{value:C,name:"diskonAngka"}}),a.jsx(U,{label:"Diskon Persentase",type:"text",onchange:c=>{Q(c),O(c)},others:{value:g,name:"diskonPersentase"}})]}),a.jsxs("div",{className:"mt-5 gap-x-2 px-1",children:[a.jsx("p",{className:"font-bold mt-2",children:"Harga Setelah Diskon"}),a.jsxs("p",{className:"font-bold mt-2 text-xl",children:["Rp. ",p(t)]}),_.ppn==1?a.jsx(a.Fragment,{children:a.jsxs("p",{className:"font-bold mb-5 mt-2",children:["PPN Rp. ",p(x)]})}):a.jsx(a.Fragment,{})]})]}):a.jsx(a.Fragment,{}),a.jsxs("div",{className:"mt-5 gap-x-2 px-1",children:[a.jsx("p",{className:"font-bold text-sm",children:"Total Harga"}),a.jsxs("p",{className:"font-bold text-4xl",children:["Rp. ",p($)]})]})]}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{}),J?a.jsx(a.Fragment,{children:a.jsxs("button",{className:"mt-3 btn w-full bg-green-800 text-white",children:[a.jsx(la,{})," Simpan Pesanan"]})}):a.jsx(a.Fragment,{})]})})},Oa=({pesananPenjualanJasa:n,customer:l,fakturStatus:o,setPPNStatus:N=()=>{},tanggalTransaksiAkhir:w,rincianPesananPenjualanJasa:F,setRincianPesananPenjualanJasa:z=()=>{}})=>{const[T,_]=s.useState([]),[P,y]=s.useState(!1),[f,J]=s.useState(0),u=()=>{da.custom(`/${n.uuid}`,"GET").then(i=>{N(g=>!1),z(i.data),i.data.filter(g=>g.ppn>0).length>0&&N(g=>!0)}).catch(i=>v(i))},S=()=>{va.custom("/transaksi","GET").then(i=>{_(i.data)}).catch(i=>v(i))},j=i=>{da.custom(`/${i}`,"DELETE").then(g=>{u()}).catch(g=>v(g))},C=()=>{ca.custom("/pesanan_by_tanggal","POST",null,{data:{faktur_penjualan_jasa:o,tanggal:w}}).then(i=>{z(b=>i.data);const g=i.data.reduce((b,$)=>b+parseFloat($.piutang),0);J(b=>g)})};return s.useEffect(()=>{S(),o?C():u()},[o,w,P]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"grid grid-cols-12 gap-x-2",children:[a.jsx("div",{className:`${o?"hidden":"col-span-4"}`,children:T.length>0?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white rounded-md my-4 py-6 px-6 shadow-2xl",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Detail Jasa Pesanan"}),a.jsx(Aa,{_getDataRincianDaftarPasananPenjualan:u,_hapusPesanan:()=>{},customer:l,kategoriHargaJasaList:T,pesananPenjualanJasa:n})]})}):a.jsx(a.Fragment,{})}),a.jsx("div",{className:`${o?"col-span-12":"col-span-8"}`,children:a.jsxs("div",{className:`bg-white my-4 rounded-md no-scrollbar relative ${o?"h-max max-h-[60vh]":"h-[70vh]"} overflow-y-scroll`,children:[a.jsxs("div",{className:"sticky top-0",children:[a.jsxs("div",{className:"bg-white py-4 px-6 rounded-md",children:[a.jsx("p",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Total Pesanan"}),a.jsxs("p",{className:"font-bold text-4xl",children:["Rp. ",p(F.reduce((i,g)=>i+parseFloat(g.total_harga),0))]}),o?a.jsx(a.Fragment,{children:f>0?a.jsxs("div",{className:"flex items-center gap-x-2 w-max my-2 px-2 py-1 rounded-md border-2 border-red-800",children:[a.jsx(I,{className:"text-red-800",size:13}),a.jsx("p",{className:"mb-0 text-red-800 font-bold",children:"Belum Lunas"})]}):a.jsxs("div",{className:"flex items-center gap-x-2 w-max my-2 px-2 py-1 rounded-md border-2 border-green-800",children:[a.jsx(ea,{className:"text-green-800",size:13}),a.jsx("p",{className:"mb-0 text-green-800 font-bold",children:"Lunas"})]})}):a.jsx(a.Fragment,{}),o?a.jsx(a.Fragment,{children:P?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn bg-gray-100 text-red-500 btn-sm mt-4 border-red-500",onClick:()=>{y(i=>i=!i)},children:"Tutup Daftar Pesanan"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn bg-gray-100 btn-sm mt-4 border-gray-500",onClick:()=>{y(i=>i=!i)},children:"Lihat Daftar Pesanan"})})}):a.jsx(a.Fragment,{})]}),o&&!P?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"grid grid-cols-12 text-sm gap-x-2 py-2 font-bold border-t-2 bg-gray-100 px-6",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("p",{className:"text-gray-500",children:"No."})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Kode Jasa"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Nama Jasa"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Satuan Jasa"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Harga Jasa"})})]})})]}),o&&!P?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:F.map((i,g)=>a.jsxs("div",{className:"py-3  border-t-2",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 px-6 items-start font-bold",children:[a.jsx("div",{className:"col-span-1",children:a.jsxs("p",{className:"text-sm",children:[g+1,"."]})}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-sm",children:i.kategori_harga_jasa_kode_jasa}),a.jsx("p",{className:"text-xs my-1 font-normal",children:i.daftar_gudang_name})]}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:i.daftar_jasa_name})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:i.satuan_jasa_name})}),a.jsxs("div",{className:"col-span-3",children:[a.jsxs("p",{className:"text-sm",children:["Rp. ",p(i.harga)]}),a.jsxs("p",{className:"text-xs font-normal",children:["PPN : Rp. ",p(i.ppn)]})]})]}),a.jsxs("div",{className:"grid grid-cols-12 text-xs gap-x-2 px-6 text-gray-500 font-bold",children:[a.jsx("div",{className:"col-span-1"}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("p",{children:["Jumlah : ",p(i.jumlah)]}),o?a.jsx(a.Fragment,{children:a.jsxs("p",{children:["Retur : ",p(i.retur)]})}):a.jsx(a.Fragment,{})]}),a.jsx("div",{className:"col-span-3",children:i.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsx("p",{children:"Diskon"}),a.jsx("p",{children:"Harga Diskon"}),a.jsx("p",{children:"PPN Diskon"})]}):a.jsx(a.Fragment,{})}),a.jsx("div",{className:"col-span-3",children:i.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["Rp. ",p(i.diskon_angka)," (",i.diskon_persentase," % )"]}),a.jsxs("p",{children:["Rp. ",p(i.harga_setelah_diskon)]}),a.jsxs("p",{children:["Rp. ",p(i.ppn_setelah_diskon)]})]}):a.jsx(a.Fragment,{})}),a.jsxs("div",{className:"col-span-3",children:["Total Harga ",a.jsxs("p",{children:["Rp. ",p(i.total_harga)]}),o?a.jsxs(a.Fragment,{children:["Status ",a.jsx("p",{children:i.piutang!="0"?`Belum Lunas ( Rp. ${p(i.piutang)} )`:"Sudah Lunas"})]}):a.jsx(a.Fragment,{})]})]}),o?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsx("div",{className:"grid grid-cols-12 gap-x-2 px-6",children:a.jsx("div",{className:"col-span-1 col-start-2 mb-3",children:a.jsxs("button",{className:"btn w-max btn-sm bg-red-700 text-white",onClick:b=>{j(i.uuid)},children:[a.jsx(sa,{})," Hapus"]})})})})]}))})]})})]})})},za=({riwayatPelunasanPenjualanJasa:n,edited:l,_getDaftarRiwayatTransaksi:o=()=>{}})=>{var H,c,r;const[N,w]=s.useState(n.nomor_transaksi!="EMPTY"?n.nomor_transaksi:""),[F,z]=s.useState(n.bukti_transaksi!="EMPTY"?n.bukti_transaksi:""),[T,_]=s.useState(n.keterangan!="EMPTY"?n.keterangan:"Tidak Ada"),[P,y]=s.useState(n.total),[f,J]=s.useState(!1),[u,S]=s.useState([]),[j,C]=s.useState([]),[i,g]=s.useState(!1),[b,$]=s.useState(l),A=()=>{aa.custom(`/cek_denda_pelunasan_penjualan/${n.uuid}`,"GET").then(e=>{J(E=>e.data)}).catch(e=>v(e))},x=()=>{ca.custom(`/pesanan/${n.uuid}`).then(e=>{S(e.data)}).catch(e=>v(e))},m=()=>{_a.custom(`/pesanan/${n.uuid}`).then(e=>{C(e.data)}).catch(e=>v(e))},t=(e,E)=>{let R=u,M=0;R=R.map(K=>(K.uuid==E&&(K.nilai_pelunasan=e),M+=Y(K.nilai_pelunasan),K)),y(K=>M),S(K=>R)},D=(e,E)=>{let R=j,M=0;R=R.map(K=>(K.uuid==E&&(K.nilai_pelunasan=e),M+=Y(K.nilai_pelunasan),K)),y(K=>M),C(K=>R)},B=async()=>{for(let e=0;e<j.length;e++)await _a.custom(`${j[e].rincian_pelunasan_penjualan_denda_jasa?`/${j[e].rincian_pelunasan_penjualan_denda_jasa}`:""}`,j[e].rincian_pelunasan_penjualan_denda_jasa?"PUT":"POST",null,{data:{pelunasan_penjualan_jasa:n.uuid,rincian_pesanan_penjualan_jasa:j[e].uuid,hari_terlewat:j[e].hari_terlewat,total_denda:j[e].total_denda,denda_sudah_dibayar:j[e].denda_sudah_dibayar,piutang_denda:j[e].total_denda-j[e].denda_sudah_dibayar,nilai_pelunasan:`${j[e].nilai_pelunasan}`}}).then(()=>{Z("Berhasil","Data Berhasil Disimpan")}).catch(E=>v(E));m()},d=async()=>{for(let e=0;e<u.length;e++)await ca.custom(`${u[e].rincian_pelunasan_penjualan_jasa?`/${u[e].rincian_pelunasan_penjualan_jasa}`:""}`,u[e].rincian_pelunasan_penjualan_jasa?"PUT":"POST",null,{data:{pelunasan_penjualan_jasa:n.uuid,rincian_pesanan_penjualan_jasa:u[e].uuid,sudah_dibayar:u[e].sudah_dibayar,piutang:u[e].piutang,nilai_pelunasan:`${u[e].nilai_pelunasan}`}}).then(()=>{Z("Berhasil","Data Berhasil Disimpan")}).catch(E=>v(E));x()},O=()=>{aa.custom("/"+n.uuid,"DELETE").then(()=>{o()}).catch(e=>v(e))},L=async()=>{await ja(),await q()&&aa.custom("/"+n.uuid,"PUT",null,{data:{nomor_pelunasan_penjualan_jasa:N,bukti_transaksi:F,keterangan:T,faktur_penjualan_jasa:n.faktur_penjualan_jasa,tanggal:n.tanggal,kode_akun_perkiraan:n.kode_akun_perkiraan}}).then(()=>{Z("Berhasil","Data Berhasil Disimpan")}).catch(e=>v(e))};return s.useEffect(()=>{f==0?x():m()},[f]),s.useEffect(()=>{i&&A()},[i]),a.jsxs("div",{className:"border-b-2 py-2",children:[a.jsx("div",{className:"cursor-pointer",onClick:()=>{$(e=>e=!e)},children:a.jsxs("div",{className:"flex items-center justify-between gap-x-2 px-4",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsx("p",{className:"text-sm pr-2 font-medium",children:ua(n.tanggal.split("T")[1])}),a.jsx("p",{className:"text-sm pr-2 font-medium px-3 border-l-2 border-black",children:"Pelunasan Penjualan Jasa"})]}),b?a.jsx(xa,{size:15}):a.jsx(ha,{size:15})]})}),b?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"ml-4 py-4 px-4",children:[((H=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))==null?void 0:H.hasil_stok_opname_count)==0?a.jsx(a.Fragment,{}):a.jsx("p",{className:"text-xs font-medium text-green-600 my-3",children:(c=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))!=null&&c.nomor_perintah_stok_opname?`Telah Terdaftar Pada Surat Perintah Stok Opname ${(r=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))==null?void 0:r.nomor_perintah_stok_opname}`:""}),b?a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"text-left text-sm",children:[a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Nomor Pelunasan Penjualan Jasa"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(G,{addClass:"px-0",name:"nomor_pelunasan_penjualan_jasa",value:N,onchange:e=>w(e.target.value)}):n.nomor_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Bukti Transaksi"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(G,{addClass:"px-0",name:"bukti_transaksi",value:F,onchange:e=>z(e.target.value)}):n.bukti_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-5":""}`,children:"Kode Akun"}),a.jsx("td",{className:`px-5 ${l?"pb-5":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-5":""}`,children:[n.kode_akun_perkiraan_code," - ",n.kode_akun_perkiraan_name]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Total Pelunasan"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-3":""}`,children:["Rp. ",p(P)]})]})]}),a.jsx("p",{className:`text-sm mt-3 ${l?"mt-5":""}`,children:"Keterangan"}),a.jsx("p",{className:"text-sm mb-3",children:l?a.jsx(G,{addClass:"mt-5",name:"keterangan",value:T,onchange:e=>_(e.target.value)}):n.keterangan}),a.jsxs("div",{className:"my-2 flex justify-between",children:[a.jsx("div",{children:l?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"mr-2 btn btn-sm bg-green-900 text-white",onClick:()=>L(),children:[a.jsx(ea,{size:12}),"Simpan"]}),a.jsxs("button",{className:"mr-2 btn btn-sm bg-red-500 text-white",onClick:()=>O(),children:[a.jsx(sa,{size:12}),"Hapus"]})]}):a.jsx(a.Fragment,{})}),i?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm border-red-500 text-red-500",onClick:()=>g(e=>e=!e),children:"Tutup Daftar Pelunasan"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm bg-white border-gray-400",onClick:()=>g(e=>e=!e),children:"Lihat Daftar Pelunasan"})})]}),i?a.jsx(a.Fragment,{children:f==1?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Jasa"}),a.jsx("th",{children:"Nama Jasa"}),a.jsx("th",{children:"Satuan Jasa"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Hari Terlewat"}),a.jsx("th",{children:"Total Denda"}),a.jsx("th",{children:"Denda Sudah Dibayar"}),a.jsx("th",{children:"Piutang Denda"}),a.jsx("th",{width:200,children:"Nilai Pelunasan"})]}),a.jsx("tbody",{children:j.map((e,E)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[E+1,"."]}),a.jsx("td",{children:e.kategori_harga_jasa_kode_jasa}),a.jsx("td",{children:e.daftar_jasa_name}),a.jsx("td",{children:e.satuan_jasa_name}),a.jsx("td",{children:e.daftar_gudang_name}),a.jsxs("td",{children:[e.hari_terlewat," Hari"]}),a.jsxs("td",{children:["Rp. ",p(e.total_denda)]}),a.jsxs("td",{children:["Rp. ",p(e.denda_sudah_dibayar)]}),a.jsxs("td",{children:["Rp. ",p(e.piutang_denda)]}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(G,{name:"nilai_pelunasan",type:"text",other:{defaultValue:0},onchange:R=>{Q(R,e.piutang_denda),D(R.target.value,e.uuid)},value:p(e.nilai_pelunasan)})}):a.jsxs(a.Fragment,{children:["Rp. ",p(e.nilai_pelunasan)]})})]})}))})]})}),l?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn btn-sm bg-green-900 text-white",onClick:()=>{B()},children:"Simpan"})})}):a.jsx(a.Fragment,{})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Jasa"}),a.jsx("th",{children:"Nama Jasa"}),a.jsx("th",{children:"Satuan Jasa"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Pelunasan Sudah Dibayar"}),a.jsx("th",{children:"Piutang"}),a.jsx("th",{width:200,children:"Nilai Pelunasan"})]}),a.jsx("tbody",{children:u.map((e,E)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[E+1,"."]}),a.jsx("td",{children:e.kategori_harga_jasa_kode_jasa}),a.jsx("td",{children:e.daftar_jasa_name}),a.jsx("td",{children:e.satuan_jasa_name}),a.jsx("td",{children:e.daftar_gudang_name}),a.jsxs("td",{children:["Rp. ",p(e.sudah_dibayar)]}),a.jsxs("td",{children:["Rp. ",p(e.piutang)]}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(G,{name:"nilai_pelunasan",type:"text",other:{defaultValue:0},onchange:R=>{Q(R,e.piutang),t(R.target.value,e.uuid)},value:p(e.nilai_pelunasan)})}):a.jsxs(a.Fragment,{children:["Rp. ",p(e.nilai_pelunasan)]})})]})}))})]})}),l?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn btn-sm bg-green-900 text-white",onClick:()=>{d()},children:"Simpan"})})}):a.jsx(a.Fragment,{})]})}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]})}):a.jsx(a.Fragment,{})]})},Ba=({riwayatReturPenjualanJasa:n,edited:l,_getDaftarRiwayatTransaksi:o=()=>{}})=>{var t,D,B;const[N,w]=s.useState(n.nomor_transaksi!="EMPTY"?n.nomor_transaksi:""),[F,z]=s.useState(n.bukti_transaksi!="EMPTY"?n.bukti_transaksi:""),[T,_]=s.useState(n.keterangan!="EMPTY"?n.keterangan:"Tidak Ada"),[P,y]=s.useState(n.total),[f,J]=s.useState(!1),[u,S]=s.useState([]),[j,C]=s.useState(!1),[i,g]=s.useState(l),b=()=>{ba.custom(`/pesanan/${n.uuid}`).then(d=>{S(d.data)}).catch(d=>v(d))},$=(d,O)=>{let L=u,H=0;L=L.map(c=>(c.uuid==O&&(c.retur=d,c.nilai_retur=(c.harga_setelah_diskon+c.ppn_setelah_diskon)*Y(d),c.nilai_retur>c.sudah_dibayar_fix&&(c.nilai_retur=c.sudah_dibayar_fix)),H+=Y(c.nilai_retur),c)),y(c=>H),S(c=>L)},A=async()=>{for(let d=0;d<u.length;d++)await ba.custom(`${u[d].rincian_retur_penjualan_jasa?`/${u[d].rincian_retur_penjualan_jasa}`:""}`,u[d].rincian_retur_penjualan_jasa?"PUT":"POST",null,{data:{retur_penjualan_jasa:n.uuid,rincian_pesanan_penjualan_jasa:u[d].uuid,jumlah:`${u[d].jumlah_fix}`,denda_sudah_dibayar:`${u[d].denda_sudah_dibayar}`,sudah_dibayar:`${u[d].sudah_dibayar_fix}`,retur:`${u[d].retur}`,nilai_retur:`${u[d].nilai_retur}`,retur_sebelum:`${u[d].retur_sebelum}`,nilai_retur_sebelum:`${u[d].nilai_retur_sebelum}`}}).then(()=>Z("Berhasil","Data Berhasil Disimpan")).catch(O=>v(O));b()},x=()=>{oa.custom("/"+n.uuid,"DELETE").then(()=>{o()}).catch(d=>v(d))},m=async()=>{await ja(),await q()&&oa.custom("/"+n.uuid,"PUT",null,{data:{nomor_retur_penjualan_jasa:N,bukti_transaksi:F,keterangan:T,faktur_penjualan_jasa:n.faktur_penjualan_jasa,tanggal:n.tanggal,kode_akun_perkiraan:n.kode_akun_perkiraan}}).then(()=>Z("Berhasil","Data Berhasil Disimpan")).catch(d=>v(d))};return s.useEffect(()=>{j&&!f&&(b(),J(d=>!0))},[j]),a.jsxs("div",{className:"border-b-2 py-2",children:[a.jsx("div",{className:"cursor-pointer",onClick:()=>{g(d=>d=!d)},children:a.jsxs("div",{className:"flex items-center justify-between gap-x-2 px-4",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsx("p",{className:"text-sm pr-2 font-medium",children:ua(n.tanggal.split("T")[1])}),a.jsx("p",{className:"text-sm pr-2 font-medium px-4 border-l-2 border-black",children:"Retur Penjualan Jasa"})]}),i?a.jsx(xa,{size:15}):a.jsx(ha,{size:15})]})}),i?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"ml-4 py-4 px-4",children:[((t=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))==null?void 0:t.hasil_stok_opname_count)==0?a.jsx(a.Fragment,{}):a.jsx("p",{className:"text-xs font-medium text-green-600 my-3",children:(D=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))!=null&&D.nomor_perintah_stok_opname?`Telah Terdaftar Pada Surat Perintah Stok Opname ${(B=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))==null?void 0:B.nomor_perintah_stok_opname}`:""}),i?a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"text-left text-sm",children:[a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Nomor Retur Penjualan Jasa"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(G,{addClass:"px-0",name:"nomor_retur_penjualan_jasa",value:N,onchange:d=>w(d.target.value)}):n.nomor_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Bukti Transaksi"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(G,{addClass:"px-0",name:"bukti_transaksi",value:F,onchange:d=>z(d.target.value)}):n.bukti_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-5":""}`,children:"Kode Akun"}),a.jsx("td",{className:`px-5 ${l?"pb-5":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-5":""}`,children:[n.kode_akun_perkiraan_code," - ",n.kode_akun_perkiraan_name]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Total Retur"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-3":""}`,children:["Rp. ",p(P)]})]})]}),a.jsx("p",{className:`text-sm mt-3 ${l?"mt-5":""}`,children:"Keterangan"}),a.jsx("p",{className:"text-sm mb-3",children:l?a.jsx(G,{addClass:"mt-5",name:"keterangan",value:T,onchange:d=>_(d.target.value)}):n.keterangan}),a.jsxs("div",{className:"my-2 flex justify-between",children:[a.jsx("div",{children:l?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"mr-2 btn btn-sm bg-green-900 text-white",onClick:()=>m(),children:[a.jsx(ea,{size:12}),"Simpan"]}),a.jsxs("button",{className:"mr-2 btn btn-sm bg-red-500 text-white",onClick:()=>x(),children:[a.jsx(sa,{size:12}),"Hapus"]})]}):a.jsx(a.Fragment,{})}),j?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm border-red-500 text-red-500",onClick:()=>C(d=>d=!d),children:"Tutup Daftar Retur"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm bg-white border-gray-400",onClick:()=>C(d=>d=!d),children:"Lihat Daftar Retur"})})]}),j?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Jasa"}),a.jsx("th",{children:"Nama Jasa"}),a.jsx("th",{children:"Satuan Jasa"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Pelunasan Sudah Dibayar"}),a.jsx("th",{width:150,children:"Retur Sebelumnya"}),a.jsx("th",{width:150,children:"Retur"}),a.jsx("th",{children:"Nilai Retur"})]}),a.jsx("tbody",{children:u.map((d,O)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[O+1,"."]}),a.jsx("td",{children:d.kategori_harga_jasa_kode_jasa}),a.jsx("td",{children:d.daftar_jasa_name}),a.jsx("td",{children:d.satuan_jasa_name}),a.jsx("td",{children:d.daftar_gudang_name}),a.jsxs("td",{children:["Rp. ",p(d.sudah_dibayar_fix)]}),a.jsxs("td",{children:[p(d.retur_sebelum)," ",d.satuan_jasa_name]}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(G,{name:"retur",type:"text",other:{defaultValue:0},onchange:L=>{Q(L,d.jumlah_fix),$(L.target.value,d.uuid)},value:p(d.retur)})}):a.jsxs(a.Fragment,{children:[p(d.retur)," ",d.satuan_jasa_name]})}),a.jsxs("td",{children:["Rp. ",p(d.nilai_retur)]})]})}))})]})}),l?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn btn-sm bg-green-900 text-white",onClick:()=>{A()},children:"Simpan"})})}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]})}):a.jsx(a.Fragment,{})]})},Ka=({riwayatPengembalianDendaPenjualanJasa:n,edited:l,_getDaftarRiwayatTransaksi:o=()=>{}})=>{var A,x,m;const[N,w]=s.useState(n.nomor_transaksi!="EMPTY"?n.nomor_transaksi:""),[F,z]=s.useState(n.bukti_transaksi!="EMPTY"?n.bukti_transaksi:""),[T,_]=s.useState(n.keterangan!="EMPTY"?n.keterangan:"Tidak Ada"),[P,y]=s.useState(n.total),[f,J]=s.useState([]),[u,S]=s.useState(l),[j,C]=s.useState(l),i=()=>{ka.custom(`/pesanan/${n.uuid}`).then(t=>{J(t.data),y(D=>t.data.reduce((B,d)=>d.denda_yang_dikembalikan+B,0))}).catch(t=>v(t))},g=async()=>{for(let t=0;t<f.length;t++)await ka.custom(`${f[t].rincian_pengembalian_denda_penjualan_jasa?`/${f[t].rincian_pengembalian_denda_penjualan_jasa}`:""}`,f[t].rincian_pengembalian_denda_penjualan_jasa?"PUT":"POST",null,{data:{pengembalian_denda_penjualan_jasa:n.uuid,rincian_pesanan_penjualan_jasa:f[t].uuid,denda_yang_dikembalikan:`${f[t].denda_yang_dikembalikan}`}}).then(()=>{Z("Berhasil","Data Berhasil Disimpan")});i()},b=()=>{ma.custom("/"+n.uuid,"DELETE").then(()=>{o()}).catch(t=>v(t))},$=async()=>{await ja(),await q()&&ma.custom("/"+n.uuid,"PUT",null,{data:{nomor_pengembalian_denda_penjualan_jasa:N,bukti_transaksi:F,keterangan:T,faktur_penjualan_jasa:n.faktur_penjualan_jasa,tanggal:n.tanggal,kode_akun_perkiraan:n.kode_akun_perkiraan}}).then(()=>{g()}).catch(t=>v(t))};return s.useEffect(()=>{u&&i()},[u]),a.jsxs("div",{className:"border-b-2 py-2",children:[a.jsx("div",{className:"cursor-pointer",onClick:()=>{C(t=>t=!t)},children:a.jsxs("div",{className:"flex items-center justify-between gap-x-2 px-4",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsx("p",{className:"text-sm pr-2 font-medium",children:ua(n.tanggal.split("T")[1])}),a.jsx("p",{className:"text-sm pr-2 font-medium px-3 border-l-2 border-black",children:"Pengembalian Denda Penjualan Jasa"})]}),j?a.jsx(xa,{size:15}):a.jsx(ha,{size:15})]})}),j?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"ml-4 py-4 px-4",children:[((A=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))==null?void 0:A.hasil_stok_opname_count)==0?a.jsx(a.Fragment,{}):a.jsx("p",{className:"text-xs font-medium text-green-600 my-3",children:(x=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))!=null&&x.nomor_perintah_stok_opname?`Telah Terdaftar Pada Surat Perintah Stok Opname ${(m=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))==null?void 0:m.nomor_perintah_stok_opname}`:""}),j?a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"text-left text-sm",children:[a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Nomor Pengembalian Denda Penjualan Jasa"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(G,{addClass:"px-0",name:"nomor_pengembalian_denda_penjualan_jasa",value:N,onchange:t=>w(t.target.value)}):n.nomor_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Bukti Transaksi"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(G,{addClass:"px-0",name:"bukti_transaksi",value:F,onchange:t=>z(t.target.value)}):n.bukti_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-5":""}`,children:"Kode Akun"}),a.jsx("td",{className:`px-5 ${l?"pb-5":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-5":""}`,children:[n.kode_akun_perkiraan_code," - ",n.kode_akun_perkiraan_name]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Total PengembalianDenda"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-3":""}`,children:["Rp. ",p(P)]})]})]}),a.jsx("p",{className:`text-sm mt-3 ${l?"mt-5":""}`,children:"Keterangan"}),a.jsx("p",{className:"text-sm mb-3",children:l?a.jsx(G,{addClass:"mt-5",name:"keterangan",value:T,onchange:t=>_(t.target.value)}):n.keterangan}),a.jsxs("div",{className:"my-2 flex justify-between",children:[a.jsx("div",{children:l?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"mr-2 btn btn-sm bg-green-900 text-white",onClick:()=>$(),children:[a.jsx(ea,{size:12}),"Simpan"]}),a.jsxs("button",{className:"mr-2 btn btn-sm bg-red-500 text-white",onClick:()=>b(),children:[a.jsx(sa,{size:12}),"Hapus"]})]}):a.jsx(a.Fragment,{})}),u?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm border-red-500 text-red-500",onClick:()=>S(t=>t=!t),children:"Tutup Daftar PengembalianDenda"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm bg-white border-gray-400",onClick:()=>S(t=>t=!t),children:"Lihat Daftar PengembalianDenda"})})]}),u?a.jsx(a.Fragment,{children:a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Jasa"}),a.jsx("th",{children:"Nama Jasa"}),a.jsx("th",{children:"Satuan Jasa"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Denda Yang Dikembalikan"})]}),a.jsx("tbody",{children:f.map((t,D)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[D+1,"."]}),a.jsx("td",{children:t.kategori_harga_jasa_kode_jasa}),a.jsx("td",{children:t.daftar_jasa_name}),a.jsx("td",{children:t.satuan_jasa_name}),a.jsx("td",{children:t.daftar_gudang_name}),a.jsxs("td",{children:["Rp. ",p(t.denda_yang_dikembalikan)]})]})}))})]})})}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]})}):a.jsx(a.Fragment,{})]})},Ha=({fakturPenjualanJasa:n,setFakturCancel:l=()=>{},setTanggalTransaksiAkhir:o=()=>{}})=>{const[N,w]=s.useState(W()),[F,z]=s.useState({label:"Pelunasan",value:"Pelunasan"}),T=["Pelunasan","Retur","Pengembalian_Denda"],[_,P]=s.useState(),[y,f]=s.useState([]),[J,u]=s.useState([]),[S,j]=s.useState(!0),[C,i]=s.useState([]),g=()=>{j(x=>!1),l(x=>!0),i(x=>T.filter(m=>m!="Pengembalian_Denda").map(m=>({label:m.replace("_"," "),value:m}))),n&&ta.custom("/riwayat_transaksi/"+n.uuid).then(x=>{x.data.length>0&&(l(m=>!1),o(m=>x.data[0].tanggal),x.data.filter(m=>m.type=="retur_penjualan_jasa").length>0&&i(m=>T.map(t=>({label:t.replace("_"," "),value:t})))),u(m=>La(x.data))})},b=async x=>{if(x.preventDefault(),await q(x.target)){let m=aa;F.value=="Retur"&&(m=oa),F.value=="Pengembalian_Denda"&&(m=ma);const t={faktur_penjualan_jasa:n.uuid,tanggal:N,bukti_transaksi:"EMPTY",kode_akun_perkiraan:_.value,keterangan:"EMPTY"};t[`nomor_${F.value.toLowerCase()}_penjualan_jasa`]="EMPTY",m.custom("","POST",null,{data:t}).then(()=>{Z("Berhasil","Data Berhasil Disimpan"),g(),w(W())}).catch(D=>v(D))}},$=()=>{Na.custom("/kas_bank","GET").then(x=>{f(m=>x.data),x.data.length>0&&P({label:`${x.data[0].code} - ${x.data[0].name}`,value:x.data[0].uuid})})},A=()=>{Na.custom("/piutang_usaha","GET").then(x=>{const m=[x.data];f(t=>m),m.length>0&&P({label:`${m[0].code} - ${m[0].name}`,value:m[0].uuid})})};return s.useEffect(()=>{j(x=>!0)},[J]),s.useEffect(()=>{if(f(x=>[]),P(x=>null),$(),F.value=="Retur"&&(A(),J.length>0)){const x=J.filter(m=>m.data.filter(t=>t.type=="pelunasan_penjualan_jasa").length>0);if(x.length>0){const m=x[0].data.filter(t=>t.type=="pelunasan_penjualan_jasa");m.length>0&&aa.custom(`/cek_denda_pelunasan_penjualan/${m[0].uuid}`,"GET").then(t=>{t.data==0&&$()}).catch(t=>v(t))}}},[F]),s.useEffect(()=>{g(),$()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white rounded-md mt-4 py-6 px-6 shadow-2xl",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Riwayat Transaksi Penjualan Jasa"}),a.jsxs("form",{className:"mb-5 border-[3px] rounded-md py-2 px-3",onSubmit:x=>b(x),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(U,{label:"Tanggal",type:"datetime-local",onchange:x=>{w(x.target.value)},others:{value:N,name:"tanggal"}}),a.jsx(X,{label:"Tipe Transaksi",addClass:"z-50",optionsDataList:C,onchange:x=>{z(x)},optionsLabel:"label",optionsValue:"value",selectName:"tipe_transaksi",selectValue:F}),a.jsx(X,{label:"Kode Akun",optionsDataList:y,optionsLabel:["code","name"],optionsValue:"uuid",addClass:"z-50",optionsLabelIsArray:!0,optionsDelimiter:"-",selectValue:_,onchange:x=>{P(x)},selectName:"kodeAkun"})]}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(la,{})," Simpan"]})]}),a.jsx("div",{className:"flex flex-col max-h-[60vh] overflow-scroll no-scrollbar relative",children:S?a.jsx(a.Fragment,{children:J.map((x,m)=>a.jsxs("div",{className:"mb-5",children:[a.jsx("p",{className:"font-bold mb-3 sticky top-0 bg-gray-300 p-2 z-20",children:Fa("/",Ta(x.parent,!1))}),a.jsx("div",{className:"flex flex-col",children:x.data.map((t,D)=>{var B,d,O;return a.jsxs(a.Fragment,{children:[t.type=="pelunasan_penjualan_jasa"?a.jsx(a.Fragment,{children:a.jsx(za,{riwayatPelunasanPenjualanJasa:t,edited:((B=JSON.parse(t.perintah_stok_opname_nomor_surat_perintah))==null?void 0:B.hasil_stok_opname_count)>0?!1:m==0&&D==0,_getDaftarRiwayatTransaksi:g})}):a.jsx(a.Fragment,{}),t.type=="retur_penjualan_jasa"?a.jsx(a.Fragment,{children:a.jsx(Ba,{riwayatReturPenjualanJasa:t,edited:((d=JSON.parse(t.perintah_stok_opname_nomor_surat_perintah))==null?void 0:d.hasil_stok_opname_count)>0?!1:m==0&&D==0,_getDaftarRiwayatTransaksi:g})}):a.jsx(a.Fragment,{}),t.type=="pengembalian_denda_penjualan_jasa"?a.jsx(a.Fragment,{children:a.jsx(Ka,{riwayatPengembalianDendaPenjualanJasa:t,edited:((O=JSON.parse(t.perintah_stok_opname_nomor_surat_perintah))==null?void 0:O.hasil_stok_opname_count)>0?!1:m==0&&D==0,_getDaftarRiwayatTransaksi:g})}):a.jsx(a.Fragment,{})]})})})]}))}):a.jsx(a.Fragment,{children:a.jsx("p",{className:"font-bold",children:"Riwayat Transaksi Belum Ada."})})})]})})},Ua=({pesananPenjualanJasa:n,setFakturStatus:l=()=>{},fakturStatus:o,ppnStatus:N,setTanggalTransaksiAkhir:w=()=>{}})=>{const[F,z]=s.useState(),[T,_]=s.useState(!0),[P,y]=s.useState([]),[f,J]=s.useState([]),[u,S]=s.useState(W()),[j,C]=s.useState(),[i,g]=s.useState(),[b,$]=s.useState(),[A,x]=s.useState(),[m,t]=s.useState(),[D,B]=s.useState(""),d=()=>{ya.custom("","GET").then(r=>{y(e=>r.data.entry),r.data.entry.length>0&&$(e=>({label:r.data.entry[0].name,value:r.data.entry[0].uuid}))})},O=()=>{Sa.custom("/type/"+b.value,"GET").then(r=>{J(e=>r.data),r.data.length>0&&x(e=>({label:r.data[0].name,value:r.data[0].uuid}))})},L=async r=>{r.preventDefault(),await q(r.target)&&ta.custom("","POST",null,{data:{pesanan_penjualan_jasa:n.uuid,tanggal:u,nomor_faktur_penjualan_jasa:j,bukti_transaksi:i,tipe_pembayaran:b.value,syarat_pembayaran:A.value,keterangan:m,nomor_faktur_pajak_penjualan_jasa:D||"EMPTY"}}).then(e=>{l(E=>e.data.uuid)}).catch(e=>v(e))},H=()=>{ta.custom(`/${o}`,"DELETE").then(()=>{l(r=>null)}).catch(r=>v(r))};s.useEffect(()=>{b!=null&&b.value&&O()},[b]);const c=()=>{ta.custom(`/pesanan_penjualan_jasa/${n.uuid}`,"GET").then(r=>{r.data&&(z(e=>r.data),C(e=>r.data.nomor_faktur_penjualan_jasa),g(e=>r.data.bukti_transaksi),S(e=>r.data.tanggal),$(e=>r.data.tipe_pembayaran_name),x(e=>r.data.syarat_pembayaran_name),t(e=>r.data.keterangan),l(e=>r.data.uuid),B(e=>r.data.nomor_faktur_pajak_penjualan_jasa!="EMPTY"?r.data.nomor_faktur_pajak_penjualan_jasa:""))}).catch(r=>{l(e=>null)})};return s.useEffect(()=>{o!=null?c():d()},[o]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white rounded-md py-6 px-6 shadow-2xl",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Faktur Penjualan Jasa"}),a.jsxs("form",{onSubmit:r=>L(r),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(U,{label:"Tanggal Faktur Penjualan Jasa",type:"datetime-local",onchange:r=>{S(r.target.value)},disabled:o,addClassInput:o?"border-none px-1":"",others:{value:u,name:"tanggalFakturPenjualanJasa",disabled:o}}),a.jsx(U,{label:"Nomor Faktur Penjualan Jasa",type:"text",onchange:r=>{C(r.target.value)},disabled:o,addClassInput:o?"border-none px-1":"",others:{value:j,name:"nomorFakturPenjualanJasa",disabled:o}}),a.jsx(U,{label:"Bukti Transaksi",type:"text",disabled:o,addClassInput:o?"border-none px-1":"",onchange:r=>{g(r.target.value)},others:{value:i,name:"buktiTransaksi",disabled:o}}),o?a.jsxs(a.Fragment,{children:[a.jsx(U,{label:"Tipe Pembayaran",type:"text",disabled:o,addClassInput:o?"border-none px-1":"",others:{value:b,name:"tipePembayaran",disabled:o}}),a.jsx(U,{label:"Syarat Pembayaran",type:"text",disabled:o,addClassInput:o?"border-none px-1":"",others:{value:A,name:"syaratPembayaran",disabled:o}})]}):a.jsxs(a.Fragment,{children:[a.jsx(X,{label:"Tipe Pembayaran",optionsDataList:P,optionsLabel:"name",optionsValue:"uuid",selectValue:b,onchange:r=>{$(r)},selectName:"tipePembayaran"}),a.jsx(X,{label:"Syarat Pembayaran",optionsDataList:f,optionsLabel:"name",optionsValue:"uuid",selectValue:A,onchange:r=>{x(r)},selectName:"syaratPembayaran"})]})]}),a.jsx("div",{className:"flex gap-x-2",children:a.jsx(U,{label:"Keterangan",type:"text",disabled:o,addClassInput:o?"border-none px-1":"",onchange:r=>{t(r.target.value)},others:{value:m,name:"keteranganFakturPenjualanJasa",disabled:o}})}),N?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex gap-x-2",children:a.jsx(U,{label:"Nomor Faktur Pajak",type:"text",disabled:o,addClassInput:o?"border-none px-1":"",onchange:r=>{B(r.target.value)},others:{value:D,name:"nomorFakturPajakFakturPenjualanJasa",disabled:o}})})}):a.jsx(a.Fragment,{}),o?a.jsx(a.Fragment,{children:T?a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-red-800 mt-4 text-white",type:"button",onClick:()=>H(),children:[a.jsx(I,{})," Batalkan Faktur"]})}):a.jsx(a.Fragment,{})}):a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(la,{})," Simpan"]})})]})]}),o?a.jsx(a.Fragment,{children:a.jsx(Ha,{fakturPenjualanJasa:F,setFakturCancel:_,setTanggalTransaksiAkhir:w})}):a.jsx(a.Fragment,{})]})},Ga=({setAddPenjualanJasa:n=()=>{}})=>{$a();const[l,o]=s.useState(W()),[N,w]=s.useState(!1),[F,z]=s.useState(!1),[T,_]=s.useState(!1),[P,y]=s.useState(!1),[f,J]=s.useState([]),[u,S]=s.useState(!0),[j,C]=s.useState([]),[i,g]=s.useState([]),[b,$]=s.useState(""),[A,x]=s.useState(W()),[m,t]=s.useState(),[D,B]=s.useState(!1),[d,O]=s.useState(""),[L,H]=s.useState({page:1,size:2,count:118,lastPage:12}),c=({selected:h})=>{let k=L;k.page=h+1,H(k),R()},r=h=>{let k=L;k.size=h,k.page=1,H(k),R()},[e,E]=s.useState(),R=(h="")=>{h==""&&O(h),Ra.custom(`?search=${h}&page=${L.page}&size=${L.size}`,"GET").then(k=>{var V,na;B(h.length<1),g((V=k==null?void 0:k.data)==null?void 0:V.entry),H((na=k==null?void 0:k.data)==null?void 0:na.pagination)}).catch(k=>{v(k)})},M=()=>{ra.custom(`/${e.uuid}`,"DELETE").then(h=>{E(null),ga()}).catch(h=>v(h))},K=async h=>{h.preventDefault(),await q(h.target)&&ra.custom(u?`/${u.value}`:"",u?"PUT":"POST",null,{data:{nomor_pesanan_penjualan_jasa:b,tanggal_pesanan_penjualan_jasa:A,customer:m.uuid}}).then(k=>{if(u){const V=f.filter(na=>na.uuid==u.value);E(V[0])}else E(k.data);y(V=>!0)}).catch(k=>{v(k),u&&(pa(),y(V=>!0),E(f.filter(V=>V.uuid==u.value)[0]))})},pa=()=>{t(k=>null),x(k=>W()),$(k=>null);const h=f.filter(k=>k.uuid==u.value);if(h.length>0){const k=i.filter(V=>V.uuid==h[0].customer);k.length>0&&(t(V=>k[0]),x(h[0].tanggal_pesanan_penjualan_jasa),$(h[0].nomor_pesanan_penjualan_jasa))}};s.useEffect(()=>{u&&pa()},[u]);const ga=()=>{ra.custom("","GET").then(h=>{J(k=>h.data.entry),h.data.entry.length>0&&S(k=>({label:h.data.entry[0].nomor_pesanan_penjualan_jasa,value:h.data.entry[0].uuid}))}).catch(h=>v(h))};return s.useEffect(()=>{T?ga():($(h=>""),S(h=>!1),x(h=>W()),t(h=>null))},[T]),s.useEffect(()=>{R()},[]),a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-white rounded-md shadow-sm h-max",children:a.jsxs("div",{className:"py-5 px-6 h-max w-full z-10",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-2",children:"Pesanan Penjualan Jasa"})}),a.jsxs("form",{onSubmit:h=>K(h),children:[a.jsxs("div",{className:"flex items-end gap-x-2",children:[a.jsxs("div",{className:"flex items-end gap-x-2 w-full",children:[T&&!e?a.jsx(a.Fragment,{children:a.jsx(X,{label:"Nomor Pesanan Penjualan Jasa",optionsDataList:f,optionsLabel:"nomor_pesanan_penjualan_jasa",optionsValue:"uuid",selectValue:u,onchange:h=>{S(h)},selectName:"pesananPenjualanJasaSelected"})}):a.jsx(a.Fragment,{children:a.jsx(U,{label:"Nomor Pesanan Penjualan Jasa",type:"text",disabled:e&&P,addClassInput:e&&P?"border-none px-1":"",onchange:h=>{$(h.target.value)},others:{value:b,name:"nomorPesananPenjualanJasa",disabled:e&&P}})}),e?a.jsx(a.Fragment,{children:j.length!=0||N?a.jsx(a.Fragment,{}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:`btn btn-sm ${P?"bg-yellow-400 hover:bg-yellow-400":""}`,onClick:()=>{y(h=>h=!h)},children:[P?a.jsx(Ca,{}):a.jsx(I,{})," ",P?"Edit":"Batal Edit"," Nomor Pesanan"]}),a.jsxs("button",{type:"button",onClick:()=>M(),className:"btn btn-sm bg-red-700 text-white",children:[a.jsx(sa,{})," Hapus Nomor Pesanan"]})]})}):a.jsx(a.Fragment,{children:a.jsxs("button",{type:"button",className:`btn btn-sm ${T?"bg-red-900":"bg-blue-900"} text-white border-none`,onClick:()=>{_(h=>h=!h)},children:[T?a.jsx(I,{}):a.jsx(fa,{}),T?"Batal Pesanan Penjualan":"Pilih Pesanan Penjualan"]})})]}),a.jsx(U,{label:"Tanggal Pesanan Penjualan Jasa",type:"datetime-local",onchange:h=>{x(h.target.value)},disabled:e,addClassInput:e?"border-none px-1":"",others:{value:A,name:"tanggalPesananPenjualanJasa",disabled:e}})]}),m?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"mt-5 relative px-1",children:[a.jsx("p",{className:"font-bold text-sm mb-3",children:"Customer Terpilih"}),a.jsxs("p",{className:"text-xl font-bold",children:[m.code," - ",m.name]}),a.jsxs("div",{className:"mt-3 flex gap-x-10",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Alamat Rumah"}),a.jsx("p",{className:"text-sm",children:m.alamat_rumah})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Alamat Kantor"}),a.jsx("p",{className:"text-sm",children:m.alamat_kantor})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"NPWP"}),a.jsx("p",{className:"text-sm",children:m.npwp})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Nomor Telepon"}),a.jsx("p",{className:"text-sm",children:m.no_telp})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Nomor Handphone"}),a.jsx("p",{className:"text-sm",children:m.no_hp})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Kode Harga"}),a.jsxs("p",{className:"text-sm",children:["Harga ",m.kode_harga]})]})]}),e?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"absolute top-0 right-3 flex mt-3 py-1 px-2 gap-x-2 items-center font-bold text-xs rounded-md bg-red-800 text-white",onClick:()=>{t(null)},type:"button",children:a.jsx(I,{})})})]})}):a.jsx(a.Fragment,{}),m?a.jsx(a.Fragment,{children:e&&P?a.jsx(a.Fragment,{children:a.jsxs("button",{type:"button",onClick:()=>{E(h=>null),t(h=>null),_(h=>!1),w(h=>!1)},className:"btn btn-sm bg-red-800 mt-4 text-white",children:[a.jsx(I,{})," Reset Pesanan Penjualan"]})}):a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(la,{})," Simpan"]})})}):a.jsx(a.Fragment,{})]}),m?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"mt-5",children:[a.jsxs("div",{className:"flex w-full items-center gap-x-2 mb-5",children:[a.jsx(G,{value:d,onchange:h=>O(h.target.value),other:{placeholder:"Cari Customer"}}),D?a.jsx(fa,{onClick:()=>{R(d)},className:"cursor-pointer"}):a.jsx(I,{onClick:()=>R(""),className:"cursor-pointer"})]}),a.jsxs("table",{className:"table table-zebra",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Kode Customer"}),a.jsx("th",{children:"Nama Customer"}),a.jsx("th",{children:"Kode Harga"}),a.jsx("th",{children:"Aksi"})]})}),a.jsx("tbody",{children:i==null?void 0:i.map((h,k)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[k+1,"."]}),a.jsx("td",{width:400,children:h.code}),a.jsx("td",{width:400,children:h.name}),a.jsxs("td",{width:400,children:["Harga ",h.kode_harga]}),a.jsx("td",{children:a.jsxs("button",{className:"flex py-1 px-5 gap-x-2 items-center rounded-xl bg-green-800 text-white",onClick:()=>{t(V=>h)},type:"button",children:[a.jsx(ea,{size:12.5}),a.jsx("p",{children:"Pilih"})]})})]},k)}))})]}),a.jsx(wa,{paginateUpdatePage:c,paginate:L,setSize:r,shadow:"",sizeList:[2,4,6]})]})})]})}),e&&P?a.jsxs(a.Fragment,{children:[a.jsx(Oa,{pesananPenjualanJasa:e,customer:m,fakturStatus:N,setPPNStatus:z,tanggalTransaksiAkhir:l,rincianPesananPenjualanJasa:j,setRincianPesananPenjualanJasa:C}),a.jsx(Ua,{pesananPenjualanJasa:e,setFakturStatus:w,fakturStatus:N,ppnStatus:F,setTanggalTransaksiAkhir:o})]}):a.jsx(a.Fragment,{})]})},se=()=>{const[n,l]=s.useState(!1),[o,N]=s.useState(!1);return s.useState(""),s.useState(!0),a.jsx(Da,{isLoading:n,children:a.jsxs("div",{children:[a.jsx(Ja,{title:"Penjualan Jasa"}),a.jsx(Ga,{setAddPenjualanJasa:N})]})})};export{se as default};
