import{w as J,r as l,a7 as k,j as a,d as W,Q as v,be as z,m as M,o as Q,bU as V,v as A,t as m,az as S,as as N,aw as Y,a3 as q,R as X,W as Z,x as O,y as E,l as aa,z as U,n as ea,f as sa,b as ta,F as na,D as la}from"./index-s7IRrMev.js";import{P as ca}from"./Pagination-BqCrcN68.js";import{F as $}from"./FormInputWithLabel-DNO00jay.js";import{P as ia,l as ga}from"./PDFHeader-mTwqq47U.js";import"./react-paginate-B2Dhbjlf.js";import"./index-BKNjMPK8.js";const ua=({setAddPerintahStokOpnameEvent:g=()=>{},perintahStokOpnameEdit:e,getData:c=()=>{}})=>{const w=J(),{data:o}=w,[P,y]=l.useState(e!=null&&e.tanggal?e.tanggal:k()),[d,L]=l.useState(e!=null&&e.bulan_transaksi?e.bulan_transaksi:k()),[_,K]=l.useState(e!=null&&e.nomor_surat_perintah?e.nomor_surat_perintah:""),[T,b]=l.useState(e!=null&&e.pegawai_penanggung_jawab?e.pegawai_penanggung_jawab:""),[f,x]=l.useState(e!=null&&e.pegawai_pelaksana?e.pegawai_pelaksana:""),[F,u]=l.useState(e!=null&&e.kategori_barang?e.kategori_barang:""),[h,i]=l.useState(e!=null&&e.gudang_asal?e.gudang_asal:"");l.useState(e!=null&&e.validasi?e.validasi:"");const[r,G]=l.useState(),[C,R]=l.useState([]),[n,t]=l.useState([]),[j,B]=l.useState([]),H=async()=>{await Q()&&V.custom(`${e!=null&&e.uuid?`/${e.uuid}`:""}`,e?"PUT":"POST",null,{data:{tanggal:P,bulan_transaksi:d.value,tahun:o.tahun,nomor_surat_perintah:_,pegawai_penanggung_jawab:T.value,pegawai_pelaksana:f.value,kategori_barang:F.value,gudang_asal:h.value,validasi:!1}}).then(()=>{e?A("Berhasil","Data berhasil diupdate"):A("Berhasil","Data berhasil disimpan"),g(),c()}).catch(s=>{m(s)})},I=()=>{S.custom("","GET").then(s=>{if(t(s.data.entry),s.data.entry.length>0){if(e){N({editObject:e.kategori_barang,dataList:s.data.entry,setState:u,labelKey:"name",valueKey:"uuid"});return}u({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>m(s))},p=()=>{Y.custom("","GET").then(s=>{if(B(s.data.entry),s.data.entry.length>0){if(e){N({editObject:e.gudang_asal,dataList:s.data.entry,setState:i,labelKey:"name",valueKey:"uuid"}),N({editObject:e.bulan_transaksi,dataList:z(),setState:L,labelKey:"label",valueKey:"value"});return}i({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>m(s))},D=()=>{q.custom("","GET").then(s=>{if(R(s.data.entry),s.data.entry.length>0){if(e){N({editObject:e.pegawai_penanggung_jawab,dataList:s.data.entry,setState:b,labelKey:"name",valueKey:"uuid"}),N({editObject:e.pegawai_pelaksana,dataList:s.data.entry,setState:x,labelKey:"name",valueKey:"uuid"});return}b({label:s.data.entry[0].name,value:s.data.entry[0].uuid}),x({label:s.data.entry[0].name,value:s.data.entry[0].uuid})}}).catch(s=>m(s))};return l.useEffect(()=>{D(),I(),p()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[e?"Edit":"Tambahkan"," Perintah Stok Opname"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>g(),children:[a.jsx(W,{})," Batalkan Perintah Stok Opname"]})]}),a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx($,{label:"Tanggal",type:"datetime-local",onchange:s=>{y(s.target.value)},others:{value:P,name:"tanggal"}}),a.jsx($,{label:"Nomor Perintah Stok Opname",type:"text",onchange:s=>{K(s.target.value)},others:{value:_,name:"nomorPerintahStokOpname"}}),a.jsx(v,{label:"Bulan Transaksi",optionsDataList:z(),optionsLabel:"label",optionsValue:"value",disabled:r,selectValue:d,onchange:s=>{L(s)},selectName:"bulanTransaksi"}),a.jsx(v,{label:"Pegawai Penanggung Jawab",optionsDataList:C,optionsLabel:"name",optionsValue:"uuid",disabled:r,selectValue:T,onchange:s=>{b(s)},selectName:"pegawaiPenanggungJawab"})]}),a.jsxs("div",{className:"mt-5 flex gap-x-2",children:[a.jsx(v,{label:"Pegawai Pelaksana",optionsDataList:C,optionsLabel:"name",optionsValue:"uuid",disabled:r,selectValue:f,onchange:s=>{x(s)},selectName:"pegawaiPelaksana"}),a.jsx(v,{label:"Kategori Barang",optionsDataList:n,optionsLabel:"name",optionsValue:"uuid",disabled:r,selectValue:F,onchange:s=>{u(s)},selectName:"kategoriBarang"}),a.jsx(v,{label:"Gudang Asal",optionsDataList:j,optionsLabel:"name",optionsValue:"uuid",disabled:r,selectValue:h,onchange:s=>{i(s)},selectName:"gudangAsal"})]}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",onClick:()=>{H()},children:[a.jsx(M,{})," Simpan"]})]})})},ra=X.forwardRef((g,e)=>{var c;return a.jsxs("div",{ref:e,children:[a.jsx(ia,{bulan:g.bulan,tahun:g.tahun,title:"Perintah Stok Opname"}),a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Perintah Stok Opname"})]})}),a.jsx("tbody",{children:(c=g==null?void 0:g.data)==null?void 0:c.map((w,o)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:o+1}),a.jsx("td",{children:w.name})]},o)}))})]})]})}),ma=()=>{const g=J(),{data:e}=g,[c,w]=l.useState([]),[o,P]=l.useState(!1),[y,d]=l.useState(!1),[L,_]=l.useState({name:""}),[K,T]=l.useState(!1),[b,f]=l.useState(""),x=l.useRef(),F=ga.useReactToPrint({content:()=>x.current}),[u,h]=l.useState({page:1,size:10,count:118,lastPage:12}),i=(n="")=>{n==""&&f(n),P(!0),V.custom(`?search=${n}&page=${u.page}&size=${u.size}&tahun=${e.tahun}`,"GET").then(t=>{var j,B;T(n.length<1),w((j=t==null?void 0:t.data)==null?void 0:j.entry),h((B=t==null?void 0:t.data)==null?void 0:B.pagination),P(!1)}).catch(t=>{m(t)})},r=n=>{let t=c[n];_(t),d(!y)},G=async n=>{if(await la("Hapus","Yakin ingin hapus data ini ?")){let t=c[n];V.custom(`/${t.uuid}`,"DELETE").then(()=>{A("Berhasil","Data berhasil dihapus"),i()}).catch(j=>{m(j)})}},C=({selected:n})=>{let t=u;t.page=n+1,h(t),i()},R=n=>{let t=u;t.size=n,t.page=1,h(t),i()};return l.useEffect(()=>{i()},[]),a.jsx(Z,{isLoading:o,children:a.jsxs("div",{children:[a.jsx(O,{title:"Perintah Stok Opname"}),y?a.jsx(ua,{setAddPerintahStokOpnameEvent:()=>d(!1),getData:i,perintahStokOpnameEdit:L}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:b,onChange:n=>f(n.target.value)}),K?a.jsx(E,{onClick:()=>{i(b)},className:"cursor-pointer"}):a.jsx(W,{onClick:()=>i(""),className:"cursor-pointer"})]}),a.jsxs("div",{className:"flex gap-x-2 items-center",children:[a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{_(null),d(!y)},children:[a.jsx(aa,{})," Tambah Perintah Stok Opname"]}),a.jsx("div",{className:"hidden",children:a.jsx(ra,{data:c,ref:x,bulan:U(new Date().getMonth()),tahun:e.tahun})}),a.jsxs("button",{onClick:F,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[a.jsx(ea,{})," Cetak Perintah Stok Opname"]})]})]}),a.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Tanggal"}),a.jsx("th",{children:"Bulan Transaksi"}),a.jsx("th",{children:"Nomor Perintah Stok Opname"}),a.jsx("th",{children:"Pegawai Penanggung Jawab"}),a.jsx("th",{children:"Pegawai Pelaksana"}),a.jsx("th",{children:"Kategori Barang"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Aksi"})]})}),a.jsx("tbody",{children:c==null?void 0:c.map((n,t)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[t+1,"."]}),a.jsx("td",{children:sa(n.tanggal,!0)}),a.jsx("td",{children:U(n.bulan_transaksi-1)}),a.jsx("td",{children:n.nomor_surat_perintah}),a.jsx("td",{children:n.pegawai_penanggung_jawab_name}),a.jsx("td",{children:n.pegawai_pelaksana_name}),a.jsx("td",{children:n.kategori_barang_name}),a.jsx("td",{children:n.daftar_gudang_name}),a.jsxs("td",{className:"flex gap-x-2",children:[a.jsx(ta,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{r(t)}}),a.jsx(na,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{G(t)}})]})]},t)}))})]})}),a.jsx(ca,{paginateUpdatePage:C,paginate:u,setSize:R})]})]})})};export{ma as default};
