import{r as l,j as e,b as M,h as $,k as B,aC as S,n as C,s as P,ag as O,ah as U,R as V,u as G,o as I,e as W,p as D,i as H,a as q,F as E,q as Y}from"./index-CfdqnSWR.js";import{P as J}from"./PageTitle-CmNDlYSt.js";import{f as T,W as Q}from"./Wrap-3qI6yka0.js";import{P as X}from"./Pagination-DavfY6jw.js";import{F as _}from"./FormInputWithLabel-y6_NyoPB.js";import{F as L}from"./FormSelectWithLabel-Bho4ATIP.js";import{a as Z}from"./actionEvent.helper-BujKUZ7B.js";import{P as ee,l as te}from"./PDFHeader-DCDc6P0a.js";import{p as A}from"./number.helper-efe0YCx6.js";import"./react-paginate-WCnuu2E5.js";import"./FormInput-Cl28VpMz.js";import"./index-BKNjMPK8.js";const ae=({setAddPersentasePenyusutanEvent:o=()=>{},persentasePenyusutanEdit:s,getData:i=()=>{}})=>{const[x,h]=l.useState([]),[p,u]=l.useState(null),[m,N]=l.useState([]),[r,b]=l.useState(null),[v,g]=l.useState(null),[c,j]=l.useState(s!=null&&s.persentase?s.persentase:0),w=async()=>{await B()&&S.custom(`${s!=null&&s.uuid?`/${s.uuid}`:""}`,s?"PUT":"POST",null,{data:{metode_penyusutan:p.value,kelompok_aset:r.value,persentase:c}}).then(()=>{s?C("Berhasil","Data berhasil diupdate"):C("Berhasil","Data berhasil disimpan"),o(),i()}).catch(t=>{P(t)})},d=()=>{O.custom("","GET").then(t=>{if(h(t.data.entry),t.data.entry.length>0){if(s){T({editObject:s.metode_penyusutan,dataList:t.data.entry,setState:u,labelKey:"name",valueKey:"uuid"});return}u({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}}).catch(t=>{P(t)})},y=()=>{U.custom("","GET").then(t=>{if(N(t.data.entry),t.data.entry.length>0){if(s){T({editObject:s.kelompok_aset,dataList:t.data.entry,setState:b,labelKey:"name",valueKey:"uuid"});return}b({label:t.data.entry[0].name,value:t.data.entry[0].uuid})}}).catch(t=>{P(t)})};return l.useEffect(()=>{if(r){const t=m.filter(f=>f.uuid==r.value);t.length>0&&g(f=>`${t[0].masa_penyusutan} Tahun`)}},[r]),l.useEffect(()=>{parseFloat(c)>100&&j(t=>100)},[c]),l.useEffect(()=>{d(),y()},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[e.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[e.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[s?"Edit":"Tambahkan"," Persentase Penyusutan"]}),e.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>o(),children:[e.jsx(M,{})," Batalkan Persentase Penyusutan"]})]}),e.jsxs("div",{className:"flex gap-x-2",children:[e.jsx(L,{label:"Metode Penyusutan",optionsDataList:x,optionsLabel:"name",optionsValue:"uuid",selectValue:p,onchange:t=>{u(t)},selectName:"metodePenyusutan"}),e.jsx(L,{label:"Kelompok Aset",optionsDataList:m,optionsLabel:"name",optionsValue:"uuid",selectValue:r,onchange:t=>{b(t)},selectName:"kelompokAset"}),e.jsx(_,{label:"Masa Penyusutan ( Tahun )",type:"text",disabled:!0,addClassInput:"pointer-events-none border-none",others:{value:v,name:"namaMasaPenyusutan"}}),e.jsx(_,{label:"Persentase ( % )",type:"text",onchange:t=>{Z(t,100),j(t.target.value)},others:{value:c,name:"nilaiPersentasePenyusutan"}})]}),e.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",onClick:()=>{w()},children:[e.jsx($,{})," Simpan"]})]})})},se=V.forwardRef((o,s)=>{var i;return e.jsxs("div",{ref:s,children:[e.jsx(ee,{bulan:o.bulan,tahun:o.tahun,title:"Daftar Persentase Penyusutan"}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[e.jsx("th",{width:12,children:"No"}),e.jsx("th",{children:"Nama Persentase Penyusutan"})]})}),e.jsx("tbody",{children:(i=o==null?void 0:o.data)==null?void 0:i.map((x,h)=>e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{children:h+1}),e.jsx("td",{children:x.name})]},h)}))})]})]})}),be=()=>{const o=G(),{data:s}=o,[i,x]=l.useState([]),[h,p]=l.useState(!1),[u,m]=l.useState(!1),[N,r]=l.useState({name:""}),[b,v]=l.useState(!1),[g,c]=l.useState(""),j=l.useRef(),w=te.useReactToPrint({content:()=>j.current}),[d,y]=l.useState({page:1,size:10,count:118,lastPage:12}),t=(n="")=>{n==""&&c(n),p(!0),S.custom(`?search=${n}&page=${d.page}&size=${d.size}`,"GET").then(a=>{var k,F;v(n.length<1),x((k=a==null?void 0:a.data)==null?void 0:k.entry),y((F=a==null?void 0:a.data)==null?void 0:F.pagination),p(!1)}).catch(a=>{P(a)})},f=n=>{let a=i[n];r(a),m(!u)},R=async n=>{if(await Y("Hapus","Yakin ingin hapus data ini ?")){let a=i[n];S.custom(`/${a.uuid}`,"DELETE").then(()=>{C("Berhasil","Data berhasil dihapus"),t()}).catch(k=>{P(k)})}},K=({selected:n})=>{let a=d;a.page=n+1,y(a),t()},z=n=>{let a=d;a.size=n,a.page=1,y(a),t()};return l.useEffect(()=>{t()},[]),e.jsx(Q,{isLoading:h,children:e.jsxs("div",{children:[e.jsx(J,{title:"Persentase Penyusutan"}),u?e.jsx(ae,{setAddPersentasePenyusutanEvent:()=>m(!1),getData:t,persentasePenyusutanEdit:N}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[e.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[e.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:g,onChange:n=>c(n.target.value)}),b?e.jsx(I,{onClick:()=>{t(g)},className:"cursor-pointer"}):e.jsx(M,{onClick:()=>t(""),className:"cursor-pointer"})]}),e.jsxs("div",{className:"flex gap-x-2 items-center",children:[e.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{r(null),m(!u)},children:[e.jsx(W,{})," Tambah Persentase Penyusutan"]}),e.jsx("div",{className:"hidden",children:e.jsx(se,{data:i,ref:j,bulan:D(new Date().getMonth()),tahun:s.tahun})}),e.jsxs("button",{onClick:w,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[e.jsx(H,{})," Cetak Persentase Penyusutan"]})]})]}),e.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[e.jsx("th",{width:12,children:"No"}),e.jsx("th",{children:"Metode Penyusutan"}),e.jsx("th",{children:"Kelompok Aset"}),e.jsx("th",{children:"Masa Penyusutan"}),e.jsx("th",{children:"Persentase"}),e.jsx("th",{children:"Aksi"})]})}),e.jsx("tbody",{children:i==null?void 0:i.map((n,a)=>e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsxs("td",{children:[a+1,"."]}),e.jsx("td",{children:n.metode_penyusutan_name}),e.jsx("td",{children:n.kelompok_aset_name}),e.jsxs("td",{children:[A(n.masa_penyusutan)," Tahun"]}),e.jsxs("td",{children:[A(n.persentase)," %"]}),e.jsxs("td",{className:"flex gap-x-2",children:[e.jsx(q,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{f(a)}}),e.jsx(E,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{R(a)}})]})]},a)}))})]})}),e.jsx(X,{paginateUpdatePage:K,paginate:d,setSize:z})]})]})})};export{be as default};
