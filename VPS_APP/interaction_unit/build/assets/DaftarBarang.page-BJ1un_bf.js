import{r,a7 as Q,j as a,Q as F,m as $,F as J,o as U,aS as V,t as x,aw as q,al as P,e as I,p as W,at as X,aT as T,aU as K,d as M,aV as A,v as z,az as Z,as as R,ao as E,aA as aa,R as ea,w as ta,W as na,x as sa,y as la,l as ra,z as ia,n as ca,b as oa,D as ua}from"./index-CO8-hfmv.js";import{P as ga}from"./Pagination-B30QOCvn.js";import{F as G}from"./FormInputWithLabel-l7OAzjDT.js";import{i as Y}from"./actionEvent.helper-DI7EF-i2.js";import{P as ha,l as da}from"./PDFHeader-DRSjrNMu.js";import"./react-paginate-CmyO5oXO.js";import"./index-BKNjMPK8.js";const xa=({idDaftarBarang:g,kategoriHargaBarangList:t})=>{const[h,u]=r.useState(),[m,N]=r.useState(t.length>0?{label:t[0].kode_barang,value:t[0].uuid}:null),[b,f]=r.useState(0),[y,B]=r.useState(Q()),[w,v]=r.useState([]),[k,S]=r.useState([]),D=async l=>{l.preventDefault(),await U(l.target)&&V.custom("","POST",null,{data:{daftar_barang:g,daftar_gudang:h.value,kategori_harga_barang:m.value,jumlah:`${b}`,tanggal:`${y}`}}).then(()=>{d()}).catch(j=>{x(j)})},p=()=>{q.custom("","GET").then(l=>{v(l.data.entry),l.data.entry.length>0&&u({label:l.data.entry[0].name,value:l.data.entry[0].uuid})}).catch(l=>{x(l)})},d=()=>{V.custom(`/${g}`,"GET").then(l=>{S(l.data)}).catch(l=>{x(l)})},_=l=>{V.custom(`/${l.uuid}`,"DELETE").catch(j=>{x(j)}).finally(()=>d())};return r.useEffect(()=>{p(),d()},[]),a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"mt-16 mb-5 uppercase text-gray-600 font-bold",children:"Stok Awal Barang"}),a.jsx("form",{onSubmit:l=>D(l),className:"pb-6",children:a.jsxs("div",{className:"flex gap-x-2 items-end",children:[a.jsx(F,{label:"Gudang Barang",optionsDataList:w,optionsLabel:"name",optionsValue:"uuid",selectValue:h,onchange:l=>{u(l)},selectName:"gudangBarang"}),a.jsx(F,{label:"Kode Barang",optionsDataList:t,optionsLabel:"kode_barang",optionsValue:"uuid",selectValue:m,onchange:l=>{N(l)},selectName:"kategoriHargaBarang"}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx($,{})," Simpan"]})]})}),a.jsxs("table",{className:"table table-sm table-zebra",children:[a.jsxs("thead",{className:"py-4 text-black",children:[a.jsx("th",{children:"No"}),a.jsx("th",{children:"Daftar Gudang Name"}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Satuan"}),a.jsx("th",{children:"Aksi"})]}),a.jsx("tbody",{children:k.map((l,j)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:j+1}),a.jsx("td",{children:l.daftar_gudang_name}),a.jsx("td",{children:l.kategori_harga_barang_kode_barang}),a.jsx("td",{children:l.satuan_barang_name}),a.jsx("td",{width:100,children:a.jsx("div",{className:"flex gap-x-2",children:a.jsx(J,{onClick:()=>_(l),className:"text-red-500 cursor-pointer",size:12})})})]})}))})]})]})},ma=({idDaftarbarang:g})=>{const[t,h]=r.useState(!1),[u,m]=r.useState([]),[N,b]=r.useState([]),[f,y]=r.useState(),[B,w]=r.useState(),[v,k]=r.useState([]),S=()=>{y(e=>null),b(e=>[]),h(e=>!1),X.custom("","GET").then(e=>{b(e.data.entry),h(o=>!0),y({label:e.data.entry[0].name,value:e.data.entry[0].uuid})}).catch(e=>{x(e)})},D=async e=>{if(e.preventDefault(),await U(e.target)){let o={daftar_barang:g,satuan_barang:f.value,kode_barang:B};P.map((c,s)=>{o[`harga_${c.value}`]=v[s]}),T.custom("","POST",null,{data:o}).then(()=>{p()}).catch(c=>{x(c)})}},p=()=>{T.custom(`/${g}`,"GET").then(e=>{m(o=>e.data.entry)}).catch(e=>{x(e)})},d=e=>{let o={daftar_barang:e.daftar_barang,satuan_barang:e.satuan_barang,kode_barang:e.kode_barang};P.map((c,s)=>{o[`harga_${c.value}`]=`${e[`harga_${c.value}`]}`}),T.custom(`/${e.uuid}`,"PUT",null,{data:o}).catch(c=>{x(c)}).finally(()=>p())},_=e=>{let o={daftar_barang:e.daftar_barang,satuan_barang:e.satuan_barang,kode_barang:e.kode_barang};P.map((c,s)=>{o[`harga_${c.value}`]=`${e[`harga_${s+1}`]}`}),T.custom(`/${e.uuid}`,"DELETE").catch(c=>{x(c)}).finally(()=>p())},l=(e,o,c)=>{const s=u.findIndex(i=>i.uuid==c);if(s!=-1){let i=u;i.at(s)[`harga_${o}`]=W(e),m(L=>i)}},j=(e,o)=>{const c=u.findIndex(s=>s.uuid==o);if(c!=-1){let s=u;s.at(c).kode_barang=e,m(i=>s)}};return r.useEffect(()=>{S()},[u]),r.useEffect(()=>{p()},[]),a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"mt-16 mb-5 uppercase text-gray-600 font-bold",children:"Kategori Harga"}),t?a.jsxs("form",{onSubmit:e=>D(e),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(F,{label:"Satuan Barang",optionsDataList:N,optionsLabel:"name",optionsValue:"uuid",selectValue:f,onchange:e=>{y(e)},selectName:"satuanBarang"}),a.jsx(G,{label:"Kode Barang",type:"text",onchange:e=>{w(e.target.value)},others:{value:B,name:"kodeBarang"}})]}),a.jsx("div",{className:"mt-5 flex gap-x-2",children:P.map((e,o)=>a.jsx(a.Fragment,{children:a.jsx(G,{label:e.label,type:"text",onchange:c=>{Y(c);const s=[...v];s[o]=c.target.value,k(i=>s)},others:{value:v[o],name:`hargaBarang[${o}]`}})}))}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx($,{})," Simpan"]})]}):a.jsx(a.Fragment,{}),a.jsxs("table",{className:"mt-5 table table-sm table-zebra",children:[a.jsxs("thead",{className:"py-4 text-black",children:[a.jsx("th",{children:"No"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Kode Barang"}),P.map(e=>a.jsx("th",{children:e.label})),a.jsx("th",{children:"Aksi"})]}),a.jsx("tbody",{children:u.map((e,o)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:o+1}),a.jsx("td",{children:e.satuan_barang_name}),a.jsx("td",{children:a.jsx(I,{name:"kode_barang"+o,type:"text",other:{defaultValue:e.kode_barang},onchange:c=>{j(c.target.value,e.uuid)}})}),P.map(c=>a.jsx("td",{width:150,children:a.jsx(I,{name:"harga_"+c.value,type:"text",other:{defaultValue:W(e[`harga_${c.value}`])},onchange:s=>{Y(s),l(s.target.value,c.value,e.uuid)}})})),a.jsx("td",{width:100,children:a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx($,{onClick:()=>d(e),className:"text-green-800 cursor-pointer",size:12}),a.jsx(J,{onClick:()=>_(e),className:"text-red-500 cursor-pointer",size:12})]})})]})}))})]}),a.jsx(xa,{idDaftarBarang:g,kategoriHargaBarangList:u})]})},ja=({setAddDaftarBarangEvent:g=()=>{},daftarBarangEdit:t,getData:h=()=>{}})=>{const[u,m]=r.useState(!1),[N,b]=r.useState(t!=null&&t.uuid?t.uuid:null),[f,y]=r.useState([]),[B,w]=r.useState([]),[v,k]=r.useState([]),[S,D]=r.useState(t!=null&&t.name?t.name:""),[p,d]=r.useState(t!=null&&t.kategori_barang?t.kategori_barang:""),[_,l]=r.useState(t!=null&&t.jenis_barang?t.jenis_barang:""),[j,e]=r.useState(t!=null&&t.jenis_penjualan_barang?t.jenis_penjualan_barang:""),[o,c]=r.useState((t==null?void 0:t.ppn)==0?{label:K.filter(n=>n.value==t.ppn).at(0).label,value:K.filter(n=>n.value==t.ppn).at(0).value}:{label:K[0].label,value:K[0].value}),s=async n=>{n.preventDefault(),await U(n.target)&&A.custom(`${t!=null&&t.uuid?`/${t.uuid}`:""}`,t?"PUT":"POST",null,{data:{name:S,kategori_barang:p.value,jenis_barang:_.value,jenis_penjualan_barang:j.value,ppn:o.value,status:1}}).then(H=>{t?z("Berhasil","Data berhasil diupdate"):(b(O=>H.data.uuid),z("Berhasil","Data berhasil disimpan")),m(O=>!0)}).catch(H=>{x(H),b(t.uuid),m(O=>!0)})},i=()=>{Z.custom("","GET").then(n=>{if(y(n.data.entry),n.data.entry.length>0){if(t){R({editObject:t.kategori_barang,dataList:n.data.entry,setState:d,labelKey:"name",valueKey:"uuid"});return}d({label:n.data.entry[0].name,value:n.data.entry[0].uuid})}}).catch(n=>{x(n)})},L=()=>{E.custom("","GET").then(n=>{if(w(n.data.entry),n.data.entry.length>0){if(t){R({editObject:t.jenis_barang,dataList:n.data.entry,setState:l,labelKey:"name",valueKey:"uuid"});return}l({label:n.data.entry[0].name,value:n.data.entry[0].uuid})}}).catch(n=>{x(n)})},C=()=>{aa.custom("","GET").then(n=>{if(k(n.data.entry),n.data.entry.length>0){if(t){R({editObject:t.jenis_penjualan_barang,dataList:n.data.entry,setState:e,labelKey:"name",valueKey:"uuid"});return}e({label:n.data.entry[0].name,value:n.data.entry[0].uuid})}}).catch(n=>{x(n)})};return r.useEffect(()=>{i(),L(),C()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white px-6 py-3 rounded-md shadow-2xl",children:[a.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[a.jsxs("h1",{className:"uppercase text-gray-600 font-bold",children:[t?"Edit":"Tambahkan"," Daftar Barang"]}),a.jsxs("button",{className:"btn btn-sm bg-red-900 text-white border-none",onClick:()=>g(),children:[a.jsx(M,{})," Batalkan Daftar Barang"]})]}),a.jsxs("form",{onSubmit:n=>s(n),children:[a.jsx("div",{className:"flex gap-x-2",children:a.jsx(G,{label:"Nama Daftar Barang",type:"text",onchange:n=>{D(n.target.value)},others:{value:S,name:"namaDaftarBarang",disabled:u}})}),a.jsxs("div",{className:"mt-5 flex gap-x-2",children:[a.jsx(F,{label:"Kategori Barang",optionsDataList:f,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:p,onchange:n=>{d(n)},selectName:"kategoriDaftarBarang"}),a.jsx(F,{label:"Jenis Barang",optionsDataList:B,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:_,onchange:n=>{l(n)},selectName:"JenisDaftarBarang"}),a.jsx(F,{label:"Jenis Penjualan Barang",optionsDataList:v,optionsLabel:"name",optionsValue:"uuid",disabled:u,selectValue:j,onchange:n=>{e(n)},selectName:"jenisPenjualanDaftarBarang"})]}),a.jsx("div",{className:"mt-5 flex -gap-x-2",children:a.jsx(F,{label:"PPN",optionsDataList:K,optionsLabel:"label",optionsValue:"value",disabled:u,selectValue:o,onchange:n=>{c(n)},selectName:"ppnDaftarBarang"})}),u?a.jsx(a.Fragment,{}):a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx($,{})," Simpan"]})]}),u?a.jsx(ma,{idDaftarbarang:N}):a.jsx(a.Fragment,{})]})})},ba=ea.forwardRef((g,t)=>{var h;return a.jsxs("div",{ref:t,children:[a.jsx(ha,{bulan:g.bulan,tahun:g.tahun,title:"Daftar Barang"}),a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Daftar Barang"}),a.jsx("th",{children:"Kode Daftar Barang"})]})}),a.jsx("tbody",{children:(h=g==null?void 0:g.data)==null?void 0:h.map((u,m)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsx("td",{children:m+1}),a.jsx("td",{children:u.name}),a.jsx("td",{children:u.code})]},m)}))})]})]})}),Ba=()=>{const g=ta(),{data:t}=g,[h,u]=r.useState([]),[m,N]=r.useState(!1),[b,f]=r.useState(!1),[y,B]=r.useState({name:""}),[w,v]=r.useState(!1),[k,S]=r.useState(""),D=r.useRef(),p=da.useReactToPrint({content:()=>D.current}),[d,_]=r.useState({page:1,size:10,count:118,lastPage:12}),l=(s="")=>{s==""&&S(s),N(!0),A.custom(`?search=${s}&page=${d.page}&size=${d.size}`,"GET").then(i=>{var L,C;v(s.length<1),u((L=i==null?void 0:i.data)==null?void 0:L.entry),_((C=i==null?void 0:i.data)==null?void 0:C.pagination),N(!1)}).catch(i=>{x(i)})},j=s=>{let i=h[s];B(i),f(!b)},e=async s=>{if(await ua("Hapus","Yakin ingin hapus data ini ?")){let i=h[s];A.custom(`/${i.uuid}`,"DELETE").then(()=>{z("Berhasil","Data berhasil dihapus"),l()}).catch(L=>{x(L)})}},o=({selected:s})=>{let i=d;i.page=s+1,_(i),l()},c=s=>{let i=d;i.size=s,i.page=1,_(i),l()};return r.useEffect(()=>{l()},[]),a.jsx(na,{isLoading:m,children:a.jsxs("div",{children:[a.jsx(sa,{title:"Daftar Barang"}),b?a.jsx(ja,{setAddDaftarBarangEvent:()=>f(!1),getData:l,daftarBarangEdit:y}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white py-3 px-6 mb-3 rounded-md flex justify-between shadow-2xl",children:[a.jsxs("label",{className:"input input-sm input-bordered flex items-center gap-2 bg-white",children:[a.jsx("input",{type:"text",className:"grow bg-transparent",placeholder:"Cari",value:k,onChange:s=>S(s.target.value)}),w?a.jsx(la,{onClick:()=>{l(k)},className:"cursor-pointer"}):a.jsx(M,{onClick:()=>l(""),className:"cursor-pointer"})]}),a.jsxs("div",{className:"flex gap-x-2 items-center",children:[a.jsxs("button",{className:"btn btn-sm bg-blue-900 text-white border-none",onClick:()=>{B(null),f(!b)},children:[a.jsx(ra,{})," Tambah Daftar Barang"]}),a.jsx("div",{className:"hidden",children:a.jsx(ba,{data:h,ref:D,bulan:ia(new Date().getMonth()),tahun:t.tahun})}),a.jsxs("button",{onClick:p,className:"btn btn-sm bg-red-600 hover:bg-red-600 text-white border-red-600",children:[a.jsx(ca,{})," Cetak Daftar Barang"]})]})]}),a.jsx("div",{className:"overflow-x-auto bg-white shadow-xl rounded-md h-[50vh] no-scrollbar px-6 pb-4",children:a.jsxs("table",{className:"table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Nama Daftar Barang"}),a.jsx("th",{children:"Kategori Barang"}),a.jsx("th",{children:"Jenis Barang"}),a.jsx("th",{children:"Jenis Penjualan Barang"}),a.jsx("th",{children:"PPN"}),a.jsx("th",{children:"Aksi"})]})}),a.jsx("tbody",{children:h==null?void 0:h.map((s,i)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[i+1,"."]}),a.jsx("td",{children:s.name}),a.jsx("td",{children:s.kategori_barang_name}),a.jsx("td",{children:s.jenis_barang_name}),a.jsx("td",{children:s.jenis_penjualan_barang_name}),a.jsx("td",{children:s.ppn==1?"Ya":"Tidak"}),a.jsxs("td",{className:"flex gap-x-2",children:[a.jsx(oa,{size:12,className:"text-yellow-500 cursor-pointer",onClick:()=>{j(i)}}),a.jsx(J,{size:12,className:"text-red-500 cursor-pointer",onClick:()=>{e(i)}})]})]},i)}))})]})}),a.jsx(ga,{paginateUpdatePage:o,paginate:d,setSize:c})]})]})})};export{Ba as default};
