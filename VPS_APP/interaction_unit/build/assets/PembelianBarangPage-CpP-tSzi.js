import{r as s,bl as ba,j as a,Q as Z,p as h,m as ia,aS as fa,t as w,o as q,bL as ca,a as M,d as J,M as ea,F as na,aV as Pa,bM as ma,c as ua,bo as ga,bp as ha,e as U,v as Q,bN as ra,bs as pa,bO as ja,bP as oa,bQ as _a,bR as xa,a7 as W,bx as va,f as Fa,bS as la,bz as ya,U as ka,ai as Ta,w as Ba,b as Sa,y as Na,an as Ra,bT as da,W as $a,x as Ca}from"./index-DT4LRH7x.js";import{F as H}from"./FormInputWithLabel-rB46-Yf1.js";import{i as X}from"./actionEvent.helper-Dohi3q0s.js";import{T as wa}from"./ToggleBox-BlQReAYR.js";import{P as Ea}from"./Pagination-DE9MKbxI.js";import"./react-paginate-CqpPTZEC.js";const La=({pesananPembelianBarang:r,_getDataRincianDaftarPasananPembelian:l,kategoriHargaBarangList:c,supplier:R})=>{const[D,F]=s.useState(!1),[G,S]=s.useState([]),[f,P]=s.useState(),[E,_]=s.useState(),[y,m]=s.useState(),[v,N]=s.useState(0),[d,p]=s.useState(0),[T,A]=s.useState(0),[$,K]=s.useState(0),[n,i]=s.useState(0),[x,e]=s.useState(0),[j,g]=s.useState(0),[B,t]=s.useState(0),L=()=>{m(u=>null),fa.custom(`/gudang_barang/${E.value}/${r.uuid}/pembelian`,"GET").then(u=>{S(u.data),u.data.length>0&&m(C=>({label:u.data[0].daftar_gudang_name,value:u.data[0].uuid}))}).catch(u=>w(u))},k=async u=>{u.preventDefault(),await q(u.target)&&ca.custom("","POST",null,{data:{pesanan_pembelian_barang:r.uuid,kategori_harga_barang:E.value,stok_awal_barang:y.value,jumlah:`${v}`,harga:`${d}`,harga_setelah_diskon:`${B}`,ppn:`${T}`,ppn_setelah_diskon:`${j}`,diskon_angka:`${$}`,diskon_persentase:`${n}`,total_harga:`${x}`}}).then(C=>{l()}).catch(C=>w(C))},O=u=>{try{const C=M(u.target.value)*M(d)/100;i(u.target.value),K(I=>I=h(C))}catch{K(I=>0)}},z=()=>{try{const u=M($)*100/M(d);i(C=>C=u),Y()}catch{i(C=>0)}};s.useEffect(()=>{f&&z()},[$]);const Y=()=>{const u=M(v),C=M(d)-M($);t(aa=>C);const I=f.ppn==1?C*ba/100:0;g(aa=>I);const sa=u*C+I*u;e(aa=>sa)};return s.useEffect(()=>{f&&Y()},[v]),s.useEffect(()=>{if(E){L();const u=c.filter(C=>C.uuid==E.value);u.length>0&&(N(C=>0),p(C=>u[0].harga_beli),A(C=>u[0].harga_beli*ba/100),F(C=>0),K(C=>0),i(C=>0),P(u[0]))}},[E]),s.useEffect(()=>{_({label:c[0].kode_barang,value:c[0].uuid})},[]),a.jsx(a.Fragment,{children:a.jsxs("form",{className:"gap-x-2 py-3",onSubmit:u=>k(u),children:[a.jsxs("div",{className:"flex items-end gap-x-2",children:[a.jsx(Z,{label:"Kode Barang",optionsDataList:c,optionsLabel:"kode_barang",optionsValue:"uuid",selectValue:E,onchange:u=>{_(u)},selectName:"kategoriHargaBarang"}),a.jsx(Z,{label:"Gudang Asal",optionsDataList:G,optionsLabel:"daftar_gudang_name",optionsValue:"uuid",selectValue:y,onchange:u=>{m(u)},selectName:"gudangBarang"})]}),f?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"gap-x-2 bg-gray-300 my-4 rounded-md px-2 py-3",children:[a.jsx("p",{className:"text-xl font-extrabold",children:f.daftar_barang_name}),a.jsx("p",{className:"font-bold bg-blue-800 px-2 text-white rounded-md w-max mt-2",children:f.satuan_barang_name})]}),y?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(H,{label:"Jumlah",type:"text",onchange:u=>{X(u),N(u.target.value)},others:{value:v,name:"jumlah"}}),a.jsx(H,{label:"Harga",type:"text",addClassInput:"border-none px-1",disabled:!0,others:{value:`Rp. ${h(d)}`,name:"harga"}}),a.jsx(H,{label:"PPN",type:"text",disabled:!0,addClassInput:"border-none px-1",others:{value:`Rp. ${h(T)}`,name:"ppn"}})]}),a.jsx("div",{className:"mt-5",children:a.jsx(wa,{label:"Gunakan Diskon ?",setToggleBox:F,toggleBox:D,toggleBoxList:[{label:"Tidak",value:0},{label:"Ya",value:1}]})}),D?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mt-5 flex gap-x-2",children:[a.jsx(H,{label:"Diskon Angka",type:"text",onchange:u=>{X(u),K(u.target.value)},others:{value:$,name:"diskonAngka"}}),a.jsx(H,{label:"Diskon Persentase",type:"text",onchange:u=>{X(u),O(u)},others:{value:n,name:"diskonPersentase"}})]}),a.jsxs("div",{className:"mt-5 gap-x-2 px-1",children:[a.jsx("p",{className:"font-bold mt-2",children:"Harga Setelah Diskon"}),a.jsxs("p",{className:"font-bold mt-2 text-xl",children:["Rp. ",h(B)]}),f.ppn==1?a.jsx(a.Fragment,{children:a.jsxs("p",{className:"font-bold mb-5 mt-2",children:["PPN Rp. ",h(j)]})}):a.jsx(a.Fragment,{})]})]}):a.jsx(a.Fragment,{}),a.jsxs("div",{className:"mt-5 gap-x-2 px-1",children:[a.jsx("p",{className:"font-bold text-sm",children:"Total Harga"}),a.jsxs("p",{className:"font-bold text-4xl",children:["Rp. ",h(x)]})]})]}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{}),y?a.jsx(a.Fragment,{children:a.jsxs("button",{className:"mt-3 btn w-full bg-green-800 text-white",children:[a.jsx(ia,{})," Simpan Pesanan"]})}):a.jsx(a.Fragment,{})]})})},Da=({pesananPembelianBarang:r,customer:l,fakturStatus:c,tanggalTransaksiAkhir:R,rincianPesananPembelianBarang:D,setRincianPesananPembelianBarang:F=()=>{}})=>{const[G,S]=s.useState([]),[f,P]=s.useState(!1),[E,_]=s.useState(0),y=()=>{ca.custom(`/${r.uuid}`,"GET").then(d=>{F(d.data)}).catch(d=>w(d))},m=()=>{Pa.custom("/transaksi","GET").then(d=>{S(d.data)}).catch(d=>w(d))},v=d=>{ca.custom(`/${d}`,"DELETE").then(p=>{y()}).catch(p=>w(p))},N=()=>{ma.custom("/pesanan_by_tanggal","POST",null,{data:{faktur_pembelian_barang:c,tanggal:R}}).then(d=>{F(T=>d.data);const p=d.data.reduce((T,A)=>T+parseFloat(A.piutang),0);_(T=>p)})};return s.useEffect(()=>{m(),c?N():y()},[c,R,f]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"grid grid-cols-12 gap-x-2",children:[a.jsx("div",{className:`${c?"hidden":"col-span-4"}`,children:G.length>0?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white rounded-md my-4 py-6 px-6 shadow-2xl",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Detail Barang Pesanan"}),a.jsx(La,{_getDataRincianDaftarPasananPembelian:y,_hapusPesanan:()=>{},customer:l,kategoriHargaBarangList:G,pesananPembelianBarang:r})]})}):a.jsx(a.Fragment,{})}),a.jsx("div",{className:`${c?"col-span-12":"col-span-8"}`,children:a.jsxs("div",{className:`bg-white my-4 rounded-md no-scrollbar relative ${c?"h-max max-h-[60vh]":"h-[70vh]"} overflow-y-scroll`,children:[a.jsxs("div",{className:"sticky top-0",children:[a.jsxs("div",{className:"bg-white py-4 px-6 rounded-md",children:[a.jsx("p",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Total Pesanan"}),a.jsxs("p",{className:"font-bold text-4xl",children:["Rp. ",h(D.reduce((d,p)=>d+parseFloat(p.total_harga),0))]}),c?a.jsx(a.Fragment,{children:E>0?a.jsxs("div",{className:"flex items-center gap-x-2 w-max my-2 px-2 py-1 rounded-md border-2 border-red-800",children:[a.jsx(J,{className:"text-red-800",size:13}),a.jsx("p",{className:"mb-0 text-red-800 font-bold",children:"Belum Lunas"})]}):a.jsxs("div",{className:"flex items-center gap-x-2 w-max my-2 px-2 py-1 rounded-md border-2 border-green-800",children:[a.jsx(ea,{className:"text-green-800",size:13}),a.jsx("p",{className:"mb-0 text-green-800 font-bold",children:"Lunas"})]})}):a.jsx(a.Fragment,{}),c?a.jsx(a.Fragment,{children:f?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn bg-gray-100 text-red-500 btn-sm mt-4 border-red-500",onClick:()=>{P(d=>d=!d)},children:"Tutup Daftar Pesanan"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn bg-gray-100 btn-sm mt-4 border-gray-500",onClick:()=>{P(d=>d=!d)},children:"Lihat Daftar Pesanan"})})}):a.jsx(a.Fragment,{})]}),c&&!f?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"grid grid-cols-12 text-sm gap-x-2 py-2 font-bold border-t-2 bg-gray-100 px-6",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("p",{className:"text-gray-500",children:"No."})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Kode Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Nama Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Satuan Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Harga Barang"})})]})})]}),c&&!f?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:D.map((d,p)=>a.jsxs("div",{className:"py-3  border-t-2",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 px-6 items-start font-bold",children:[a.jsx("div",{className:"col-span-1",children:a.jsxs("p",{className:"text-sm",children:[p+1,"."]})}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-sm",children:d.kategori_harga_barang_kode_barang}),a.jsx("p",{className:"text-xs my-1 font-normal",children:d.daftar_gudang_name})]}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:d.daftar_barang_name})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:d.satuan_barang_name})}),a.jsxs("div",{className:"col-span-3",children:[a.jsxs("p",{className:"text-sm",children:["Rp. ",h(d.harga)]}),a.jsxs("p",{className:"text-xs font-normal",children:["PPN : Rp. ",h(d.ppn)]})]})]}),a.jsxs("div",{className:"grid grid-cols-12 text-xs gap-x-2 px-6 text-gray-500 font-bold",children:[a.jsx("div",{className:"col-span-1"}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("p",{children:["Jumlah : ",h(d.jumlah)]}),c?a.jsx(a.Fragment,{children:a.jsxs("p",{children:["Retur : ",h(d.retur)]})}):a.jsx(a.Fragment,{})]}),a.jsx("div",{className:"col-span-3",children:d.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsx("p",{children:"Diskon"}),a.jsx("p",{children:"Harga Diskon"}),a.jsx("p",{children:"PPN Diskon"})]}):a.jsx(a.Fragment,{})}),a.jsx("div",{className:"col-span-3",children:d.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["Rp. ",h(d.diskon_angka)," (",d.diskon_persentase," % )"]}),a.jsxs("p",{children:["Rp. ",h(d.harga_setelah_diskon)]}),a.jsxs("p",{children:["Rp. ",h(d.ppn_setelah_diskon)]})]}):a.jsx(a.Fragment,{})}),a.jsxs("div",{className:"col-span-3",children:["Total Harga ",a.jsxs("p",{children:["Rp. ",h(d.total_harga)]}),c?a.jsxs(a.Fragment,{children:["Status ",a.jsx("p",{children:d.piutang!="0"?`Belum Lunas ( Rp. ${h(d.piutang)} )`:"Sudah Lunas"})]}):a.jsx(a.Fragment,{})]})]}),c?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsx("div",{className:"grid grid-cols-12 gap-x-2 px-6",children:a.jsx("div",{className:"col-span-1 col-start-2 mb-3",children:a.jsxs("button",{className:"btn w-max btn-sm bg-red-700 text-white",onClick:T=>{v(d.uuid)},children:[a.jsx(na,{})," Hapus"]})})})})]}))})]})})]})})},Aa=({riwayatPelunasanPembelianBarang:r,edited:l,_getDaftarRiwayatTransaksi:c=()=>{}})=>{const[R,D]=s.useState(r.nomor_transaksi!="EMPTY"?r.nomor_transaksi:""),[F,G]=s.useState(r.bukti_transaksi!="EMPTY"?r.bukti_transaksi:""),[S,f]=s.useState(r.keterangan!="EMPTY"?r.keterangan:"Tidak Ada"),[P,E]=s.useState(r.total),[_,y]=s.useState(r.total_denda),[m,v]=s.useState([]),[N,d]=s.useState(!1),[p,T]=s.useState(l),A=()=>{ma.custom(`/pesanan/${r.uuid}`).then(e=>{v(e.data)}).catch(e=>w(e))},$=(e,j)=>{let g=m,B=0;g=g.map(t=>(t.uuid==j&&(t.nilai_pelunasan=e),B+=M(t.nilai_pelunasan),t)),E(t=>B),v(t=>g)},K=(e,j)=>{let g=m,B=0;g=g.map(t=>(t.uuid==j&&(t.nilai_pelunasan_denda=e),B+=M(t.nilai_pelunasan_denda),t)),y(t=>B),v(t=>g)},n=async()=>{for(let e=0;e<m.length;e++)await ma.custom(`${m[e].rincian_pelunasan_pembelian_barang?`/${m[e].rincian_pelunasan_pembelian_barang}`:""}`,m[e].rincian_pelunasan_pembelian_barang?"PUT":"POST",null,{data:{pelunasan_pembelian_barang:r.uuid,rincian_pesanan_pembelian_barang:m[e].uuid,sudah_dibayar:m[e].sudah_dibayar,piutang:m[e].piutang,nilai_pelunasan:`${m[e].nilai_pelunasan}`,nilai_pelunasan_denda:`${m[e].nilai_pelunasan_denda}`}}).then(()=>{Q("Berhasil","Data Berhasil Disimpan")}).catch(j=>w(j));A()},i=()=>{ra.custom("/"+r.uuid,"DELETE").then(()=>{c()}).catch(e=>w(e))},x=async()=>{await pa(),await q()&&ra.custom("/"+r.uuid,"PUT",null,{data:{nomor_pelunasan_pembelian_barang:R,bukti_transaksi:F,keterangan:S,faktur_pembelian_barang:r.faktur_pembelian_barang,tanggal:r.tanggal,kode_akun_perkiraan:r.kode_akun_perkiraan}}).then(()=>{Q("Berhasil","Data Berhasil Disimpan")}).catch(e=>w(e))};return s.useEffect(()=>{N&&A()},[N]),a.jsxs("div",{className:"border-b-2 py-2",children:[a.jsx("div",{className:"cursor-pointer",onClick:()=>{T(e=>e=!e)},children:a.jsxs("div",{className:"flex items-center justify-between gap-x-2 px-4",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsx("p",{className:"text-sm pr-2 font-medium",children:ua(r.tanggal.split("T")[1])}),a.jsx("p",{className:"text-sm pr-2 font-medium px-3 border-l-2 border-black",children:"Pelunasan Pembelian Barang"})]}),p?a.jsx(ga,{size:15}):a.jsx(ha,{size:15})]})}),p?a.jsx(a.Fragment,{children:a.jsx("div",{className:"ml-4 py-4 px-4",children:p?a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"text-left text-sm",children:[a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Nomor Pelunasan Pembelian Barang"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(U,{addClass:"px-0",name:"nomor_pelunasan_pembelian_barang",value:R,onchange:e=>D(e.target.value)}):r.nomor_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Bukti Transaksi"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(U,{addClass:"px-0",name:"bukti_transaksi",value:F,onchange:e=>G(e.target.value)}):r.bukti_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-5":""}`,children:"Kode Akun"}),a.jsx("td",{className:`px-5 ${l?"pb-5":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-5":""}`,children:[r.kode_akun_perkiraan_code," - ",r.kode_akun_perkiraan_name]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Total Pelunasan"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-3":""}`,children:["Rp. ",h(P)]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Total Pelunasan Denda"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-3":""}`,children:["Rp. ",h(_)]})]})]}),a.jsx("p",{className:`text-sm mt-3 ${l?"mt-5":""}`,children:"Keterangan"}),a.jsx("p",{className:"text-sm mb-3",children:l?a.jsx(U,{addClass:"mt-5",name:"keterangan",value:S,onchange:e=>f(e.target.value)}):r.keterangan}),a.jsxs("div",{className:"my-2 flex justify-between",children:[a.jsx("div",{children:l?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"mr-2 btn btn-sm bg-green-900 text-white",onClick:()=>x(),children:[a.jsx(ea,{size:12}),"Simpan"]}),a.jsxs("button",{className:"mr-2 btn btn-sm bg-red-500 text-white",onClick:()=>i(),children:[a.jsx(na,{size:12}),"Hapus"]})]}):a.jsx(a.Fragment,{})}),N?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm border-red-500 text-red-500",onClick:()=>d(e=>e=!e),children:"Tutup Daftar Pelunasan"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm bg-white border-gray-400",onClick:()=>d(e=>e=!e),children:"Lihat Daftar Pelunasan"})})]}),N?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Pelunasan Sudah Dibayar"}),a.jsx("th",{children:"Piutang"}),a.jsx("th",{width:200,children:"Nilai Pelunasan"}),a.jsx("th",{width:200,children:"Nilai Pelunasan Denda"})]}),a.jsx("tbody",{children:m.map((e,j)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[j+1,"."]}),a.jsx("td",{children:e.kategori_harga_barang_kode_barang}),a.jsx("td",{children:e.daftar_barang_name}),a.jsx("td",{children:e.satuan_barang_name}),a.jsx("td",{children:e.daftar_gudang_name}),a.jsxs("td",{children:["Rp. ",h(e.sudah_dibayar)]}),a.jsxs("td",{children:["Rp. ",h(e.piutang)]}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(U,{name:"nilai_pelunasan",type:"text",other:{defaultValue:0},onchange:g=>{X(g,e.piutang),$(g.target.value,e.uuid)},value:h(e.nilai_pelunasan)})}):a.jsxs(a.Fragment,{children:["Rp. ",h(e.nilai_pelunasan)]})}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(U,{name:"nilai_pelunasan_denda",type:"text",other:{defaultValue:0},onchange:g=>{K(g.target.value,e.uuid)},value:h(e.nilai_pelunasan_denda)})}):a.jsxs(a.Fragment,{children:["Rp. ",h(e.nilai_pelunasan_denda)]})})]})}))})]})}),l?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn btn-sm bg-green-900 text-white",onClick:()=>{n()},children:"Simpan"})})}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})})}):a.jsx(a.Fragment,{})]})},za=({riwayatReturPembelianBarang:r,edited:l,_getDaftarRiwayatTransaksi:c=()=>{}})=>{const[R,D]=s.useState(r.nomor_transaksi!="EMPTY"?r.nomor_transaksi:""),[F,G]=s.useState(r.bukti_transaksi!="EMPTY"?r.bukti_transaksi:""),[S,f]=s.useState(r.keterangan!="EMPTY"?r.keterangan:"Tidak Ada"),[P,E]=s.useState(r.total),[_,y]=s.useState(!1),[m,v]=s.useState([]),[N,d]=s.useState(!1),[p,T]=s.useState(l),A=()=>{ja.custom(`/pesanan/${r.uuid}`).then(e=>{v(e.data)}).catch(e=>w(e))},$=(e,j)=>{let g=m,B=0;g=g.map(t=>(t.uuid==j&&(t.nilai_retur=e),B+=M(t.nilai_retur),t)),E(t=>B),v(t=>g)},K=(e,j)=>{let g=m;g=g.map(B=>(B.uuid==j&&(B.retur=e),B)),v(B=>g)},n=async()=>{for(let e=0;e<m.length;e++)await ja.custom(`${m[e].rincian_retur_pembelian_barang?`/${m[e].rincian_retur_pembelian_barang}`:""}`,m[e].rincian_retur_pembelian_barang?"PUT":"POST",null,{data:{retur_pembelian_barang:r.uuid,rincian_pesanan_pembelian_barang:m[e].uuid,jumlah:`${m[e].jumlah_fix}`,denda_sudah_dibayar:`${m[e].denda_sudah_dibayar}`,sudah_dibayar:`${m[e].sudah_dibayar_fix}`,retur:`${m[e].retur}`,nilai_retur:`${m[e].nilai_retur}`,retur_sebelum:`${m[e].retur_sebelum}`,nilai_retur_sebelum:`${m[e].nilai_retur_sebelum}`}}).then(()=>{Q("Berhasil","Data Berhasil Disimpan")});A()},i=()=>{oa.custom("/"+r.uuid,"DELETE").then(()=>{c()}).catch(e=>w(e))},x=async()=>{await pa(),await q()&&oa.custom("/"+r.uuid,"PUT",null,{data:{nomor_retur_pembelian_barang:R,bukti_transaksi:F,keterangan:S,faktur_pembelian_barang:r.faktur_pembelian_barang,tanggal:r.tanggal,kode_akun_perkiraan:r.kode_akun_perkiraan}}).then(()=>{Q("Berhasil","Data Berhasil Disimpan")}).catch(e=>w(e))};return s.useEffect(()=>{N&&!_&&(A(),y(e=>!0))},[N]),a.jsxs("div",{className:"border-b-2 py-2",children:[a.jsx("div",{className:"cursor-pointer",onClick:()=>{T(e=>e=!e)},children:a.jsxs("div",{className:"flex items-center justify-between gap-x-2 px-4",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsx("p",{className:"text-sm pr-2 font-medium",children:ua(r.tanggal.split("T")[1])}),a.jsx("p",{className:"text-sm pr-2 font-medium px-4 border-l-2 border-black",children:"Retur Pembelian Barang"})]}),p?a.jsx(ga,{size:15}):a.jsx(ha,{size:15})]})}),p?a.jsx(a.Fragment,{children:a.jsx("div",{className:"ml-4 py-4 px-4",children:p?a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"text-left text-sm",children:[a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Nomor Retur Pembelian Barang"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(U,{addClass:"px-0",name:"nomor_retur_pembelian_barang",value:R,onchange:e=>D(e.target.value)}):r.nomor_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Bukti Transaksi"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(U,{addClass:"px-0",name:"bukti_transaksi",value:F,onchange:e=>G(e.target.value)}):r.bukti_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-5":""}`,children:"Kode Akun"}),a.jsx("td",{className:`px-5 ${l?"pb-5":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-5":""}`,children:[r.kode_akun_perkiraan_code," - ",r.kode_akun_perkiraan_name]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Total Retur"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-3":""}`,children:["Rp. ",h(P)]})]})]}),a.jsx("p",{className:`text-sm mt-3 ${l?"mt-5":""}`,children:"Keterangan"}),a.jsx("p",{className:"text-sm mb-3",children:l?a.jsx(U,{addClass:"mt-5",name:"keterangan",value:S,onchange:e=>f(e.target.value)}):r.keterangan}),a.jsxs("div",{className:"my-2 flex justify-between",children:[a.jsx("div",{children:l?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"mr-2 btn btn-sm bg-green-900 text-white",onClick:()=>x(),children:[a.jsx(ea,{size:12}),"Simpan"]}),a.jsxs("button",{className:"mr-2 btn btn-sm bg-red-500 text-white",onClick:()=>i(),children:[a.jsx(na,{size:12}),"Hapus"]})]}):a.jsx(a.Fragment,{})}),N?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm border-red-500 text-red-500",onClick:()=>d(e=>e=!e),children:"Tutup Daftar Retur"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm bg-white border-gray-400",onClick:()=>d(e=>e=!e),children:"Lihat Daftar Retur"})})]}),N?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Pelunasan Sudah Dibayar"}),a.jsx("th",{width:150,children:"Retur Sebelumnya"}),a.jsx("th",{width:150,children:"Retur"}),a.jsx("th",{width:150,children:"Nilai Retur"})]}),a.jsx("tbody",{children:m.map((e,j)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[j+1,"."]}),a.jsx("td",{children:e.kategori_harga_barang_kode_barang}),a.jsx("td",{children:e.daftar_barang_name}),a.jsx("td",{children:e.satuan_barang_name}),a.jsx("td",{children:e.daftar_gudang_name}),a.jsxs("td",{children:["Rp. ",h(e.sudah_dibayar_fix)]}),a.jsxs("td",{children:[h(e.retur_sebelum)," ",e.satuan_barang_name]}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(U,{name:"retur",type:"text",other:{defaultValue:0},onchange:g=>{X(g,e.jumlah_fix),K(g.target.value,e.uuid)},value:h(e.retur)})}):a.jsxs(a.Fragment,{children:[h(e.retur)," ",e.satuan_barang_name]})}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(U,{name:"retur",type:"text",other:{defaultValue:0},onchange:g=>{$(g.target.value,e.uuid)},value:h(e.nilai_retur)})}):a.jsxs(a.Fragment,{children:["Rp. ",h(e.nilai_retur)]})})]})}))})]})}),l?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn btn-sm bg-green-900 text-white",onClick:()=>{n()},children:"Simpan"})})}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})})}):a.jsx(a.Fragment,{})]})},Ka=({riwayatPengembalianDendaPembelianBarang:r,edited:l,_getDaftarRiwayatTransaksi:c=()=>{}})=>{const[R,D]=s.useState(r.nomor_transaksi!="EMPTY"?r.nomor_transaksi:""),[F,G]=s.useState(r.bukti_transaksi!="EMPTY"?r.bukti_transaksi:""),[S,f]=s.useState(r.keterangan!="EMPTY"?r.keterangan:"Tidak Ada"),[P,E]=s.useState(r.total),[_,y]=s.useState([]),[m,v]=s.useState(!1),[N,d]=s.useState(l),p=()=>{_a.custom(`/pesanan/${r.uuid}`).then(n=>{y(n.data)}).catch(n=>w(n))},T=async()=>{for(let n=0;n<_.length;n++)await _a.custom(`${_[n].rincian_pengembalian_denda_pembelian_barang?`/${_[n].rincian_pengembalian_denda_pembelian_barang}`:""}`,_[n].rincian_pengembalian_denda_pembelian_barang?"PUT":"POST",null,{data:{pengembalian_denda_pembelian_barang:r.uuid,rincian_pesanan_pembelian_barang:_[n].uuid,denda_yang_dikembalikan:`${_[n].denda_yang_dikembalikan}`}}).then(()=>{Q("Berhasil","Data Berhasil Disimpan")});p()},A=()=>{xa.custom("/"+r.uuid,"DELETE").then(()=>{c()}).catch(n=>w(n))},$=(n,i)=>{let x=_,e=0;x=x.map(j=>(j.uuid==i&&(j.denda_yang_dikembalikan=n),e+=M(j.denda_yang_dikembalikan),j)),E(j=>e),y(j=>x)},K=async()=>{await pa(),await q()&&xa.custom("/"+r.uuid,"PUT",null,{data:{nomor_pengembalian_denda_pembelian_barang:R,bukti_transaksi:F,keterangan:S,faktur_pembelian_barang:r.faktur_pembelian_barang,tanggal:r.tanggal,kode_akun_perkiraan:r.kode_akun_perkiraan}}).then(()=>{Q("Berhasil","Data Berhasil Disimpan")}).catch(n=>w(n))};return s.useEffect(()=>{m&&p()},[m]),a.jsxs("div",{className:"border-b-2 py-2",children:[a.jsx("div",{className:"cursor-pointer",onClick:()=>{d(n=>n=!n)},children:a.jsxs("div",{className:"flex items-center justify-between gap-x-2 px-4",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsx("p",{className:"text-sm pr-2 font-medium",children:ua(r.tanggal.split("T")[1])}),a.jsx("p",{className:"text-sm pr-2 font-medium px-3 border-l-2 border-black",children:"Pengembalian Denda Pembelian Barang"})]}),N?a.jsx(ga,{size:15}):a.jsx(ha,{size:15})]})}),N?a.jsx(a.Fragment,{children:a.jsx("div",{className:"ml-4 py-4 px-4",children:N?a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"text-left text-sm",children:[a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Nomor Pengembalian Denda Pembelian Barang"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(U,{addClass:"px-0",name:"nomor_pengembalian_denda_pembelian_barang",value:R,onchange:n=>D(n.target.value)}):r.nomor_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Bukti Transaksi"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(U,{addClass:"px-0",name:"bukti_transaksi",value:F,onchange:n=>G(n.target.value)}):r.bukti_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-5":""}`,children:"Kode Akun"}),a.jsx("td",{className:`px-5 ${l?"pb-5":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-5":""}`,children:[r.kode_akun_perkiraan_code," - ",r.kode_akun_perkiraan_name]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Total PengembalianDenda"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-3":""}`,children:["Rp. ",h(P)]})]})]}),a.jsx("p",{className:`text-sm mt-3 ${l?"mt-5":""}`,children:"Keterangan"}),a.jsx("p",{className:"text-sm mb-3",children:l?a.jsx(U,{addClass:"mt-5",name:"keterangan",value:S,onchange:n=>f(n.target.value)}):r.keterangan}),a.jsxs("div",{className:"my-2 flex justify-between",children:[a.jsx("div",{children:l?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"mr-2 btn btn-sm bg-green-900 text-white",onClick:()=>K(),children:[a.jsx(ea,{size:12}),"Simpan"]}),a.jsxs("button",{className:"mr-2 btn btn-sm bg-red-500 text-white",onClick:()=>A(),children:[a.jsx(na,{size:12}),"Hapus"]})]}):a.jsx(a.Fragment,{})}),m?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm border-red-500 text-red-500",onClick:()=>v(n=>n=!n),children:"Tutup Daftar PengembalianDenda"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm bg-white border-gray-400",onClick:()=>v(n=>n=!n),children:"Lihat Daftar PengembalianDenda"})})]}),m?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{width:200,children:"Denda Yang Dikembalikan"})]}),a.jsx("tbody",{children:_.map((n,i)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[i+1,"."]}),a.jsx("td",{children:n.kategori_harga_barang_kode_barang}),a.jsx("td",{children:n.daftar_barang_name}),a.jsx("td",{children:n.satuan_barang_name}),a.jsx("td",{children:n.daftar_gudang_name}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(U,{name:"denda_yang_dikembalikan",type:"text",other:{defaultValue:0},onchange:x=>{X(x),$(x.target.value,n.uuid)},value:h(n.denda_yang_dikembalikan)})}):a.jsxs(a.Fragment,{children:["Rp. ",h(n.denda_yang_dikembalikan)]})})]})}))})]})}),l?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn btn-sm bg-green-900 text-white",onClick:()=>{T()},children:"Simpan"})})}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})})}):a.jsx(a.Fragment,{})]})},Ga=({fakturPembelianBarang:r,setFakturCancel:l=()=>{},setTanggalTransaksiAkhir:c=()=>{}})=>{const[R,D]=s.useState(W()),[F,G]=s.useState({label:"Pelunasan",value:"Pelunasan"}),S=["Pelunasan","Retur","Pengembalian_Denda"],[f,P]=s.useState(),[E,_]=s.useState([]),[y,m]=s.useState([]),[v,N]=s.useState(!0),[d,p]=s.useState([]),T=()=>{N(n=>!1),l(n=>!0),p(n=>S.filter(i=>i!="Pengembalian_Denda").map(i=>({label:i.replace("_"," "),value:i}))),r&&la.custom("/riwayat_transaksi/"+r.uuid).then(n=>{console.log(n.data),n.data.length>0&&(l(i=>!1),c(i=>n.data[0].tanggal),n.data.filter(i=>i.type=="retur_pembelian_barang").length>0&&p(i=>S.map(x=>({label:x.replace("_"," "),value:x})))),m(i=>ya(n.data))})},A=async n=>{if(n.preventDefault(),await q(n.target)){let i=ra;F.value=="Retur"&&(i=oa),F.value=="Pengembalian_Denda"&&(i=xa);const x={faktur_pembelian_barang:r.uuid,tanggal:R,bukti_transaksi:"EMPTY",kode_akun_perkiraan:f.value,keterangan:"EMPTY"};x[`nomor_${F.value.toLowerCase()}_pembelian_barang`]="EMPTY",i.custom("","POST",null,{data:x}).then(()=>{Q("Berhasil","Data Berhasil Disimpan"),T(),D(W())}).catch(e=>w(e))}},$=()=>{ka.custom("/kas_bank","GET").then(n=>{_(i=>n.data),n.data.length>0&&P({label:`${n.data[0].code} - ${n.data[0].name}`,value:n.data[0].uuid})})},K=()=>{ka.custom("/hutang_usaha","GET").then(n=>{const i=[n.data];_(x=>i),i.length>0&&P({label:`${i[0].code} - ${i[0].name}`,value:i[0].uuid})})};return s.useEffect(()=>{N(n=>!0)},[y]),s.useEffect(()=>{if(_(n=>[]),P(n=>null),$(),F.value=="Retur"&&(K(),y.length>0)){const n=y.filter(i=>i.data.filter(x=>x.type=="pelunasan_pembelian_barang").length>0);if(n.length>0){const i=n[0].data.filter(x=>x.type=="pelunasan_pembelian_barang");i.length>0&&ra.custom(`/cek_denda_pelunasan_pembelian/${i[0].uuid}`,"GET").then(x=>{x.data==0&&$()}).catch(x=>w(x))}}},[F]),s.useEffect(()=>{T(),$()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white rounded-md mt-4 py-6 px-6 shadow-2xl",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Riwayat Transaksi Pembelian Barang"}),a.jsxs("form",{className:"mb-5 border-[3px] rounded-md py-2 px-3",onSubmit:n=>A(n),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(H,{label:"Tanggal",type:"datetime-local",onchange:n=>{D(n.target.value)},others:{value:R,name:"tanggal"}}),a.jsx(Z,{label:"Tipe Transaksi",addClass:"z-50",optionsDataList:d,onchange:n=>{G(n)},optionsLabel:"label",optionsValue:"value",selectName:"tipe_transaksi",selectValue:F}),a.jsx(Z,{label:"Kode Akun",optionsDataList:E,optionsLabel:["code","name"],optionsValue:"uuid",addClass:"z-50",optionsLabelIsArray:!0,optionsDelimiter:"-",selectValue:f,onchange:n=>{P(n)},selectName:"kodeAkun"})]}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(ia,{})," Simpan"]})]}),a.jsx("div",{className:"flex flex-col max-h-[60vh] overflow-scroll no-scrollbar relative",children:v?a.jsx(a.Fragment,{children:y.map((n,i)=>a.jsxs("div",{className:"mb-5",children:[a.jsx("p",{className:"font-bold mb-3 sticky top-0 bg-gray-300 p-2 z-20",children:va("/",Fa(n.parent,!1))}),a.jsx("div",{className:"flex flex-col",children:n.data.map((x,e)=>{var j,g,B;return a.jsxs(a.Fragment,{children:[x.type=="pelunasan_pembelian_barang"?a.jsx(a.Fragment,{children:a.jsx(Aa,{riwayatPelunasanPembelianBarang:x,edited:((j=JSON.parse(x.perintah_stok_opname_nomor_surat_perintah))==null?void 0:j.hasil_stok_opname_count)>0?!1:i==0&&e==0,_getDaftarRiwayatTransaksi:T})}):a.jsx(a.Fragment,{}),x.type=="retur_pembelian_barang"?a.jsx(a.Fragment,{children:a.jsx(za,{riwayatReturPembelianBarang:x,edited:((g=JSON.parse(x.perintah_stok_opname_nomor_surat_perintah))==null?void 0:g.hasil_stok_opname_count)>0?!1:i==0&&e==0,_getDaftarRiwayatTransaksi:T})}):a.jsx(a.Fragment,{}),x.type=="pengembalian_denda_pembelian_barang"?a.jsx(a.Fragment,{children:a.jsx(Ka,{riwayatPengembalianDendaPembelianBarang:x,edited:((B=JSON.parse(x.perintah_stok_opname_nomor_surat_perintah))==null?void 0:B.hasil_stok_opname_count)>0?!1:i==0&&e==0,_getDaftarRiwayatTransaksi:T})}):a.jsx(a.Fragment,{})]})})})]}))}):a.jsx(a.Fragment,{children:a.jsx("p",{className:"font-bold",children:"Riwayat Transaksi Belum Ada."})})})]})})},Ha=({pesananPembelianBarang:r,setFakturStatus:l=()=>{},fakturStatus:c,ppnStatus:R,setTanggalTransaksiAkhir:D=()=>{}})=>{const[F,G]=s.useState(),[S,f]=s.useState(!0),[P,E]=s.useState([]),[_,y]=s.useState(W()),[m,v]=s.useState(),[N,d]=s.useState(),[p,T]=s.useState(),[A,$]=s.useState(),[K,n]=s.useState(),[i,x]=s.useState(""),e=()=>{Ta.custom("","GET").then(t=>{var L;E(k=>{var O;return(O=t.data)==null?void 0:O.entry}),((L=t.data)==null?void 0:L.entry.length)>0&&T(k=>{var O,z;return{label:(O=t.data)==null?void 0:O.entry[0].name,value:(z=t.data)==null?void 0:z.entry[0].uuid}})})},j=async t=>{t.preventDefault(),await q(t.target)&&la.custom("","POST",null,{data:{pesanan_pembelian_barang:r.uuid,tanggal:_,nomor_faktur_pembelian_barang:m,bukti_transaksi:N,tipe_pembayaran:p.value,syarat_pembayaran:A,keterangan:K,nomor_faktur_pajak_pembelian_barang:i||"EMPTY"}}).then(L=>{B()}).catch(L=>w(L))},g=()=>{la.custom(`/${c}`,"DELETE").then(()=>{l(t=>null)}).catch(t=>w(t))},B=()=>{la.custom(`/pesanan_pembelian_barang/${r.uuid}`,"GET").then(t=>{G(L=>t==null?void 0:t.data),v(L=>{var k;return(k=t==null?void 0:t.data)==null?void 0:k.nomor_faktur_pembelian_barang}),d(L=>{var k;return(k=t==null?void 0:t.data)==null?void 0:k.bukti_transaksi}),y(L=>{var k;return(k=t==null?void 0:t.data)==null?void 0:k.tanggal}),T(L=>{var k;return(k=t==null?void 0:t.data)==null?void 0:k.tipe_pembayaran_name}),$(L=>{var k;return(k=t==null?void 0:t.data)==null?void 0:k.syarat_pembayaran}),n(L=>{var k;return(k=t==null?void 0:t.data)==null?void 0:k.keterangan}),l(L=>{var k;return(k=t==null?void 0:t.data)==null?void 0:k.uuid}),x(L=>{var k,O;return((k=t==null?void 0:t.data)==null?void 0:k.nomor_faktur_pajak_pembelian_barang)!="EMPTY"?(O=t.data)==null?void 0:O.nomor_faktur_pajak_pembelian_barang:""})}).catch(t=>{l(L=>null)})};return s.useEffect(()=>{c!=null?B():e()},[c]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white mt-4 rounded-md py-6 px-6 shadow-2xl",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Faktur Pembelian Barang"}),a.jsxs("form",{onSubmit:t=>j(t),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(H,{label:"Tanggal Faktur Pembelian Barang",type:"datetime-local",onchange:t=>{y(t.target.value)},disabled:c,addClassInput:c?"border-none px-1":"",others:{value:_,name:"tanggalFakturPembelianBarang",disabled:c}}),a.jsx(H,{label:"Nomor Faktur Pembelian Barang",type:"text",onchange:t=>{v(t.target.value)},disabled:c,addClassInput:c?"border-none px-1":"",others:{value:m,name:"nomorFakturPembelianBarang",disabled:c}}),a.jsx(H,{label:"Bukti Transaksi",type:"text",disabled:c,addClassInput:c?"border-none px-1":"",onchange:t=>{d(t.target.value)},others:{value:N,name:"buktiTransaksi",disabled:c}}),c?a.jsx(a.Fragment,{children:a.jsx(H,{label:"Tipe Pembayaran",type:"text",disabled:c,addClassInput:c?"border-none px-1":"",others:{value:p,name:"tipePembayaran",disabled:c}})}):a.jsx(a.Fragment,{children:a.jsx(Z,{label:"Tipe Pembayaran",optionsDataList:P,optionsLabel:"name",optionsValue:"uuid",selectValue:p,onchange:t=>{T(t)},selectName:"tipePembayaran"})}),a.jsx(H,{label:"Syarat Pembayaran",type:"text",disabled:c,addClassInput:c?"border-none px-1":"",onchange:t=>{$(t.target.value)},others:{value:A,name:"syaratPembayaran",disabled:c}})]}),a.jsx("div",{className:"flex gap-x-2",children:a.jsx(H,{label:"Keterangan",type:"text",disabled:c,addClassInput:c?"border-none px-1":"",onchange:t=>{n(t.target.value)},others:{value:K,name:"keteranganFakturPembelianBarang",disabled:c}})}),R?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex gap-x-2",children:a.jsx(H,{label:"Nomor Faktur Pajak",type:"text",disabled:c,addClassInput:c?"border-none px-1":"",onchange:t=>{x(t.target.value)},others:{value:i,name:"nomorFakturPajakFakturPembelianBarang",disabled:c}})})}):a.jsx(a.Fragment,{}),c?a.jsx(a.Fragment,{children:S?a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-red-800 mt-4 text-white",type:"button",onClick:()=>g(),children:[a.jsx(J,{})," Batalkan Faktur"]})}):a.jsx(a.Fragment,{})}):a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(ia,{})," Simpan"]})})]})]}),c?a.jsx(a.Fragment,{children:a.jsx(Ga,{fakturPembelianBarang:F,setFakturCancel:f,setTanggalTransaksiAkhir:D})}):a.jsx(a.Fragment,{})]})},Ua=({setAddPembelianBarang:r=()=>{}})=>{Ba();const[l,c]=s.useState(W()),[R,D]=s.useState(!1),[F,G]=s.useState(!0),[S,f]=s.useState(!1),[P,E]=s.useState(!1),[_,y]=s.useState([]),[m,v]=s.useState(!0),[N,d]=s.useState([]),[p,T]=s.useState([]),[A,$]=s.useState(""),[K,n]=s.useState(W()),[i,x]=s.useState(),[e,j]=s.useState(!1),[g,B]=s.useState(""),[t,L]=s.useState({page:1,size:2,count:118,lastPage:12}),k=({selected:o})=>{let b=t;b.page=o+1,L(b),u()},O=o=>{let b=t;b.size=o,b.page=1,L(b),u()},[z,Y]=s.useState(),u=(o="")=>{o==""&&B(o),Ra.custom(`?search=${o}&page=${t.page}&size=${t.size}`,"GET").then(b=>{var V,ta;j(o.length<1),T((V=b==null?void 0:b.data)==null?void 0:V.entry),L((ta=b==null?void 0:b.data)==null?void 0:ta.pagination)}).catch(b=>{w(b)})},C=()=>{da.custom(`/${z.uuid}`,"DELETE").then(o=>{Y(null),aa()}).catch(o=>w(o))},I=async o=>{o.preventDefault(),await q(o.target)&&da.custom(m?`/${m.value}`:"",m?"PUT":"POST",null,{data:{nomor_pesanan_pembelian_barang:A,tanggal_pesanan_pembelian_barang:K,supplier:i.uuid}}).then(b=>{if(m){const V=_.filter(ta=>ta.uuid==m.value);Y(V[0])}else Y(b.data);E(V=>!0)}).catch(b=>{w(b),m&&(sa(),E(V=>!0),Y(_.filter(V=>V.uuid==m.value)[0]))})},sa=()=>{x(b=>null),n(b=>W()),$(b=>null);const o=_.filter(b=>b.uuid==m.value);if(o.length>0){const b=p.filter(V=>V.uuid==o[0].supplier);b.length>0&&(x(V=>b[0]),n(o[0].tanggal_pesanan_pembelian_barang),$(o[0].nomor_pesanan_pembelian_barang))}};s.useEffect(()=>{m&&sa()},[m]);const aa=()=>{da.custom("","GET").then(o=>{y(b=>o.data.entry),o.data.entry.length>0&&v(b=>({label:o.data.entry[0].nomor_pesanan_pembelian_barang,value:o.data.entry[0].uuid}))}).catch(o=>w(o))};return s.useEffect(()=>{S?aa():($(o=>""),v(o=>!1),n(o=>W()),x(o=>null))},[S]),s.useEffect(()=>{u()},[]),a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-white rounded-md shadow-sm h-max",children:a.jsxs("div",{className:"py-5 px-6 h-max w-full z-10",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-2",children:"Pesanan Pembelian Barang"})}),a.jsxs("form",{onSubmit:o=>I(o),children:[a.jsxs("div",{className:"flex items-end gap-x-2",children:[a.jsxs("div",{className:"flex items-end gap-x-2 w-full",children:[S&&!z?a.jsx(a.Fragment,{children:a.jsx(Z,{label:"Nomor Pesanan Pembelian Barang",optionsDataList:_,optionsLabel:"nomor_pesanan_pembelian_barang",optionsValue:"uuid",selectValue:m,onchange:o=>{v(o)},selectName:"pesananPembelianBarangSelected"})}):a.jsx(a.Fragment,{children:a.jsx(H,{label:"Nomor Pesanan Pembelian Barang",type:"text",disabled:z&&P,addClassInput:z&&P?"border-none px-1":"",onchange:o=>{$(o.target.value)},others:{value:A,name:"nomorPesananPembelianBarang",disabled:z&&P}})}),z?a.jsx(a.Fragment,{children:N.length!=0||R?a.jsx(a.Fragment,{}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:`btn btn-sm ${P?"bg-yellow-400 hover:bg-yellow-400":""}`,onClick:()=>{E(o=>o=!o)},children:[P?a.jsx(Sa,{}):a.jsx(J,{})," ",P?"Edit":"Batal Edit"," Nomor Pesanan"]}),a.jsxs("button",{type:"button",onClick:()=>C(),className:"btn btn-sm bg-red-700 text-white",children:[a.jsx(na,{})," Hapus Nomor Pesanan"]})]})}):a.jsx(a.Fragment,{children:a.jsxs("button",{type:"button",className:`btn btn-sm ${S?"bg-red-900":"bg-blue-900"} text-white border-none`,onClick:()=>{f(o=>o=!o)},children:[S?a.jsx(J,{}):a.jsx(Na,{}),S?"Batal Pesanan Pembelian":"Pilih Pesanan Pembelian"]})})]}),a.jsx(H,{label:"Tanggal Pesanan Pembelian Barang",type:"datetime-local",onchange:o=>{n(o.target.value)},disabled:z,addClassInput:z?"border-none px-1":"",others:{value:K,name:"tanggalPesananPembelianBarang",disabled:z}})]}),i?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"mt-5 relative px-1",children:[a.jsx("p",{className:"font-bold text-sm mb-3",children:"Supplier Terpilih"}),a.jsxs("p",{className:"text-xl font-bold",children:[i.code," - ",i.name]}),a.jsxs("div",{className:"mt-3 flex gap-x-10",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Alamat Rumah"}),a.jsx("p",{className:"text-sm",children:i.alamat_rumah})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Alamat Kantor"}),a.jsx("p",{className:"text-sm",children:i.alamat_kantor})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"NPWP"}),a.jsx("p",{className:"text-sm",children:i.npwp})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Nomor Telepon"}),a.jsx("p",{className:"text-sm",children:i.no_telp})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Nomor Handphone"}),a.jsx("p",{className:"text-sm",children:i.no_hp})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Kode Harga"}),a.jsxs("p",{className:"text-sm",children:["Harga ",i.kode_harga]})]})]}),z?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"absolute top-0 right-3 flex mt-3 py-1 px-2 gap-x-2 items-center font-bold text-xs rounded-md bg-red-800 text-white",onClick:()=>{x(null)},type:"button",children:a.jsx(J,{})})})]})}):a.jsx(a.Fragment,{}),i?a.jsx(a.Fragment,{children:z&&P?a.jsx(a.Fragment,{children:a.jsxs("button",{type:"button",onClick:()=>{Y(o=>null),x(o=>null),f(o=>!1),D(o=>!1)},className:"btn btn-sm bg-red-800 mt-4 text-white",children:[a.jsx(J,{})," Reset Pesanan Pembelian"]})}):a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(ia,{})," Simpan"]})})}):a.jsx(a.Fragment,{})]}),i?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"mt-5",children:[a.jsxs("div",{className:"flex w-full items-center gap-x-2 mb-5",children:[a.jsx(U,{value:g,onchange:o=>B(o.target.value),other:{placeholder:"Cari Supplier"}}),e?a.jsx(Na,{onClick:()=>{u(g)},className:"cursor-pointer"}):a.jsx(J,{onClick:()=>u(""),className:"cursor-pointer"})]}),a.jsxs("table",{className:"table table-zebra",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Kode Supplier"}),a.jsx("th",{children:"Nama Supplier"}),a.jsx("th",{children:"Aksi"})]})}),a.jsx("tbody",{children:p==null?void 0:p.map((o,b)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[b+1,"."]}),a.jsx("td",{width:400,children:o.code}),a.jsx("td",{width:400,children:o.name}),a.jsx("td",{children:a.jsxs("button",{className:"flex py-1 px-5 gap-x-2 items-center rounded-xl bg-green-800 text-white",onClick:()=>{x(V=>o)},type:"button",children:[a.jsx(ea,{size:12.5}),a.jsx("p",{children:"Pilih"})]})})]},b)}))})]}),a.jsx(Ea,{paginateUpdatePage:k,paginate:t,setSize:O,shadow:"",sizeList:[2,4,6]})]})})]})}),z&&P?a.jsxs(a.Fragment,{children:[a.jsx(Da,{pesananPembelianBarang:z,supplier:i,fakturStatus:R,setPPNStatus:G,tanggalTransaksiAkhir:l,rincianPesananPembelianBarang:N,setRincianPesananPembelianBarang:d}),a.jsx(Ha,{pesananPembelianBarang:z,setFakturStatus:D,fakturStatus:R,ppnStatus:F,setTanggalTransaksiAkhir:c})]}):a.jsx(a.Fragment,{})]})},Wa=()=>{const[r,l]=s.useState(!1),[c,R]=s.useState(!1);return s.useState(""),s.useState(!0),a.jsx($a,{isLoading:r,children:a.jsxs("div",{children:[a.jsx(Ca,{title:"Pembelian Barang"}),a.jsx(Ua,{setAddPembelianBarang:R})]})})};export{Wa as default};
