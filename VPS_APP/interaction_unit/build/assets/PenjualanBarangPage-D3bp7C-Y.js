import{r as s,j as a,Q,p as g,bl as ra,m as la,aS as va,t as P,o as X,bB as da,a as J,d as M,M as ea,F as na,aV as Pa,bC as ca,c as xa,bo as ua,bp as ha,e as V,bD as aa,bE as ba,v as W,bs as pa,bF as _a,bG as oa,bH as Na,bI as ma,a7 as q,bx as Fa,f as Ta,bJ as ta,bz as ya,U as ka,R as Ba,bk as Ra,n as Sa,ai as $a,aj as Ca,w as Ea,b as Da,y as fa,am as Aa,bK as ia,W as wa,x as La}from"./index-BvApG6jC.js";import{F as I}from"./FormInputWithLabel-BQBlupgE.js";import{i as Z}from"./actionEvent.helper-DyO43kOw.js";import{T as Oa}from"./ToggleBox-DMkY0XpC.js";import{P as Ka}from"./Pagination-CkGsPFEi.js";import{l as Ga}from"./index-ChwcOQwl.js";import{P as za}from"./PDFHeader-B96ZEjIS.js";import"./react-paginate-C4maWJyb.js";import"./index-BKNjMPK8.js";const Ha=({pesananPenjualanBarang:n,_getDataRincianDaftarPasananPenjualan:l,kategoriHargaBarangList:p,customer:c})=>{const[w,y]=s.useState(!1),[z,B]=s.useState([]),[_,f]=s.useState(),[S,k]=s.useState(),[D,h]=s.useState(),[$,j]=s.useState(0),[C,i]=s.useState(0),[b,F]=s.useState(0),[v,K]=s.useState(0),[x,o]=s.useState(0),[t,A]=s.useState(0),G=()=>{h(m=>null),va.custom(`/gudang_barang/${S.value}/${n.uuid}/penjualan`,"GET").then(m=>{B(m.data),m.data.length>0&&h(T=>({label:m.data[0].daftar_gudang_name,value:m.data[0].uuid}))}).catch(m=>P(m))},r=async m=>{m.preventDefault(),await X(m.target)&&da.custom("","POST",null,{data:{pesanan_penjualan_barang:n.uuid,kategori_harga_barang:S.value,stok_awal_barang:D.value,kode_harga_customer:c.kode_harga,jumlah:`${$}`,harga:`${_[`harga_${c.kode_harga}`]}`,harga_setelah_diskon:`${t}`,ppn:`${_.ppn==1?_[`harga_${c.kode_harga}`]*ra/100:0}`,ppn_setelah_diskon:`${x}`,diskon_angka:`${C}`,diskon_persentase:`${b}`,total_harga:`${v}`}}).then(T=>{l()}).catch(T=>P(T))},L=m=>{try{const T=J(m.target.value)*_[`harga_${c.kode_harga}`]/100;F(m.target.value),i(e=>e=g(T))}catch{i(e=>0)}},O=()=>{try{const m=J(C)*100/_[`harga_${c.kode_harga}`];F(T=>T=m),U()}catch{F(T=>0)}};s.useEffect(()=>{_&&O()},[C]);const U=()=>{const m=J($),T=_[`harga_${c.kode_harga}`]-J(C);A(d=>T);const e=_.ppn==1?T*ra/100:0;o(d=>e);const E=m*T+e*m;K(d=>E)};return s.useEffect(()=>{_&&U()},[$]),s.useEffect(()=>{if(S){G();const m=p.filter(T=>T.uuid==S.value);m.length>0&&(j(T=>0),y(T=>0),i(T=>0),F(T=>0),f(m[0]))}},[S]),s.useEffect(()=>{k({label:p[0].kode_barang,value:p[0].uuid})},[]),a.jsx(a.Fragment,{children:a.jsxs("form",{className:"gap-x-2 py-3",onSubmit:m=>r(m),children:[a.jsxs("div",{className:"flex items-end gap-x-2",children:[a.jsx(Q,{label:"Kode Barang",optionsDataList:p,optionsLabel:"kode_barang",optionsValue:"uuid",selectValue:S,onchange:m=>{k(m)},selectName:"kategoriHargaBarang"}),a.jsx(Q,{label:"Gudang Asal",optionsDataList:z,optionsLabel:"daftar_gudang_name",optionsValue:"uuid",selectValue:D,onchange:m=>{h(m)},selectName:"gudangBarang"})]}),_?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"gap-x-2 bg-gray-300 my-4 rounded-md px-2 py-3",children:[a.jsx("p",{className:"text-xl font-extrabold",children:_.daftar_barang_name}),a.jsx("p",{className:"text-sm mt-5",children:"Harga Barang"}),a.jsxs("p",{className:"font-bold mt-1 text-xl",children:["Rp. ",g(_[`harga_${c.kode_harga}`])]}),_.ppn==1?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"flex gap-x-2 items-end mb-5",children:[a.jsx("p",{className:"text-sm",children:"PPN"}),a.jsxs("p",{className:"font-bold",children:["Rp. ",g(_[`harga_${c.kode_harga}`]*ra/100)]})]})}):a.jsx(a.Fragment,{}),a.jsx("p",{className:"font-bold bg-blue-800 px-2 text-white rounded-md w-max mt-2",children:_.satuan_barang_name})]}),D?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex gap-x-2",children:a.jsx(I,{addClassInput:"w-max",label:"Jumlah",type:"text",onchange:m=>{Z(m),j(m.target.value)},others:{value:$,name:"jumlah"}})}),a.jsx("div",{className:"mt-5",children:a.jsx(Oa,{label:"Gunakan Diskon ?",setToggleBox:y,toggleBox:w,toggleBoxList:[{label:"Tidak",value:0},{label:"Ya",value:1}]})}),w?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mt-5 flex gap-x-2",children:[a.jsx(I,{label:"Diskon Angka",type:"text",onchange:m=>{Z(m),i(m.target.value)},others:{value:C,name:"diskonAngka"}}),a.jsx(I,{label:"Diskon Persentase",type:"text",onchange:m=>{Z(m),L(m)},others:{value:b,name:"diskonPersentase"}})]}),a.jsxs("div",{className:"mt-5 gap-x-2 px-1",children:[a.jsx("p",{className:"font-bold mt-2",children:"Harga Setelah Diskon"}),a.jsxs("p",{className:"font-bold mt-2 text-xl",children:["Rp. ",g(t)]}),_.ppn==1?a.jsx(a.Fragment,{children:a.jsxs("p",{className:"font-bold mb-5 mt-2",children:["PPN Rp. ",g(x)]})}):a.jsx(a.Fragment,{})]})]}):a.jsx(a.Fragment,{}),a.jsxs("div",{className:"mt-5 gap-x-2 px-1",children:[a.jsx("p",{className:"font-bold text-sm",children:"Total Harga"}),a.jsxs("p",{className:"font-bold text-4xl",children:["Rp. ",g(v)]})]})]}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{}),D?a.jsx(a.Fragment,{children:a.jsxs("button",{className:"mt-3 btn w-full bg-green-800 text-white",children:[a.jsx(la,{})," Simpan Pesanan"]})}):a.jsx(a.Fragment,{})]})})},Ua=({pesananPenjualanBarang:n,customer:l,fakturStatus:p,setPPNStatus:c=()=>{},tanggalTransaksiAkhir:w,rincianPesananPenjualanBarang:y,setRincianPesananPenjualanBarang:z=()=>{}})=>{const[B,_]=s.useState([]),[f,S]=s.useState(!1),[k,D]=s.useState(0),h=()=>{da.custom(`/${n.uuid}`,"GET").then(i=>{c(b=>!1),z(i.data),i.data.filter(b=>b.ppn>0).length>0&&c(b=>!0)}).catch(i=>P(i))},$=()=>{Pa.custom("/transaksi","GET").then(i=>{_(i.data)}).catch(i=>P(i))},j=i=>{da.custom(`/${i}`,"DELETE").then(b=>{h()}).catch(b=>P(b))},C=()=>{ca.custom("/pesanan_by_tanggal","POST",null,{data:{faktur_penjualan_barang:p,tanggal:w}}).then(i=>{z(F=>i.data);const b=i.data.reduce((F,v)=>F+parseFloat(v.piutang),0);D(F=>b)})};return s.useEffect(()=>{$(),p?C():h()},[p,w,f]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"grid grid-cols-12 gap-x-2",children:[a.jsx("div",{className:`${p?"hidden":"col-span-4"}`,children:B.length>0?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white rounded-md my-4 py-6 px-6 shadow-2xl",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Detail Barang Pesanan"}),a.jsx(Ha,{_getDataRincianDaftarPasananPenjualan:h,_hapusPesanan:()=>{},customer:l,kategoriHargaBarangList:B,pesananPenjualanBarang:n})]})}):a.jsx(a.Fragment,{})}),a.jsx("div",{className:`${p?"col-span-12":"col-span-8"}`,children:a.jsxs("div",{className:`bg-white my-4 rounded-md no-scrollbar relative ${p?"h-max max-h-[60vh]":"h-[70vh]"} overflow-y-scroll`,children:[a.jsxs("div",{className:"sticky top-0",children:[a.jsxs("div",{className:"bg-white py-4 px-6 rounded-md",children:[a.jsx("p",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Total Pesanan"}),a.jsxs("p",{className:"font-bold text-4xl",children:["Rp. ",g(y.reduce((i,b)=>i+parseFloat(b.total_harga),0))]}),p?a.jsx(a.Fragment,{children:k>0?a.jsxs("div",{className:"flex items-center gap-x-2 w-max my-2 px-2 py-1 rounded-md border-2 border-red-800",children:[a.jsx(M,{className:"text-red-800",size:13}),a.jsx("p",{className:"mb-0 text-red-800 font-bold",children:"Belum Lunas"})]}):a.jsxs("div",{className:"flex items-center gap-x-2 w-max my-2 px-2 py-1 rounded-md border-2 border-green-800",children:[a.jsx(ea,{className:"text-green-800",size:13}),a.jsx("p",{className:"mb-0 text-green-800 font-bold",children:"Lunas"})]})}):a.jsx(a.Fragment,{}),p?a.jsx(a.Fragment,{children:f?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn bg-gray-100 text-red-500 btn-sm mt-4 border-red-500",onClick:()=>{S(i=>i=!i)},children:"Tutup Daftar Pesanan"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn bg-gray-100 btn-sm mt-4 border-gray-500",onClick:()=>{S(i=>i=!i)},children:"Lihat Daftar Pesanan"})})}):a.jsx(a.Fragment,{})]}),p&&!f?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"grid grid-cols-12 text-sm gap-x-2 py-2 font-bold border-t-2 bg-gray-100 px-6",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("p",{className:"text-gray-500",children:"No."})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Kode Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Nama Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Satuan Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-gray-500 text-md",children:"Harga Barang"})})]})})]}),p&&!f?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:y.map((i,b)=>a.jsxs("div",{className:"py-3  border-t-2",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 px-6 items-start font-bold",children:[a.jsx("div",{className:"col-span-1",children:a.jsxs("p",{className:"text-sm",children:[b+1,"."]})}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-sm",children:i.kategori_harga_barang_kode_barang}),a.jsx("p",{className:"text-xs my-1 font-normal",children:i.daftar_gudang_name})]}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:i.daftar_barang_name})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:i.satuan_barang_name})}),a.jsxs("div",{className:"col-span-3",children:[a.jsxs("p",{className:"text-sm",children:["Rp. ",g(i.harga)]}),a.jsxs("p",{className:"text-xs font-normal",children:["PPN : Rp. ",g(i.ppn)]})]})]}),a.jsxs("div",{className:"grid grid-cols-12 text-xs gap-x-2 px-6 text-gray-500 font-bold",children:[a.jsx("div",{className:"col-span-1"}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("p",{children:["Jumlah : ",g(i.jumlah)]}),p?a.jsx(a.Fragment,{children:a.jsxs("p",{children:["Retur : ",g(i.retur)]})}):a.jsx(a.Fragment,{})]}),a.jsx("div",{className:"col-span-3",children:i.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsx("p",{children:"Diskon"}),a.jsx("p",{children:"Harga Diskon"}),a.jsx("p",{children:"PPN Diskon"})]}):a.jsx(a.Fragment,{})}),a.jsx("div",{className:"col-span-3",children:i.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["Rp. ",g(i.diskon_angka)," (",i.diskon_persentase," % )"]}),a.jsxs("p",{children:["Rp. ",g(i.harga_setelah_diskon)]}),a.jsxs("p",{children:["Rp. ",g(i.ppn_setelah_diskon)]})]}):a.jsx(a.Fragment,{})}),a.jsxs("div",{className:"col-span-3",children:["Total Harga ",a.jsxs("p",{children:["Rp. ",g(i.total_harga)]}),p?a.jsxs(a.Fragment,{children:["Status ",a.jsx("p",{children:i.piutang!="0"?`Belum Lunas ( Rp. ${g(i.piutang)} )`:"Sudah Lunas"})]}):a.jsx(a.Fragment,{})]})]}),p?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsx("div",{className:"grid grid-cols-12 gap-x-2 px-6",children:a.jsx("div",{className:"col-span-1 col-start-2 mb-3",children:a.jsxs("button",{className:"btn w-max btn-sm bg-red-700 text-white",onClick:F=>{j(i.uuid)},children:[a.jsx(na,{})," Hapus"]})})})})]}))})]})})]})})},Ia=({riwayatPelunasanPenjualanBarang:n,edited:l,_getDaftarRiwayatTransaksi:p=()=>{}})=>{var U,m,T;const[c,w]=s.useState(n.nomor_transaksi!="EMPTY"?n.nomor_transaksi:""),[y,z]=s.useState(n.bukti_transaksi!="EMPTY"?n.bukti_transaksi:""),[B,_]=s.useState(n.keterangan!="EMPTY"?n.keterangan:"Tidak Ada"),[f,S]=s.useState(n.total),[k,D]=s.useState(!1),[h,$]=s.useState([]),[j,C]=s.useState([]),[i,b]=s.useState(!1),[F,v]=s.useState(l),K=()=>{aa.custom(`/cek_denda_pelunasan_penjualan/${n.uuid}`,"GET").then(e=>{D(E=>e.data)}).catch(e=>P(e))},x=()=>{ca.custom(`/pesanan/${n.uuid}`).then(e=>{$(e.data)}).catch(e=>P(e))},o=()=>{ba.custom(`/pesanan/${n.uuid}`).then(e=>{C(e.data)}).catch(e=>P(e))},t=(e,E)=>{let d=h,R=0;d=d.map(H=>(H.uuid==E&&(H.nilai_pelunasan=e),R+=J(H.nilai_pelunasan),H)),S(H=>R),$(H=>d)},A=(e,E)=>{let d=j,R=0;d=d.map(H=>(H.uuid==E&&(H.nilai_pelunasan=e),R+=J(H.nilai_pelunasan),H)),S(H=>R),C(H=>d)},G=async()=>{for(let e=0;e<j.length;e++)await ba.custom(`${j[e].rincian_pelunasan_penjualan_denda_barang?`/${j[e].rincian_pelunasan_penjualan_denda_barang}`:""}`,j[e].rincian_pelunasan_penjualan_denda_barang?"PUT":"POST",null,{data:{pelunasan_penjualan_barang:n.uuid,rincian_pesanan_penjualan_barang:j[e].uuid,hari_terlewat:j[e].hari_terlewat,total_denda:j[e].total_denda,denda_sudah_dibayar:j[e].denda_sudah_dibayar,piutang_denda:j[e].total_denda-j[e].denda_sudah_dibayar,nilai_pelunasan:`${j[e].nilai_pelunasan}`}}).then(()=>{W("Berhasil","Data Berhasil Disimpan")}).catch(E=>P(E));o()},r=async()=>{for(let e=0;e<h.length;e++)await ca.custom(`${h[e].rincian_pelunasan_penjualan_barang?`/${h[e].rincian_pelunasan_penjualan_barang}`:""}`,h[e].rincian_pelunasan_penjualan_barang?"PUT":"POST",null,{data:{pelunasan_penjualan_barang:n.uuid,rincian_pesanan_penjualan_barang:h[e].uuid,sudah_dibayar:h[e].sudah_dibayar,piutang:h[e].piutang,nilai_pelunasan:`${h[e].nilai_pelunasan}`}}).then(()=>{W("Berhasil","Data Berhasil Disimpan")}).catch(E=>P(E));x()},L=()=>{aa.custom("/"+n.uuid,"DELETE").then(()=>{p()}).catch(e=>P(e))},O=async()=>{await pa(),await X()&&aa.custom("/"+n.uuid,"PUT",null,{data:{nomor_pelunasan_penjualan_barang:c,bukti_transaksi:y,keterangan:B,faktur_penjualan_barang:n.faktur_penjualan_barang,tanggal:n.tanggal,kode_akun_perkiraan:n.kode_akun_perkiraan}}).then(()=>{W("Berhasil","Data Berhasil Disimpan")}).catch(e=>P(e))};return s.useEffect(()=>{k==0?x():o()},[k]),s.useEffect(()=>{i&&K()},[i]),a.jsxs("div",{className:"border-b-2 py-2",children:[a.jsx("div",{className:"cursor-pointer",onClick:()=>{v(e=>e=!e)},children:a.jsxs("div",{className:"flex items-center justify-between gap-x-2 px-4",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsx("p",{className:"text-sm pr-2 font-medium",children:xa(n.tanggal.split("T")[1])}),a.jsx("p",{className:"text-sm pr-2 font-medium px-3 border-l-2 border-black",children:"Pelunasan Penjualan Barang"})]}),F?a.jsx(ua,{size:15}):a.jsx(ha,{size:15})]})}),F?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"ml-4 py-4 px-4",children:[((U=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))==null?void 0:U.hasil_stok_opname_count)==0?a.jsx(a.Fragment,{}):a.jsx("p",{className:"text-xs font-medium text-green-600 my-3",children:(m=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))!=null&&m.nomor_perintah_stok_opname?`Telah Terdaftar Pada Surat Perintah Stok Opname ${(T=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))==null?void 0:T.nomor_perintah_stok_opname}`:""}),F?a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"text-left text-sm",children:[a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Nomor Pelunasan Penjualan Barang"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(V,{addClass:"px-0",name:"nomor_pelunasan_penjualan_barang",value:c,onchange:e=>w(e.target.value)}):n.nomor_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Bukti Transaksi"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(V,{addClass:"px-0",name:"bukti_transaksi",value:y,onchange:e=>z(e.target.value)}):n.bukti_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-5":""}`,children:"Kode Akun"}),a.jsx("td",{className:`px-5 ${l?"pb-5":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-5":""}`,children:[n.kode_akun_perkiraan_code," - ",n.kode_akun_perkiraan_name]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Total Pelunasan"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-3":""}`,children:["Rp. ",g(f)]})]})]}),a.jsx("p",{className:`text-sm mt-3 ${l?"mt-5":""}`,children:"Keterangan"}),a.jsx("p",{className:"text-sm mb-3",children:l?a.jsx(V,{addClass:"mt-5",name:"keterangan",value:B,onchange:e=>_(e.target.value)}):n.keterangan}),a.jsxs("div",{className:"my-2 flex justify-between",children:[a.jsx("div",{children:l?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"mr-2 btn btn-sm bg-green-900 text-white",onClick:()=>O(),children:[a.jsx(ea,{size:12}),"Simpan"]}),a.jsxs("button",{className:"mr-2 btn btn-sm bg-red-500 text-white",onClick:()=>L(),children:[a.jsx(na,{size:12}),"Hapus"]})]}):a.jsx(a.Fragment,{})}),i?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm border-red-500 text-red-500",onClick:()=>b(e=>e=!e),children:"Tutup Daftar Pelunasan"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm bg-white border-gray-400",onClick:()=>b(e=>e=!e),children:"Lihat Daftar Pelunasan"})})]}),i?a.jsx(a.Fragment,{children:k==1?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Hari Terlewat"}),a.jsx("th",{children:"Total Denda"}),a.jsx("th",{children:"Denda Sudah Dibayar"}),a.jsx("th",{children:"Piutang Denda"}),a.jsx("th",{width:200,children:"Nilai Pelunasan"})]}),a.jsx("tbody",{children:j.map((e,E)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[E+1,"."]}),a.jsx("td",{children:e.kategori_harga_barang_kode_barang}),a.jsx("td",{children:e.daftar_barang_name}),a.jsx("td",{children:e.satuan_barang_name}),a.jsx("td",{children:e.daftar_gudang_name}),a.jsxs("td",{children:[e.hari_terlewat," Hari"]}),a.jsxs("td",{children:["Rp. ",g(e.total_denda)]}),a.jsxs("td",{children:["Rp. ",g(e.denda_sudah_dibayar)]}),a.jsxs("td",{children:["Rp. ",g(e.piutang_denda)]}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(V,{name:"nilai_pelunasan",type:"text",other:{defaultValue:0},onchange:d=>{Z(d,e.piutang_denda),A(d.target.value,e.uuid)},value:g(e.nilai_pelunasan)})}):a.jsxs(a.Fragment,{children:["Rp. ",g(e.nilai_pelunasan)]})})]})}))})]})}),l?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn btn-sm bg-green-900 text-white",onClick:()=>{G()},children:"Simpan"})})}):a.jsx(a.Fragment,{})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Pelunasan Sudah Dibayar"}),a.jsx("th",{children:"Piutang"}),a.jsx("th",{width:200,children:"Nilai Pelunasan"})]}),a.jsx("tbody",{children:h.map((e,E)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[E+1,"."]}),a.jsx("td",{children:e.kategori_harga_barang_kode_barang}),a.jsx("td",{children:e.daftar_barang_name}),a.jsx("td",{children:e.satuan_barang_name}),a.jsx("td",{children:e.daftar_gudang_name}),a.jsxs("td",{children:["Rp. ",g(e.sudah_dibayar)]}),a.jsxs("td",{children:["Rp. ",g(e.piutang)]}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(V,{name:"nilai_pelunasan",type:"text",other:{defaultValue:0},onchange:d=>{Z(d,e.piutang),t(d.target.value,e.uuid)},value:g(e.nilai_pelunasan)})}):a.jsxs(a.Fragment,{children:["Rp. ",g(e.nilai_pelunasan)]})})]})}))})]})}),l?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn btn-sm bg-green-900 text-white",onClick:()=>{r()},children:"Simpan"})})}):a.jsx(a.Fragment,{})]})}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]})}):a.jsx(a.Fragment,{})]})},Va=({riwayatReturPenjualanBarang:n,edited:l,_getDaftarRiwayatTransaksi:p=()=>{}})=>{var t,A,G;const[c,w]=s.useState(n.nomor_transaksi!="EMPTY"?n.nomor_transaksi:""),[y,z]=s.useState(n.bukti_transaksi!="EMPTY"?n.bukti_transaksi:""),[B,_]=s.useState(n.keterangan!="EMPTY"?n.keterangan:"Tidak Ada"),[f,S]=s.useState(n.total),[k,D]=s.useState(!1),[h,$]=s.useState([]),[j,C]=s.useState(!1),[i,b]=s.useState(l),F=()=>{_a.custom(`/pesanan/${n.uuid}`).then(r=>{$(r.data)}).catch(r=>P(r))},v=(r,L)=>{let O=h,U=0;O=O.map(m=>(m.uuid==L&&(m.retur=r,m.nilai_retur=(m.harga_setelah_diskon+m.ppn_setelah_diskon)*J(r),m.nilai_retur>m.sudah_dibayar_fix&&(m.nilai_retur=m.sudah_dibayar_fix)),U+=J(m.nilai_retur),m)),S(m=>U),$(m=>O)},K=async()=>{for(let r=0;r<h.length;r++)await _a.custom(`${h[r].rincian_retur_penjualan_barang?`/${h[r].rincian_retur_penjualan_barang}`:""}`,h[r].rincian_retur_penjualan_barang?"PUT":"POST",null,{data:{retur_penjualan_barang:n.uuid,rincian_pesanan_penjualan_barang:h[r].uuid,jumlah:`${h[r].jumlah_fix}`,denda_sudah_dibayar:`${h[r].denda_sudah_dibayar}`,sudah_dibayar:`${h[r].sudah_dibayar_fix}`,retur:`${h[r].retur}`,nilai_retur:`${h[r].nilai_retur}`,retur_sebelum:`${h[r].retur_sebelum}`,nilai_retur_sebelum:`${h[r].nilai_retur_sebelum}`}}).then(()=>W("Berhasil","Data Berhasil Disimpan")).catch(L=>P(L));F()},x=()=>{oa.custom("/"+n.uuid,"DELETE").then(()=>{p()}).catch(r=>P(r))},o=async()=>{await pa(),await X()&&oa.custom("/"+n.uuid,"PUT",null,{data:{nomor_retur_penjualan_barang:c,bukti_transaksi:y,keterangan:B,faktur_penjualan_barang:n.faktur_penjualan_barang,tanggal:n.tanggal,kode_akun_perkiraan:n.kode_akun_perkiraan}}).then(()=>W("Berhasil","Data Berhasil Disimpan")).catch(r=>P(r))};return s.useEffect(()=>{j&&!k&&(F(),D(r=>!0))},[j]),a.jsxs("div",{className:"border-b-2 py-2",children:[a.jsx("div",{className:"cursor-pointer",onClick:()=>{b(r=>r=!r)},children:a.jsxs("div",{className:"flex items-center justify-between gap-x-2 px-4",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsx("p",{className:"text-sm pr-2 font-medium",children:xa(n.tanggal.split("T")[1])}),a.jsx("p",{className:"text-sm pr-2 font-medium px-4 border-l-2 border-black",children:"Retur Penjualan Barang"})]}),i?a.jsx(ua,{size:15}):a.jsx(ha,{size:15})]})}),i?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"ml-4 py-4 px-4",children:[((t=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))==null?void 0:t.hasil_stok_opname_count)==0?a.jsx(a.Fragment,{}):a.jsx("p",{className:"text-xs font-medium text-green-600 my-3",children:(A=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))!=null&&A.nomor_perintah_stok_opname?`Telah Terdaftar Pada Surat Perintah Stok Opname ${(G=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))==null?void 0:G.nomor_perintah_stok_opname}`:""}),i?a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"text-left text-sm",children:[a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Nomor Retur Penjualan Barang"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(V,{addClass:"px-0",name:"nomor_retur_penjualan_barang",value:c,onchange:r=>w(r.target.value)}):n.nomor_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Bukti Transaksi"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(V,{addClass:"px-0",name:"bukti_transaksi",value:y,onchange:r=>z(r.target.value)}):n.bukti_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-5":""}`,children:"Kode Akun"}),a.jsx("td",{className:`px-5 ${l?"pb-5":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-5":""}`,children:[n.kode_akun_perkiraan_code," - ",n.kode_akun_perkiraan_name]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Total Retur"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-3":""}`,children:["Rp. ",g(f)]})]})]}),a.jsx("p",{className:`text-sm mt-3 ${l?"mt-5":""}`,children:"Keterangan"}),a.jsx("p",{className:"text-sm mb-3",children:l?a.jsx(V,{addClass:"mt-5",name:"keterangan",value:B,onchange:r=>_(r.target.value)}):n.keterangan}),a.jsxs("div",{className:"my-2 flex justify-between",children:[a.jsx("div",{children:l?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"mr-2 btn btn-sm bg-green-900 text-white",onClick:()=>o(),children:[a.jsx(ea,{size:12}),"Simpan"]}),a.jsxs("button",{className:"mr-2 btn btn-sm bg-red-500 text-white",onClick:()=>x(),children:[a.jsx(na,{size:12}),"Hapus"]})]}):a.jsx(a.Fragment,{})}),j?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm border-red-500 text-red-500",onClick:()=>C(r=>r=!r),children:"Tutup Daftar Retur"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm bg-white border-gray-400",onClick:()=>C(r=>r=!r),children:"Lihat Daftar Retur"})})]}),j?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Pelunasan Sudah Dibayar"}),a.jsx("th",{width:150,children:"Retur Sebelumnya"}),a.jsx("th",{width:150,children:"Retur"}),a.jsx("th",{children:"Nilai Retur"})]}),a.jsx("tbody",{children:h.map((r,L)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[L+1,"."]}),a.jsx("td",{children:r.kategori_harga_barang_kode_barang}),a.jsx("td",{children:r.daftar_barang_name}),a.jsx("td",{children:r.satuan_barang_name}),a.jsx("td",{children:r.daftar_gudang_name}),a.jsxs("td",{children:["Rp. ",g(r.sudah_dibayar_fix)]}),a.jsxs("td",{children:[g(r.retur_sebelum)," ",r.satuan_barang_name]}),a.jsx("td",{children:l?a.jsx(a.Fragment,{children:a.jsx(V,{name:"retur",type:"text",other:{defaultValue:0},onchange:O=>{Z(O,r.jumlah_fix),v(O.target.value,r.uuid)},value:g(r.retur)})}):a.jsxs(a.Fragment,{children:[g(r.retur)," ",r.satuan_barang_name]})}),a.jsxs("td",{children:["Rp. ",g(r.nilai_retur)]})]})}))})]})}),l?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn btn-sm bg-green-900 text-white",onClick:()=>{K()},children:"Simpan"})})}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]})}):a.jsx(a.Fragment,{})]})},Ya=({riwayatPengembalianDendaPenjualanBarang:n,edited:l,_getDaftarRiwayatTransaksi:p=()=>{}})=>{var K,x,o;const[c,w]=s.useState(n.nomor_transaksi!="EMPTY"?n.nomor_transaksi:""),[y,z]=s.useState(n.bukti_transaksi!="EMPTY"?n.bukti_transaksi:""),[B,_]=s.useState(n.keterangan!="EMPTY"?n.keterangan:"Tidak Ada"),[f,S]=s.useState(n.total),[k,D]=s.useState([]),[h,$]=s.useState(l),[j,C]=s.useState(l),i=()=>{Na.custom(`/pesanan/${n.uuid}`).then(t=>{D(t.data),S(A=>t.data.reduce((G,r)=>r.denda_yang_dikembalikan+G,0))}).catch(t=>P(t))},b=async()=>{for(let t=0;t<k.length;t++)await Na.custom(`${k[t].rincian_pengembalian_denda_penjualan_barang?`/${k[t].rincian_pengembalian_denda_penjualan_barang}`:""}`,k[t].rincian_pengembalian_denda_penjualan_barang?"PUT":"POST",null,{data:{pengembalian_denda_penjualan_barang:n.uuid,rincian_pesanan_penjualan_barang:k[t].uuid,denda_yang_dikembalikan:`${k[t].denda_yang_dikembalikan}`}}).then(()=>{W("Berhasil","Data Berhasil Disimpan")});i()},F=()=>{ma.custom("/"+n.uuid,"DELETE").then(()=>{p()}).catch(t=>P(t))},v=async()=>{await pa(),await X()&&ma.custom("/"+n.uuid,"PUT",null,{data:{nomor_pengembalian_denda_penjualan_barang:c,bukti_transaksi:y,keterangan:B,faktur_penjualan_barang:n.faktur_penjualan_barang,tanggal:n.tanggal,kode_akun_perkiraan:n.kode_akun_perkiraan}}).then(()=>{b()}).catch(t=>P(t))};return s.useEffect(()=>{h&&i()},[h]),a.jsxs("div",{className:"border-b-2 py-2",children:[a.jsx("div",{className:"cursor-pointer",onClick:()=>{C(t=>t=!t)},children:a.jsxs("div",{className:"flex items-center justify-between gap-x-2 px-4",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsx("p",{className:"text-sm pr-2 font-medium",children:xa(n.tanggal.split("T")[1])}),a.jsx("p",{className:"text-sm pr-2 font-medium px-3 border-l-2 border-black",children:"Pengembalian Denda Penjualan Barang"})]}),j?a.jsx(ua,{size:15}):a.jsx(ha,{size:15})]})}),j?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"ml-4 py-4 px-4",children:[((K=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))==null?void 0:K.hasil_stok_opname_count)==0?a.jsx(a.Fragment,{}):a.jsx("p",{className:"text-xs font-medium text-green-600 my-3",children:(x=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))!=null&&x.nomor_perintah_stok_opname?`Telah Terdaftar Pada Surat Perintah Stok Opname ${(o=JSON.parse(n.perintah_stok_opname_nomor_surat_perintah))==null?void 0:o.nomor_perintah_stok_opname}`:""}),j?a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"text-left text-sm",children:[a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Nomor Pengembalian Denda Penjualan Barang"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(V,{addClass:"px-0",name:"nomor_pengembalian_denda_penjualan_barang",value:c,onchange:t=>w(t.target.value)}):n.nomor_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Bukti Transaksi"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsx("td",{className:`${l?"pb-3":""}`,children:l?a.jsx(V,{addClass:"px-0",name:"bukti_transaksi",value:y,onchange:t=>z(t.target.value)}):n.bukti_transaksi})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-5":""}`,children:"Kode Akun"}),a.jsx("td",{className:`px-5 ${l?"pb-5":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-5":""}`,children:[n.kode_akun_perkiraan_code," - ",n.kode_akun_perkiraan_name]})]}),a.jsxs("tr",{children:[a.jsx("td",{className:`${l?"pb-3":""}`,children:"Total PengembalianDenda"}),a.jsx("td",{className:`px-5 ${l?"pb-3":""}`,children:":"}),a.jsxs("td",{className:`${l?"pb-3":""}`,children:["Rp. ",g(f)]})]})]}),a.jsx("p",{className:`text-sm mt-3 ${l?"mt-5":""}`,children:"Keterangan"}),a.jsx("p",{className:"text-sm mb-3",children:l?a.jsx(V,{addClass:"mt-5",name:"keterangan",value:B,onchange:t=>_(t.target.value)}):n.keterangan}),a.jsxs("div",{className:"my-2 flex justify-between",children:[a.jsx("div",{children:l?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"mr-2 btn btn-sm bg-green-900 text-white",onClick:()=>v(),children:[a.jsx(ea,{size:12}),"Simpan"]}),a.jsxs("button",{className:"mr-2 btn btn-sm bg-red-500 text-white",onClick:()=>F(),children:[a.jsx(na,{size:12}),"Hapus"]})]}):a.jsx(a.Fragment,{})}),h?a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm border-red-500 text-red-500",onClick:()=>$(t=>t=!t),children:"Tutup Daftar PengembalianDenda"})}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"btn btn-sm bg-white border-gray-400",onClick:()=>$(t=>t=!t),children:"Lihat Daftar PengembalianDenda"})})]}),h?a.jsx(a.Fragment,{children:a.jsx("div",{className:"overflow-x-auto mt-5 max-h-[20vh] no-scrollbar pb-4",children:a.jsxs("table",{className:"table table-sm table-zebra rounded-xl",children:[a.jsxs("thead",{className:"bg-blue-950 z-10 text-white sticky top-0",children:[a.jsx("th",{children:"No."}),a.jsx("th",{children:"Kode Barang"}),a.jsx("th",{children:"Nama Barang"}),a.jsx("th",{children:"Satuan Barang"}),a.jsx("th",{children:"Gudang Asal"}),a.jsx("th",{children:"Denda Yang Dikembalikan"})]}),a.jsx("tbody",{children:k.map((t,A)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[A+1,"."]}),a.jsx("td",{children:t.kategori_harga_barang_kode_barang}),a.jsx("td",{children:t.daftar_barang_name}),a.jsx("td",{children:t.satuan_barang_name}),a.jsx("td",{children:t.daftar_gudang_name}),a.jsxs("td",{children:["Rp. ",g(t.denda_yang_dikembalikan)]})]})}))})]})})}):a.jsx(a.Fragment,{})]}):a.jsx(a.Fragment,{})]})}):a.jsx(a.Fragment,{})]})},Ja=({fakturPenjualanBarang:n,setFakturCancel:l=()=>{},setTanggalTransaksiAkhir:p=()=>{}})=>{const[c,w]=s.useState(q()),[y,z]=s.useState({label:"Pelunasan",value:"Pelunasan"}),B=["Pelunasan","Retur","Pengembalian_Denda"],[_,f]=s.useState(),[S,k]=s.useState([]),[D,h]=s.useState([]),[$,j]=s.useState(!0),[C,i]=s.useState([]),b=()=>{j(x=>!1),l(x=>!0),i(x=>B.filter(o=>o!="Pengembalian_Denda").map(o=>({label:o.replace("_"," "),value:o}))),n&&ta.custom("/riwayat_transaksi/"+n.uuid).then(x=>{x.data.length>0&&(l(o=>!1),p(o=>x.data[0].tanggal),x.data.filter(o=>o.type=="retur_penjualan_barang").length>0&&i(o=>B.map(t=>({label:t.replace("_"," "),value:t})))),h(o=>ya(x.data))})},F=async x=>{if(x.preventDefault(),await X(x.target)){let o=aa;y.value=="Retur"&&(o=oa),y.value=="Pengembalian_Denda"&&(o=ma);const t={faktur_penjualan_barang:n.uuid,tanggal:c,bukti_transaksi:"EMPTY",kode_akun_perkiraan:_.value,keterangan:"EMPTY"};t[`nomor_${y.value.toLowerCase()}_penjualan_barang`]="EMPTY",o.custom("","POST",null,{data:t}).then(()=>{W("Berhasil","Data Berhasil Disimpan"),b(),w(q())}).catch(A=>P(A))}},v=()=>{ka.custom("/kas_bank","GET").then(x=>{k(o=>x.data),x.data.length>0&&f({label:`${x.data[0].code} - ${x.data[0].name}`,value:x.data[0].uuid})})},K=()=>{ka.custom("/piutang_usaha","GET").then(x=>{const o=[x.data];k(t=>o),o.length>0&&f({label:`${o[0].code} - ${o[0].name}`,value:o[0].uuid})})};return s.useEffect(()=>{j(x=>!0)},[D]),s.useEffect(()=>{if(k(x=>[]),f(x=>null),v(),y.value=="Retur"&&(K(),D.length>0)){const x=D.filter(o=>o.data.filter(t=>t.type=="pelunasan_penjualan_barang").length>0);if(x.length>0){const o=x[0].data.filter(t=>t.type=="pelunasan_penjualan_barang");o.length>0&&aa.custom(`/cek_denda_pelunasan_penjualan/${o[0].uuid}`,"GET").then(t=>{t.data==0&&v()}).catch(t=>P(t))}}},[y]),s.useEffect(()=>{b(),v()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"bg-white rounded-md mt-4 py-6 px-6 shadow-2xl",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Riwayat Transaksi Penjualan Barang"}),a.jsxs("form",{className:"mb-5 border-[3px] rounded-md py-2 px-3",onSubmit:x=>F(x),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(I,{label:"Tanggal",type:"datetime-local",onchange:x=>{w(x.target.value)},others:{value:c,name:"tanggal"}}),a.jsx(Q,{label:"Tipe Transaksi",addClass:"z-50",optionsDataList:C,onchange:x=>{z(x)},optionsLabel:"label",optionsValue:"value",selectName:"tipe_transaksi",selectValue:y}),a.jsx(Q,{label:"Kode Akun",optionsDataList:S,optionsLabel:["code","name"],optionsValue:"uuid",addClass:"z-50",optionsLabelIsArray:!0,optionsDelimiter:"-",selectValue:_,onchange:x=>{f(x)},selectName:"kodeAkun"})]}),a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(la,{})," Simpan"]})]}),a.jsx("div",{className:"flex flex-col max-h-[60vh] overflow-scroll no-scrollbar relative",children:$?a.jsx(a.Fragment,{children:D.map((x,o)=>a.jsxs("div",{className:"mb-5",children:[a.jsx("p",{className:"font-bold mb-3 sticky top-0 bg-gray-300 p-2 z-20",children:Fa("/",Ta(x.parent,!1))}),a.jsx("div",{className:"flex flex-col",children:x.data.map((t,A)=>{var G,r,L;return a.jsxs(a.Fragment,{children:[t.type=="pelunasan_penjualan_barang"?a.jsx(a.Fragment,{children:a.jsx(Ia,{riwayatPelunasanPenjualanBarang:t,edited:((G=JSON.parse(t.perintah_stok_opname_nomor_surat_perintah))==null?void 0:G.hasil_stok_opname_count)>0?!1:o==0&&A==0,_getDaftarRiwayatTransaksi:b})}):a.jsx(a.Fragment,{}),t.type=="retur_penjualan_barang"?a.jsx(a.Fragment,{children:a.jsx(Va,{riwayatReturPenjualanBarang:t,edited:((r=JSON.parse(t.perintah_stok_opname_nomor_surat_perintah))==null?void 0:r.hasil_stok_opname_count)>0?!1:o==0&&A==0,_getDaftarRiwayatTransaksi:b})}):a.jsx(a.Fragment,{}),t.type=="pengembalian_denda_penjualan_barang"?a.jsx(a.Fragment,{children:a.jsx(Ya,{riwayatPengembalianDendaPenjualanBarang:t,edited:((L=JSON.parse(t.perintah_stok_opname_nomor_surat_perintah))==null?void 0:L.hasil_stok_opname_count)>0?!1:o==0&&A==0,_getDaftarRiwayatTransaksi:b})}):a.jsx(a.Fragment,{})]})})})]}))}):a.jsx(a.Fragment,{children:a.jsx("p",{className:"font-bold",children:"Riwayat Transaksi Belum Ada."})})})]})})},Ma=Ba.forwardRef((n,l)=>a.jsxs("div",{ref:l,children:[a.jsx(za,{bulan:n.bulan,tahun:n.tahun,title:"INVOICE"}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",children:"KEPADA :"}),a.jsx("p",{children:"Customer 1"}),a.jsx("p",{children:"CS00001 | 081276391273"})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-bold",children:"TANGGAL :"}),a.jsx("p",{children:"Senin, 19 Agustus 2024"})]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO FAKTUR PENJUALAN BARANG :"}),a.jsx("p",{children:"1890309801297939"})]}),a.jsx("div",{className:"text-right",children:a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:"font-bold",children:"NO PESANAN PENJUALAN BARANG :"}),a.jsx("p",{children:"1890309801297939"})]})})]}),a.jsxs("div",{className:"mt-4 grid grid-cols-12 text-sm gap-x-2 py-2 font-bold border-t-2 px-6",children:[a.jsx("div",{className:"col-span-1",children:a.jsx("p",{children:"No."})}),a.jsx("div",{className:"col-span-2",children:a.jsx("p",{children:"Kode Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{children:"Nama Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{children:"Satuan Barang"})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{children:"Harga Barang"})})]}),n.rincianPesananPenjualanBarang.map((p,c)=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"py-3  border-t-2",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 px-6 py-3 items-start font-bold",children:[a.jsx("div",{className:"col-span-1",children:a.jsxs("p",{className:"text-sm",children:[c+1,"."]})}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-sm",children:p.kategori_harga_barang_kode_barang}),a.jsx("p",{className:"text-sm my-1",children:p.daftar_gudang_name})]}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:p.daftar_barang_name})}),a.jsx("div",{className:"col-span-3",children:a.jsx("p",{className:"text-sm",children:p.satuan_barang_name})}),a.jsxs("div",{className:"col-span-3",children:[a.jsxs("p",{className:"text-sm",children:["Rp. ",g(p.harga)]}),a.jsxs("p",{className:"text-sm",children:["PPN : Rp. ",g(p.ppn)]})]})]}),a.jsxs("div",{className:"grid grid-cols-12 text-sm gap-x-2 px-6 font-bold",children:[a.jsx("div",{className:"col-span-1"}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("p",{children:["Jumlah : ",g(p.jumlah)]}),p!=null&&p.retur?a.jsx(a.Fragment,{children:a.jsxs("p",{children:["Retur : ",g(p.retur)]})}):a.jsx(a.Fragment,{})]}),a.jsx("div",{className:"col-span-3",children:p.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsx("p",{children:"Diskon"}),a.jsx("p",{children:"Harga Diskon"}),a.jsx("p",{children:"PPN Diskon"})]}):a.jsx(a.Fragment,{})}),a.jsx("div",{className:"col-span-3",children:p.diskon_angka>0?a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["Rp. ",g(p.diskon_angka)," (",p.diskon_persentase," % )"]}),a.jsxs("p",{children:["Rp. ",g(p.harga_setelah_diskon)]}),a.jsxs("p",{children:["Rp. ",g(p.ppn_setelah_diskon)]})]}):a.jsx(a.Fragment,{})}),a.jsxs("div",{className:"col-span-3",children:["Total Harga ",a.jsxs("p",{children:["Rp. ",g(p.total_harga)]})]})]})]})})),a.jsxs("div",{className:"grid grid-cols-12 gap-x-2 px-6 py-5 items-start font-bold border-t-2",children:[a.jsxs("div",{className:"col-span-9",children:[a.jsx("p",{children:"PEMBAYARAN"}),a.jsx("p",{className:"font-normal mt-5",children:"TERBILANG"}),a.jsxs("p",{children:[Ra(3e5).toString().toUpperCase()," RUPIAH"]})]}),a.jsx("div",{className:"col-span-3",children:a.jsxs("p",{children:["TOTAL ",a.jsx("br",{})," Rp. ",g(3e5)]})})]}),a.jsx("div",{className:"grid grid-cols-12 gap-x-2 px-6 py-5 items-start font-bold",children:a.jsxs("div",{className:"col-span-12",children:[a.jsx("p",{className:"mb-2",children:"TIPE PEMBAYARAN : KREDIT"}),a.jsx("p",{className:"font-normal",children:"SYARAT PEMBAYARAN : PELUNASAN 30 HARI"})]})}),a.jsx("div",{className:"grid grid-cols-12 gap-x-2 px-6 py-5 items-start font-bold",children:a.jsxs("div",{className:"col-span-12",children:[a.jsx("p",{className:"mb-2",children:"KETERANGAN"}),a.jsx("p",{className:"font-normal",children:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Recusandae consequatur sequi doloremque, aliquid tempora earum officiis quae quis ipsa saepe in quo fuga animi cum eum perspiciatis! Nemo, inventore doloribus."})]})})]})),qa=({pesananPenjualanBarang:n,rincianPesananPenjualanBarang:l,setFakturStatus:p=()=>{},fakturStatus:c,ppnStatus:w,setTanggalTransaksiAkhir:y=()=>{}})=>{const[z,B]=s.useState(),[_,f]=s.useState(!0),[S,k]=s.useState([]),[D,h]=s.useState([]),[$,j]=s.useState(q()),[C,i]=s.useState(),[b,F]=s.useState(),[v,K]=s.useState(),[x,o]=s.useState(),[t,A]=s.useState(),[G,r]=s.useState(""),L=s.useRef(),O=Ga.useReactToPrint({content:()=>L.current}),U=()=>{$a.custom("","GET").then(d=>{k(R=>d.data.entry),d.data.entry.length>0&&K(R=>({label:d.data.entry[0].name,value:d.data.entry[0].uuid}))})},m=()=>{Ca.custom("/type/"+v.value,"GET").then(d=>{h(R=>d.data),d.data.length>0&&o(R=>({label:d.data[0].name,value:d.data[0].uuid}))})},T=async d=>{d.preventDefault(),await X(d.target)&&ta.custom("","POST",null,{data:{pesanan_penjualan_barang:n.uuid,tanggal:$,nomor_faktur_penjualan_barang:C,bukti_transaksi:b,tipe_pembayaran:v.value,syarat_pembayaran:x.value,keterangan:t,nomor_faktur_pajak_penjualan_barang:G||"EMPTY"}}).then(R=>{p(H=>R.data.uuid)}).catch(R=>P(R))},e=()=>{ta.custom(`/${c}`,"DELETE").then(()=>{p(d=>null)}).catch(d=>P(d))};s.useEffect(()=>{v!=null&&v.value&&m()},[v]);const E=()=>{ta.custom(`/pesanan_penjualan_barang/${n.uuid}`,"GET").then(d=>{d.data&&(B(R=>d.data),i(R=>d.data.nomor_faktur_penjualan_barang),F(R=>d.data.bukti_transaksi),j(R=>d.data.tanggal),K(R=>d.data.tipe_pembayaran_name),o(R=>d.data.syarat_pembayaran_name),A(R=>d.data.keterangan),p(R=>d.data.uuid),r(R=>d.data.nomor_faktur_pajak_penjualan_barang!="EMPTY"?d.data.nomor_faktur_pajak_penjualan_barang:""))}).catch(d=>{p(R=>null)})};return s.useEffect(()=>{c!=null&&(E(),U())},[c]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white rounded-md py-6 px-6 shadow-2xl",children:[a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-4",children:"Faktur Penjualan Barang"}),a.jsxs("form",{onSubmit:d=>T(d),children:[a.jsxs("div",{className:"flex gap-x-2",children:[a.jsx(I,{label:"Tanggal Faktur Penjualan Barang",type:"datetime-local",onchange:d=>{j(d.target.value)},disabled:c,addClassInput:c?"border-none px-1":"",others:{value:$,name:"tanggalFakturPenjualanBarang",disabled:c}}),a.jsx(I,{label:"Nomor Faktur Penjualan Barang",type:"text",onchange:d=>{i(d.target.value)},disabled:c,addClassInput:c?"border-none px-1":"",others:{value:C,name:"nomorFakturPenjualanBarang",disabled:c}}),a.jsx(I,{label:"Bukti Transaksi",type:"text",disabled:c,addClassInput:c?"border-none px-1":"",onchange:d=>{F(d.target.value)},others:{value:b,name:"buktiTransaksi",disabled:c}}),c?a.jsxs(a.Fragment,{children:[a.jsx(I,{label:"Tipe Pembayaran",type:"text",disabled:c,addClassInput:c?"border-none px-1":"",others:{value:v.label,name:"tipePembayaran",disabled:c}}),a.jsx(I,{label:"Syarat Pembayaran",type:"text",disabled:c,addClassInput:c?"border-none px-1":"",others:{value:x.label,name:"syaratPembayaran",disabled:c}})]}):a.jsxs(a.Fragment,{children:[a.jsx(Q,{label:"Tipe Pembayaran",optionsDataList:S,optionsLabel:"name",optionsValue:"uuid",selectValue:v,onchange:d=>{K(d)},selectName:"tipePembayaran"}),a.jsx(Q,{label:"Syarat Pembayaran",optionsDataList:D,optionsLabel:"name",optionsValue:"uuid",selectValue:x,onchange:d=>{o(d)},selectName:"syaratPembayaran"})]})]}),a.jsx("div",{className:"flex gap-x-2",children:a.jsx(I,{label:"Keterangan",type:"text",disabled:c,addClassInput:c?"border-none px-1":"",onchange:d=>{A(d.target.value)},others:{value:t,name:"keteranganFakturPenjualanBarang",disabled:c}})}),w?a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex gap-x-2",children:a.jsx(I,{label:"Nomor Faktur Pajak",type:"text",disabled:c,addClassInput:c?"border-none px-1":"",onchange:d=>{r(d.target.value)},others:{value:G,name:"nomorFakturPajakFakturPenjualanBarang",disabled:c}})})}):a.jsx(a.Fragment,{}),c?a.jsx(a.Fragment,{children:_?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"btn btn-sm bg-red-800 mt-4 text-white",type:"button",onClick:()=>e(),children:[a.jsx(M,{})," Batalkan Faktur"]}),a.jsx("div",{className:"hidden",children:a.jsx(Ma,{ref:L,rincianPesananPenjualanBarang:l})}),a.jsxs("button",{className:"btn btn-sm bg-red-800 mt-4 text-white",type:"button",onClick:O,children:[a.jsx(Sa,{})," Cetak Faktur"]})]}):a.jsx(a.Fragment,{})}):a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(la,{})," Simpan"]})})]})]}),c?a.jsx(a.Fragment,{children:a.jsx(Ja,{fakturPenjualanBarang:z,setFakturCancel:f,setTanggalTransaksiAkhir:y})}):a.jsx(a.Fragment,{})]})},Wa=({setAddPenjualanBarang:n=()=>{}})=>{Ea();const[l,p]=s.useState(q()),[c,w]=s.useState(!1),[y,z]=s.useState(!1),[B,_]=s.useState(!1),[f,S]=s.useState(!1),[k,D]=s.useState([]),[h,$]=s.useState(!0),[j,C]=s.useState([]),[i,b]=s.useState([]),[F,v]=s.useState(""),[K,x]=s.useState(q()),[o,t]=s.useState(),[A,G]=s.useState(!1),[r,L]=s.useState(""),[O,U]=s.useState({page:1,size:2,count:118,lastPage:12}),m=({selected:u})=>{let N=O;N.page=u+1,U(N),d()},T=u=>{let N=O;N.size=u,N.page=1,U(N),d()},[e,E]=s.useState(),d=(u="")=>{u==""&&L(u),Aa.custom(`?search=${u}&page=${O.page}&size=${O.size}`,"GET").then(N=>{var Y,sa;G(u.length<1),b((Y=N==null?void 0:N.data)==null?void 0:Y.entry),U((sa=N==null?void 0:N.data)==null?void 0:sa.pagination)}).catch(N=>{P(N)})},R=()=>{ia.custom(`/${e.uuid}`,"DELETE").then(u=>{E(null),ja()}).catch(u=>P(u))},H=async u=>{u.preventDefault(),await X(u.target)&&ia.custom(h?`/${h.value}`:"",h?"PUT":"POST",null,{data:{nomor_pesanan_penjualan_barang:F,tanggal_pesanan_penjualan_barang:K,customer:o.uuid}}).then(N=>{if(h){const Y=k.filter(sa=>sa.uuid==h.value);E(Y[0])}else E(N.data);S(Y=>!0)}).catch(N=>{P(N),h&&(ga(),S(Y=>!0),E(k.filter(Y=>Y.uuid==h.value)[0]))})},ga=()=>{t(N=>null),x(N=>q()),v(N=>null);const u=k.filter(N=>N.uuid==h.value);if(u.length>0){const N=i.filter(Y=>Y.uuid==u[0].customer);N.length>0&&(t(Y=>N[0]),x(u[0].tanggal_pesanan_penjualan_barang),v(u[0].nomor_pesanan_penjualan_barang))}};s.useEffect(()=>{h&&ga()},[h]);const ja=()=>{ia.custom("","GET").then(u=>{D(N=>u.data.entry),u.data.entry.length>0&&$(N=>({label:u.data.entry[0].nomor_pesanan_penjualan_barang,value:u.data.entry[0].uuid}))}).catch(u=>P(u))};return s.useEffect(()=>{B?ja():(v(u=>""),$(u=>!1),x(u=>q()),t(u=>null))},[B]),s.useEffect(()=>{d()},[]),a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-white rounded-md shadow-sm h-max",children:a.jsxs("div",{className:"py-5 px-6 h-max w-full z-10",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsx("h1",{className:"text-xl font-extrabold w-max text-white px-2 rounded-md bg-blue-900 mb-2",children:"Pesanan Penjualan Barang"})}),a.jsxs("form",{onSubmit:u=>H(u),children:[a.jsxs("div",{className:"flex items-end gap-x-2",children:[a.jsxs("div",{className:"flex items-end gap-x-2 w-full",children:[B&&!e?a.jsx(a.Fragment,{children:a.jsx(Q,{label:"Nomor Pesanan Penjualan Barang",optionsDataList:k,optionsLabel:"nomor_pesanan_penjualan_barang",optionsValue:"uuid",selectValue:h,onchange:u=>{$(u)},selectName:"pesananPenjualanBarangSelected"})}):a.jsx(a.Fragment,{children:a.jsx(I,{label:"Nomor Pesanan Penjualan Barang",type:"text",disabled:e&&f,addClassInput:e&&f?"border-none px-1":"",onchange:u=>{v(u.target.value)},others:{value:F,name:"nomorPesananPenjualanBarang",disabled:e&&f}})}),e?a.jsx(a.Fragment,{children:j.length!=0||c?a.jsx(a.Fragment,{}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:`btn btn-sm ${f?"bg-yellow-400 hover:bg-yellow-400":""}`,onClick:()=>{S(u=>u=!u)},children:[f?a.jsx(Da,{}):a.jsx(M,{})," ",f?"Edit":"Batal Edit"," Nomor Pesanan"]}),a.jsxs("button",{type:"button",onClick:()=>R(),className:"btn btn-sm bg-red-700 text-white",children:[a.jsx(na,{})," Hapus Nomor Pesanan"]})]})}):a.jsx(a.Fragment,{children:a.jsxs("button",{type:"button",className:`btn btn-sm ${B?"bg-red-900":"bg-blue-900"} text-white border-none`,onClick:()=>{_(u=>u=!u)},children:[B?a.jsx(M,{}):a.jsx(fa,{}),B?"Batal Pesanan Penjualan":"Pilih Pesanan Penjualan"]})})]}),a.jsx(I,{label:"Tanggal Pesanan Penjualan Barang",type:"datetime-local",onchange:u=>{x(u.target.value)},disabled:e,addClassInput:e?"border-none px-1":"",others:{value:K,name:"tanggalPesananPenjualanBarang",disabled:e}})]}),o?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"mt-5 relative px-1",children:[a.jsx("p",{className:"font-bold text-sm mb-3",children:"Customer Terpilih"}),a.jsxs("p",{className:"text-xl font-bold",children:[o.code," - ",o.name]}),a.jsxs("div",{className:"mt-3 flex gap-x-10",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Alamat Rumah"}),a.jsx("p",{className:"text-sm",children:o.alamat_rumah})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Alamat Kantor"}),a.jsx("p",{className:"text-sm",children:o.alamat_kantor})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"NPWP"}),a.jsx("p",{className:"text-sm",children:o.npwp})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Nomor Telepon"}),a.jsx("p",{className:"text-sm",children:o.no_telp})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Nomor Handphone"}),a.jsx("p",{className:"text-sm",children:o.no_hp})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold mb-1",children:"Kode Harga"}),a.jsxs("p",{className:"text-sm",children:["Harga ",o.kode_harga]})]})]}),e?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsx("button",{className:"absolute top-0 right-3 flex mt-3 py-1 px-2 gap-x-2 items-center font-bold text-xs rounded-md bg-red-800 text-white",onClick:()=>{t(null)},type:"button",children:a.jsx(M,{})})})]})}):a.jsx(a.Fragment,{}),o?a.jsx(a.Fragment,{children:e&&f?a.jsx(a.Fragment,{children:a.jsxs("button",{type:"button",onClick:()=>{E(u=>null),t(u=>null),_(u=>!1),w(u=>!1)},className:"btn btn-sm bg-red-800 mt-4 text-white",children:[a.jsx(M,{})," Reset Pesanan Penjualan"]})}):a.jsx(a.Fragment,{children:a.jsxs("button",{className:"btn btn-sm bg-green-800 mt-4 text-white",children:[a.jsx(la,{})," Simpan"]})})}):a.jsx(a.Fragment,{})]}),o?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"mt-5",children:[a.jsxs("div",{className:"flex w-full items-center gap-x-2 mb-5",children:[a.jsx(V,{value:r,onchange:u=>L(u.target.value),other:{placeholder:"Cari Customer"}}),A?a.jsx(fa,{onClick:()=>{d(r)},className:"cursor-pointer"}):a.jsx(M,{onClick:()=>d(""),className:"cursor-pointer"})]}),a.jsxs("table",{className:"table table-zebra",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"sticky top-0 bg-white py-4 text-black",children:[a.jsx("th",{width:12,children:"No"}),a.jsx("th",{children:"Kode Customer"}),a.jsx("th",{children:"Nama Customer"}),a.jsx("th",{children:"Kode Harga"}),a.jsx("th",{children:"Aksi"})]})}),a.jsx("tbody",{children:i==null?void 0:i.map((u,N)=>a.jsx(a.Fragment,{children:a.jsxs("tr",{children:[a.jsxs("td",{children:[N+1,"."]}),a.jsx("td",{width:400,children:u.code}),a.jsx("td",{width:400,children:u.name}),a.jsxs("td",{width:400,children:["Harga ",u.kode_harga]}),a.jsx("td",{children:a.jsxs("button",{className:"flex py-1 px-5 gap-x-2 items-center rounded-xl bg-green-800 text-white",onClick:()=>{t(Y=>u)},type:"button",children:[a.jsx(ea,{size:12.5}),a.jsx("p",{children:"Pilih"})]})})]},N)}))})]}),a.jsx(Ka,{paginateUpdatePage:m,paginate:O,setSize:T,shadow:"",sizeList:[2,4,6]})]})})]})}),e&&f?a.jsxs(a.Fragment,{children:[a.jsx(Ua,{pesananPenjualanBarang:e,customer:o,fakturStatus:c,setPPNStatus:z,tanggalTransaksiAkhir:l,rincianPesananPenjualanBarang:j,setRincianPesananPenjualanBarang:C}),a.jsx(qa,{pesananPenjualanBarang:e,rincianPesananPenjualanBarang:j,setFakturStatus:w,fakturStatus:c,ppnStatus:y,setTanggalTransaksiAkhir:p})]}):a.jsx(a.Fragment,{})]})},re=()=>{const[n,l]=s.useState(!1),[p,c]=s.useState(!1);return s.useState(""),s.useState(!0),a.jsx(wa,{isLoading:n,children:a.jsxs("div",{children:[a.jsx(La,{title:"Penjualan Barang"}),a.jsx(Wa,{setAddPenjualanBarang:c})]})})};export{re as default};
